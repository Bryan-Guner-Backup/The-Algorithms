{
  "slug": "lempel-ziv-decompress",
  "name": "Lempel Ziv Decompress",
  "categories": ["compression"],
  "body": {},
  "implementations": {
    "python": {
      "dir": "compression/lempel_ziv_decompress.py",
      "url": "https://github.com/TheAlgorithms/python/tree/master/compression/lempel_ziv_decompress.py",
      "code": "<span class=\"hljs-string\">&quot;&quot;&quot;\n    One of the several implementations of Lempel–Ziv–Welch decompression algorithm\n    https://en.wikipedia.org/wiki/Lempel%E2%80%93Ziv%E2%80%93Welch\n&quot;&quot;&quot;</span>\n\n<span class=\"hljs-keyword\">import</span> math\n<span class=\"hljs-keyword\">import</span> sys\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">read_file_binary</span>(<span class=\"hljs-params\">file_path: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    Reads given file as bytes and returns them as a long string\n    &quot;&quot;&quot;</span>\n    result = <span class=\"hljs-string\">&quot;&quot;</span>\n    <span class=\"hljs-keyword\">try</span>:\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(file_path, <span class=\"hljs-string\">&quot;rb&quot;</span>) <span class=\"hljs-keyword\">as</span> binary_file:\n            data = binary_file.read()\n        <span class=\"hljs-keyword\">for</span> dat <span class=\"hljs-keyword\">in</span> data:\n            curr_byte = <span class=\"hljs-string\">f&quot;<span class=\"hljs-subst\">{dat:08b}</span>&quot;</span>\n            result += curr_byte\n        <span class=\"hljs-keyword\">return</span> result\n    <span class=\"hljs-keyword\">except</span> OSError:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;File not accessible&quot;</span>)\n        sys.exit()\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">decompress_data</span>(<span class=\"hljs-params\">data_bits: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    Decompresses given data_bits using Lempel–Ziv–Welch compression algorithm\n    and returns the result as a string\n    &quot;&quot;&quot;</span>\n    lexicon = {<span class=\"hljs-string\">&quot;0&quot;</span>: <span class=\"hljs-string\">&quot;0&quot;</span>, <span class=\"hljs-string\">&quot;1&quot;</span>: <span class=\"hljs-string\">&quot;1&quot;</span>}\n    result, curr_string = <span class=\"hljs-string\">&quot;&quot;</span>, <span class=\"hljs-string\">&quot;&quot;</span>\n    index = <span class=\"hljs-built_in\">len</span>(lexicon)\n\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-built_in\">len</span>(data_bits)):\n        curr_string += data_bits[i]\n        <span class=\"hljs-keyword\">if</span> curr_string <span class=\"hljs-keyword\">not</span> <span class=\"hljs-keyword\">in</span> lexicon:\n            <span class=\"hljs-keyword\">continue</span>\n\n        last_match_id = lexicon[curr_string]\n        result += last_match_id\n        lexicon[curr_string] = last_match_id + <span class=\"hljs-string\">&quot;0&quot;</span>\n\n        <span class=\"hljs-keyword\">if</span> math.log2(index).is_integer():\n            newLex = {}\n            <span class=\"hljs-keyword\">for</span> curr_key <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">list</span>(lexicon):\n                newLex[<span class=\"hljs-string\">&quot;0&quot;</span> + curr_key] = lexicon.pop(curr_key)\n            lexicon = newLex\n\n        lexicon[<span class=\"hljs-built_in\">bin</span>(index)[<span class=\"hljs-number\">2</span>:]] = last_match_id + <span class=\"hljs-string\">&quot;1&quot;</span>\n        index += <span class=\"hljs-number\">1</span>\n        curr_string = <span class=\"hljs-string\">&quot;&quot;</span>\n    <span class=\"hljs-keyword\">return</span> result\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">write_file_binary</span>(<span class=\"hljs-params\">file_path: <span class=\"hljs-built_in\">str</span>, to_write: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-literal\">None</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    Writes given to_write string (should only consist of 0&#x27;s and 1&#x27;s) as bytes in the\n    file\n    &quot;&quot;&quot;</span>\n    byte_length = <span class=\"hljs-number\">8</span>\n    <span class=\"hljs-keyword\">try</span>:\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(file_path, <span class=\"hljs-string\">&quot;wb&quot;</span>) <span class=\"hljs-keyword\">as</span> opened_file:\n            result_byte_array = [\n                to_write[i : i + byte_length]\n                <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">0</span>, <span class=\"hljs-built_in\">len</span>(to_write), byte_length)\n            ]\n\n            <span class=\"hljs-keyword\">if</span> <span class=\"hljs-built_in\">len</span>(result_byte_array[-<span class=\"hljs-number\">1</span>]) % byte_length == <span class=\"hljs-number\">0</span>:\n                result_byte_array.append(<span class=\"hljs-string\">&quot;10000000&quot;</span>)\n            <span class=\"hljs-keyword\">else</span>:\n                result_byte_array[-<span class=\"hljs-number\">1</span>] += <span class=\"hljs-string\">&quot;1&quot;</span> + <span class=\"hljs-string\">&quot;0&quot;</span> * (\n                    byte_length - <span class=\"hljs-built_in\">len</span>(result_byte_array[-<span class=\"hljs-number\">1</span>]) - <span class=\"hljs-number\">1</span>\n                )\n\n            <span class=\"hljs-keyword\">for</span> elem <span class=\"hljs-keyword\">in</span> result_byte_array[:-<span class=\"hljs-number\">1</span>]:\n                opened_file.write(<span class=\"hljs-built_in\">int</span>(elem, <span class=\"hljs-number\">2</span>).to_bytes(<span class=\"hljs-number\">1</span>, byteorder=<span class=\"hljs-string\">&quot;big&quot;</span>))\n    <span class=\"hljs-keyword\">except</span> OSError:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;File not accessible&quot;</span>)\n        sys.exit()\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">remove_prefix</span>(<span class=\"hljs-params\">data_bits: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    Removes size prefix, that compressed file should have\n    Returns the result\n    &quot;&quot;&quot;</span>\n    counter = <span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">for</span> letter <span class=\"hljs-keyword\">in</span> data_bits:\n        <span class=\"hljs-keyword\">if</span> letter == <span class=\"hljs-string\">&quot;1&quot;</span>:\n            <span class=\"hljs-keyword\">break</span>\n        counter += <span class=\"hljs-number\">1</span>\n\n    data_bits = data_bits[counter:]\n    data_bits = data_bits[counter + <span class=\"hljs-number\">1</span> :]\n    <span class=\"hljs-keyword\">return</span> data_bits\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">compress</span>(<span class=\"hljs-params\">source_path: <span class=\"hljs-built_in\">str</span>, destination_path: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-literal\">None</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    Reads source file, decompresses it and writes the result in destination file\n    &quot;&quot;&quot;</span>\n    data_bits = read_file_binary(source_path)\n    data_bits = remove_prefix(data_bits)\n    decompressed = decompress_data(data_bits)\n    write_file_binary(destination_path, decompressed)\n\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\n    compress(sys.argv[<span class=\"hljs-number\">1</span>], sys.argv[<span class=\"hljs-number\">2</span>])\n"
    }
  },
  "contributors": [
    {
      "name": "Christian Clauss",
      "email": "cclauss@me.com",
      "commits": 1
    },
    {
      "name": "Ioane Margiani",
      "email": "margianiioane@gmail.com",
      "commits": 1
    }
  ],
  "explanationUrl": {}
}
