{
  "slug": "diffie-hellman",
  "name": "Diffie Hellman",
  "categories": ["ciphers"],
  "body": {},
  "implementations": {
    "python": {
      "dir": "ciphers/diffie_hellman.py",
      "url": "https://github.com/TheAlgorithms/python/tree/master/ciphers/diffie_hellman.py",
      "code": "<span class=\"hljs-keyword\">from</span> binascii <span class=\"hljs-keyword\">import</span> hexlify\n<span class=\"hljs-keyword\">from</span> hashlib <span class=\"hljs-keyword\">import</span> sha256\n<span class=\"hljs-keyword\">from</span> os <span class=\"hljs-keyword\">import</span> urandom\n\n<span class=\"hljs-comment\"># RFC 3526 - More Modular Exponential (MODP) Diffie-Hellman groups for</span>\n<span class=\"hljs-comment\"># Internet Key Exchange (IKE) https://tools.ietf.org/html/rfc3526</span>\n\nprimes = {\n    <span class=\"hljs-comment\"># 1536-bit</span>\n    <span class=\"hljs-number\">5</span>: {\n        <span class=\"hljs-string\">&quot;prime&quot;</span>: <span class=\"hljs-built_in\">int</span>(\n            <span class=\"hljs-string\">&quot;FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD1&quot;</span>\n            + <span class=\"hljs-string\">&quot;29024E088A67CC74020BBEA63B139B22514A08798E3404DD&quot;</span>\n            + <span class=\"hljs-string\">&quot;EF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245&quot;</span>\n            + <span class=\"hljs-string\">&quot;E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED&quot;</span>\n            + <span class=\"hljs-string\">&quot;EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3D&quot;</span>\n            + <span class=\"hljs-string\">&quot;C2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F&quot;</span>\n            + <span class=\"hljs-string\">&quot;83655D23DCA3AD961C62F356208552BB9ED529077096966D&quot;</span>\n            + <span class=\"hljs-string\">&quot;670C354E4ABC9804F1746C08CA237327FFFFFFFFFFFFFFFF&quot;</span>,\n            base=<span class=\"hljs-number\">16</span>,\n        ),\n        <span class=\"hljs-string\">&quot;generator&quot;</span>: <span class=\"hljs-number\">2</span>,\n    },\n    <span class=\"hljs-comment\"># 2048-bit</span>\n    <span class=\"hljs-number\">14</span>: {\n        <span class=\"hljs-string\">&quot;prime&quot;</span>: <span class=\"hljs-built_in\">int</span>(\n            <span class=\"hljs-string\">&quot;FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD1&quot;</span>\n            + <span class=\"hljs-string\">&quot;29024E088A67CC74020BBEA63B139B22514A08798E3404DD&quot;</span>\n            + <span class=\"hljs-string\">&quot;EF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245&quot;</span>\n            + <span class=\"hljs-string\">&quot;E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED&quot;</span>\n            + <span class=\"hljs-string\">&quot;EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3D&quot;</span>\n            + <span class=\"hljs-string\">&quot;C2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F&quot;</span>\n            + <span class=\"hljs-string\">&quot;83655D23DCA3AD961C62F356208552BB9ED529077096966D&quot;</span>\n            + <span class=\"hljs-string\">&quot;670C354E4ABC9804F1746C08CA18217C32905E462E36CE3B&quot;</span>\n            + <span class=\"hljs-string\">&quot;E39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9&quot;</span>\n            + <span class=\"hljs-string\">&quot;DE2BCBF6955817183995497CEA956AE515D2261898FA0510&quot;</span>\n            + <span class=\"hljs-string\">&quot;15728E5A8AACAA68FFFFFFFFFFFFFFFF&quot;</span>,\n            base=<span class=\"hljs-number\">16</span>,\n        ),\n        <span class=\"hljs-string\">&quot;generator&quot;</span>: <span class=\"hljs-number\">2</span>,\n    },\n    <span class=\"hljs-comment\"># 3072-bit</span>\n    <span class=\"hljs-number\">15</span>: {\n        <span class=\"hljs-string\">&quot;prime&quot;</span>: <span class=\"hljs-built_in\">int</span>(\n            <span class=\"hljs-string\">&quot;FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD1&quot;</span>\n            + <span class=\"hljs-string\">&quot;29024E088A67CC74020BBEA63B139B22514A08798E3404DD&quot;</span>\n            + <span class=\"hljs-string\">&quot;EF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245&quot;</span>\n            + <span class=\"hljs-string\">&quot;E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED&quot;</span>\n            + <span class=\"hljs-string\">&quot;EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3D&quot;</span>\n            + <span class=\"hljs-string\">&quot;C2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F&quot;</span>\n            + <span class=\"hljs-string\">&quot;83655D23DCA3AD961C62F356208552BB9ED529077096966D&quot;</span>\n            + <span class=\"hljs-string\">&quot;670C354E4ABC9804F1746C08CA18217C32905E462E36CE3B&quot;</span>\n            + <span class=\"hljs-string\">&quot;E39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9&quot;</span>\n            + <span class=\"hljs-string\">&quot;DE2BCBF6955817183995497CEA956AE515D2261898FA0510&quot;</span>\n            + <span class=\"hljs-string\">&quot;15728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64&quot;</span>\n            + <span class=\"hljs-string\">&quot;ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7&quot;</span>\n            + <span class=\"hljs-string\">&quot;ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6B&quot;</span>\n            + <span class=\"hljs-string\">&quot;F12FFA06D98A0864D87602733EC86A64521F2B18177B200C&quot;</span>\n            + <span class=\"hljs-string\">&quot;BBE117577A615D6C770988C0BAD946E208E24FA074E5AB31&quot;</span>\n            + <span class=\"hljs-string\">&quot;43DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF&quot;</span>,\n            base=<span class=\"hljs-number\">16</span>,\n        ),\n        <span class=\"hljs-string\">&quot;generator&quot;</span>: <span class=\"hljs-number\">2</span>,\n    },\n    <span class=\"hljs-comment\"># 4096-bit</span>\n    <span class=\"hljs-number\">16</span>: {\n        <span class=\"hljs-string\">&quot;prime&quot;</span>: <span class=\"hljs-built_in\">int</span>(\n            <span class=\"hljs-string\">&quot;FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD1&quot;</span>\n            + <span class=\"hljs-string\">&quot;29024E088A67CC74020BBEA63B139B22514A08798E3404DD&quot;</span>\n            + <span class=\"hljs-string\">&quot;EF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245&quot;</span>\n            + <span class=\"hljs-string\">&quot;E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED&quot;</span>\n            + <span class=\"hljs-string\">&quot;EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3D&quot;</span>\n            + <span class=\"hljs-string\">&quot;C2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F&quot;</span>\n            + <span class=\"hljs-string\">&quot;83655D23DCA3AD961C62F356208552BB9ED529077096966D&quot;</span>\n            + <span class=\"hljs-string\">&quot;670C354E4ABC9804F1746C08CA18217C32905E462E36CE3B&quot;</span>\n            + <span class=\"hljs-string\">&quot;E39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9&quot;</span>\n            + <span class=\"hljs-string\">&quot;DE2BCBF6955817183995497CEA956AE515D2261898FA0510&quot;</span>\n            + <span class=\"hljs-string\">&quot;15728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64&quot;</span>\n            + <span class=\"hljs-string\">&quot;ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7&quot;</span>\n            + <span class=\"hljs-string\">&quot;ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6B&quot;</span>\n            + <span class=\"hljs-string\">&quot;F12FFA06D98A0864D87602733EC86A64521F2B18177B200C&quot;</span>\n            + <span class=\"hljs-string\">&quot;BBE117577A615D6C770988C0BAD946E208E24FA074E5AB31&quot;</span>\n            + <span class=\"hljs-string\">&quot;43DB5BFCE0FD108E4B82D120A92108011A723C12A787E6D7&quot;</span>\n            + <span class=\"hljs-string\">&quot;88719A10BDBA5B2699C327186AF4E23C1A946834B6150BDA&quot;</span>\n            + <span class=\"hljs-string\">&quot;2583E9CA2AD44CE8DBBBC2DB04DE8EF92E8EFC141FBECAA6&quot;</span>\n            + <span class=\"hljs-string\">&quot;287C59474E6BC05D99B2964FA090C3A2233BA186515BE7ED&quot;</span>\n            + <span class=\"hljs-string\">&quot;1F612970CEE2D7AFB81BDD762170481CD0069127D5B05AA9&quot;</span>\n            + <span class=\"hljs-string\">&quot;93B4EA988D8FDDC186FFB7DC90A6C08F4DF435C934063199&quot;</span>\n            + <span class=\"hljs-string\">&quot;FFFFFFFFFFFFFFFF&quot;</span>,\n            base=<span class=\"hljs-number\">16</span>,\n        ),\n        <span class=\"hljs-string\">&quot;generator&quot;</span>: <span class=\"hljs-number\">2</span>,\n    },\n    <span class=\"hljs-comment\"># 6144-bit</span>\n    <span class=\"hljs-number\">17</span>: {\n        <span class=\"hljs-string\">&quot;prime&quot;</span>: <span class=\"hljs-built_in\">int</span>(\n            <span class=\"hljs-string\">&quot;FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E08&quot;</span>\n            + <span class=\"hljs-string\">&quot;8A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B&quot;</span>\n            + <span class=\"hljs-string\">&quot;302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9&quot;</span>\n            + <span class=\"hljs-string\">&quot;A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE6&quot;</span>\n            + <span class=\"hljs-string\">&quot;49286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8&quot;</span>\n            + <span class=\"hljs-string\">&quot;FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D&quot;</span>\n            + <span class=\"hljs-string\">&quot;670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C&quot;</span>\n            + <span class=\"hljs-string\">&quot;180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF695581718&quot;</span>\n            + <span class=\"hljs-string\">&quot;3995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D&quot;</span>\n            + <span class=\"hljs-string\">&quot;04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7D&quot;</span>\n            + <span class=\"hljs-string\">&quot;B3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D226&quot;</span>\n            + <span class=\"hljs-string\">&quot;1AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200C&quot;</span>\n            + <span class=\"hljs-string\">&quot;BBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFC&quot;</span>\n            + <span class=\"hljs-string\">&quot;E0FD108E4B82D120A92108011A723C12A787E6D788719A10BDBA5B26&quot;</span>\n            + <span class=\"hljs-string\">&quot;99C327186AF4E23C1A946834B6150BDA2583E9CA2AD44CE8DBBBC2DB&quot;</span>\n            + <span class=\"hljs-string\">&quot;04DE8EF92E8EFC141FBECAA6287C59474E6BC05D99B2964FA090C3A2&quot;</span>\n            + <span class=\"hljs-string\">&quot;233BA186515BE7ED1F612970CEE2D7AFB81BDD762170481CD0069127&quot;</span>\n            + <span class=\"hljs-string\">&quot;D5B05AA993B4EA988D8FDDC186FFB7DC90A6C08F4DF435C934028492&quot;</span>\n            + <span class=\"hljs-string\">&quot;36C3FAB4D27C7026C1D4DCB2602646DEC9751E763DBA37BDF8FF9406&quot;</span>\n            + <span class=\"hljs-string\">&quot;AD9E530EE5DB382F413001AEB06A53ED9027D831179727B0865A8918&quot;</span>\n            + <span class=\"hljs-string\">&quot;DA3EDBEBCF9B14ED44CE6CBACED4BB1BDB7F1447E6CC254B33205151&quot;</span>\n            + <span class=\"hljs-string\">&quot;2BD7AF426FB8F401378CD2BF5983CA01C64B92ECF032EA15D1721D03&quot;</span>\n            + <span class=\"hljs-string\">&quot;F482D7CE6E74FEF6D55E702F46980C82B5A84031900B1C9E59E7C97F&quot;</span>\n            + <span class=\"hljs-string\">&quot;BEC7E8F323A97A7E36CC88BE0F1D45B7FF585AC54BD407B22B4154AA&quot;</span>\n            + <span class=\"hljs-string\">&quot;CC8F6D7EBF48E1D814CC5ED20F8037E0A79715EEF29BE32806A1D58B&quot;</span>\n            + <span class=\"hljs-string\">&quot;B7C5DA76F550AA3D8A1FBFF0EB19CCB1A313D55CDA56C9EC2EF29632&quot;</span>\n            + <span class=\"hljs-string\">&quot;387FE8D76E3C0468043E8F663F4860EE12BF2D5B0B7474D6E694F91E&quot;</span>\n            + <span class=\"hljs-string\">&quot;6DCC4024FFFFFFFFFFFFFFFF&quot;</span>,\n            base=<span class=\"hljs-number\">16</span>,\n        ),\n        <span class=\"hljs-string\">&quot;generator&quot;</span>: <span class=\"hljs-number\">2</span>,\n    },\n    <span class=\"hljs-comment\"># 8192-bit</span>\n    <span class=\"hljs-number\">18</span>: {\n        <span class=\"hljs-string\">&quot;prime&quot;</span>: <span class=\"hljs-built_in\">int</span>(\n            <span class=\"hljs-string\">&quot;FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD1&quot;</span>\n            + <span class=\"hljs-string\">&quot;29024E088A67CC74020BBEA63B139B22514A08798E3404DD&quot;</span>\n            + <span class=\"hljs-string\">&quot;EF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245&quot;</span>\n            + <span class=\"hljs-string\">&quot;E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED&quot;</span>\n            + <span class=\"hljs-string\">&quot;EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3D&quot;</span>\n            + <span class=\"hljs-string\">&quot;C2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F&quot;</span>\n            + <span class=\"hljs-string\">&quot;83655D23DCA3AD961C62F356208552BB9ED529077096966D&quot;</span>\n            + <span class=\"hljs-string\">&quot;670C354E4ABC9804F1746C08CA18217C32905E462E36CE3B&quot;</span>\n            + <span class=\"hljs-string\">&quot;E39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9&quot;</span>\n            + <span class=\"hljs-string\">&quot;DE2BCBF6955817183995497CEA956AE515D2261898FA0510&quot;</span>\n            + <span class=\"hljs-string\">&quot;15728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64&quot;</span>\n            + <span class=\"hljs-string\">&quot;ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7&quot;</span>\n            + <span class=\"hljs-string\">&quot;ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6B&quot;</span>\n            + <span class=\"hljs-string\">&quot;F12FFA06D98A0864D87602733EC86A64521F2B18177B200C&quot;</span>\n            + <span class=\"hljs-string\">&quot;BBE117577A615D6C770988C0BAD946E208E24FA074E5AB31&quot;</span>\n            + <span class=\"hljs-string\">&quot;43DB5BFCE0FD108E4B82D120A92108011A723C12A787E6D7&quot;</span>\n            + <span class=\"hljs-string\">&quot;88719A10BDBA5B2699C327186AF4E23C1A946834B6150BDA&quot;</span>\n            + <span class=\"hljs-string\">&quot;2583E9CA2AD44CE8DBBBC2DB04DE8EF92E8EFC141FBECAA6&quot;</span>\n            + <span class=\"hljs-string\">&quot;287C59474E6BC05D99B2964FA090C3A2233BA186515BE7ED&quot;</span>\n            + <span class=\"hljs-string\">&quot;1F612970CEE2D7AFB81BDD762170481CD0069127D5B05AA9&quot;</span>\n            + <span class=\"hljs-string\">&quot;93B4EA988D8FDDC186FFB7DC90A6C08F4DF435C934028492&quot;</span>\n            + <span class=\"hljs-string\">&quot;36C3FAB4D27C7026C1D4DCB2602646DEC9751E763DBA37BD&quot;</span>\n            + <span class=\"hljs-string\">&quot;F8FF9406AD9E530EE5DB382F413001AEB06A53ED9027D831&quot;</span>\n            + <span class=\"hljs-string\">&quot;179727B0865A8918DA3EDBEBCF9B14ED44CE6CBACED4BB1B&quot;</span>\n            + <span class=\"hljs-string\">&quot;DB7F1447E6CC254B332051512BD7AF426FB8F401378CD2BF&quot;</span>\n            + <span class=\"hljs-string\">&quot;5983CA01C64B92ECF032EA15D1721D03F482D7CE6E74FEF6&quot;</span>\n            + <span class=\"hljs-string\">&quot;D55E702F46980C82B5A84031900B1C9E59E7C97FBEC7E8F3&quot;</span>\n            + <span class=\"hljs-string\">&quot;23A97A7E36CC88BE0F1D45B7FF585AC54BD407B22B4154AA&quot;</span>\n            + <span class=\"hljs-string\">&quot;CC8F6D7EBF48E1D814CC5ED20F8037E0A79715EEF29BE328&quot;</span>\n            + <span class=\"hljs-string\">&quot;06A1D58BB7C5DA76F550AA3D8A1FBFF0EB19CCB1A313D55C&quot;</span>\n            + <span class=\"hljs-string\">&quot;DA56C9EC2EF29632387FE8D76E3C0468043E8F663F4860EE&quot;</span>\n            + <span class=\"hljs-string\">&quot;12BF2D5B0B7474D6E694F91E6DBE115974A3926F12FEE5E4&quot;</span>\n            + <span class=\"hljs-string\">&quot;38777CB6A932DF8CD8BEC4D073B931BA3BC832B68D9DD300&quot;</span>\n            + <span class=\"hljs-string\">&quot;741FA7BF8AFC47ED2576F6936BA424663AAB639C5AE4F568&quot;</span>\n            + <span class=\"hljs-string\">&quot;3423B4742BF1C978238F16CBE39D652DE3FDB8BEFC848AD9&quot;</span>\n            + <span class=\"hljs-string\">&quot;22222E04A4037C0713EB57A81A23F0C73473FC646CEA306B&quot;</span>\n            + <span class=\"hljs-string\">&quot;4BCBC8862F8385DDFA9D4B7FA2C087E879683303ED5BDD3A&quot;</span>\n            + <span class=\"hljs-string\">&quot;062B3CF5B3A278A66D2A13F83F44F82DDF310EE074AB6A36&quot;</span>\n            + <span class=\"hljs-string\">&quot;4597E899A0255DC164F31CC50846851DF9AB48195DED7EA1&quot;</span>\n            + <span class=\"hljs-string\">&quot;B1D510BD7EE74D73FAF36BC31ECFA268359046F4EB879F92&quot;</span>\n            + <span class=\"hljs-string\">&quot;4009438B481C6CD7889A002ED5EE382BC9190DA6FC026E47&quot;</span>\n            + <span class=\"hljs-string\">&quot;9558E4475677E9AA9E3050E2765694DFC81F56E880B96E71&quot;</span>\n            + <span class=\"hljs-string\">&quot;60C980DD98EDD3DFFFFFFFFFFFFFFFFF&quot;</span>,\n            base=<span class=\"hljs-number\">16</span>,\n        ),\n        <span class=\"hljs-string\">&quot;generator&quot;</span>: <span class=\"hljs-number\">2</span>,\n    },\n}\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DiffieHellman</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    Class to represent the Diffie-Hellman key exchange protocol\n\n\n    &gt;&gt;&gt; alice = DiffieHellman()\n    &gt;&gt;&gt; bob = DiffieHellman()\n\n    &gt;&gt;&gt; alice_private = alice.get_private_key()\n    &gt;&gt;&gt; alice_public = alice.generate_public_key()\n\n    &gt;&gt;&gt; bob_private = bob.get_private_key()\n    &gt;&gt;&gt; bob_public = bob.generate_public_key()\n\n    &gt;&gt;&gt; # generating shared key using the DH object\n    &gt;&gt;&gt; alice_shared = alice.generate_shared_key(bob_public)\n    &gt;&gt;&gt; bob_shared = bob.generate_shared_key(alice_public)\n\n    &gt;&gt;&gt; assert alice_shared == bob_shared\n\n    &gt;&gt;&gt; # generating shared key using static methods\n    &gt;&gt;&gt; alice_shared = DiffieHellman.generate_shared_key_static(\n    ...     alice_private, bob_public\n    ... )\n    &gt;&gt;&gt; bob_shared = DiffieHellman.generate_shared_key_static(\n    ...     bob_private, alice_public\n    ... )\n\n    &gt;&gt;&gt; assert alice_shared == bob_shared\n    &quot;&quot;&quot;</span>\n\n    <span class=\"hljs-comment\"># Current minimum recommendation is 2048 bit (group 14)</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, group: <span class=\"hljs-built_in\">int</span> = <span class=\"hljs-number\">14</span></span>) -&gt; <span class=\"hljs-literal\">None</span>:\n        <span class=\"hljs-keyword\">if</span> group <span class=\"hljs-keyword\">not</span> <span class=\"hljs-keyword\">in</span> primes:\n            <span class=\"hljs-keyword\">raise</span> ValueError(<span class=\"hljs-string\">&quot;Unsupported Group&quot;</span>)\n        self.prime = primes[group][<span class=\"hljs-string\">&quot;prime&quot;</span>]\n        self.generator = primes[group][<span class=\"hljs-string\">&quot;generator&quot;</span>]\n\n        self.__private_key = <span class=\"hljs-built_in\">int</span>(hexlify(urandom(<span class=\"hljs-number\">32</span>)), base=<span class=\"hljs-number\">16</span>)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_private_key</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">hex</span>(self.__private_key)[<span class=\"hljs-number\">2</span>:]\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">generate_public_key</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        public_key = <span class=\"hljs-built_in\">pow</span>(self.generator, self.__private_key, self.prime)\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">hex</span>(public_key)[<span class=\"hljs-number\">2</span>:]\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">is_valid_public_key</span>(<span class=\"hljs-params\">self, key: <span class=\"hljs-built_in\">int</span></span>) -&gt; <span class=\"hljs-built_in\">bool</span>:\n        <span class=\"hljs-comment\"># check if the other public key is valid based on NIST SP800-56</span>\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-number\">2</span> &lt;= key <span class=\"hljs-keyword\">and</span> key &lt;= self.prime - <span class=\"hljs-number\">2</span>:\n            <span class=\"hljs-keyword\">if</span> <span class=\"hljs-built_in\">pow</span>(key, (self.prime - <span class=\"hljs-number\">1</span>) // <span class=\"hljs-number\">2</span>, self.prime) == <span class=\"hljs-number\">1</span>:\n                <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">True</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">False</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">generate_shared_key</span>(<span class=\"hljs-params\">self, other_key_str: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        other_key = <span class=\"hljs-built_in\">int</span>(other_key_str, base=<span class=\"hljs-number\">16</span>)\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> self.is_valid_public_key(other_key):\n            <span class=\"hljs-keyword\">raise</span> ValueError(<span class=\"hljs-string\">&quot;Invalid public key&quot;</span>)\n        shared_key = <span class=\"hljs-built_in\">pow</span>(other_key, self.__private_key, self.prime)\n        <span class=\"hljs-keyword\">return</span> sha256(<span class=\"hljs-built_in\">str</span>(shared_key).encode()).hexdigest()\n\n<span class=\"hljs-meta\">    @staticmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">is_valid_public_key_static</span>(<span class=\"hljs-params\">remote_public_key_str: <span class=\"hljs-built_in\">int</span>, prime: <span class=\"hljs-built_in\">int</span></span>) -&gt; <span class=\"hljs-built_in\">bool</span>:\n        <span class=\"hljs-comment\"># check if the other public key is valid based on NIST SP800-56</span>\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-number\">2</span> &lt;= remote_public_key_str <span class=\"hljs-keyword\">and</span> remote_public_key_str &lt;= prime - <span class=\"hljs-number\">2</span>:\n            <span class=\"hljs-keyword\">if</span> <span class=\"hljs-built_in\">pow</span>(remote_public_key_str, (prime - <span class=\"hljs-number\">1</span>) // <span class=\"hljs-number\">2</span>, prime) == <span class=\"hljs-number\">1</span>:\n                <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">True</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">False</span>\n\n<span class=\"hljs-meta\">    @staticmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">generate_shared_key_static</span>(<span class=\"hljs-params\">\n        local_private_key_str: <span class=\"hljs-built_in\">str</span>, remote_public_key_str: <span class=\"hljs-built_in\">str</span>, group: <span class=\"hljs-built_in\">int</span> = <span class=\"hljs-number\">14</span>\n    </span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        local_private_key = <span class=\"hljs-built_in\">int</span>(local_private_key_str, base=<span class=\"hljs-number\">16</span>)\n        remote_public_key = <span class=\"hljs-built_in\">int</span>(remote_public_key_str, base=<span class=\"hljs-number\">16</span>)\n        prime = primes[group][<span class=\"hljs-string\">&quot;prime&quot;</span>]\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> DiffieHellman.is_valid_public_key_static(remote_public_key, prime):\n            <span class=\"hljs-keyword\">raise</span> ValueError(<span class=\"hljs-string\">&quot;Invalid public key&quot;</span>)\n        shared_key = <span class=\"hljs-built_in\">pow</span>(remote_public_key, local_private_key, prime)\n        <span class=\"hljs-keyword\">return</span> sha256(<span class=\"hljs-built_in\">str</span>(shared_key).encode()).hexdigest()\n\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\n    <span class=\"hljs-keyword\">import</span> doctest\n\n    doctest.testmod()\n"
    }
  },
  "contributors": [
    {
      "name": "Tapajyoti Bose",
      "email": "44058757+ruppysuppy@users.noreply.github.com",
      "commits": 1
    },
    {
      "name": "Dhruv Manilawala",
      "email": "dhruvmanila@gmail.com",
      "commits": 1
    }
  ],
  "explanationUrl": {}
}
