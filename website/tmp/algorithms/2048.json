{
  "slug": "2048",
  "name": "2048",
  "categories": ["others"],
  "body": {},
  "implementations": {
    "aarch64_assembly": {
      "dir": "misc/2048.s",
      "url": "https://github.com/TheAlgorithms/aarch64_assembly/tree/master/misc/2048.s",
      "code": "<span class=\"hljs-comment\">/* ARM assembly AARCH64 Raspberry PI 3B */</span>\n<span class=\"hljs-comment\">/*  program 2048_64.s   */</span> \n \n<span class=\"hljs-comment\">/*******************************************/</span>\n<span class=\"hljs-comment\">/* Constantes file                         */</span>\n<span class=\"hljs-comment\">/*******************************************/</span>\n<span class=\"hljs-comment\">/* for this file see task include a file in language AArch64 assembly*/</span>\n<span class=\"hljs-symbol\">.include</span> <span class=\"hljs-string\">&quot;../includeConstantesARM64.inc&quot;</span>\n<span class=\"hljs-symbol\">.equ</span> SIZE,       <span class=\"hljs-number\">4</span>       \n<span class=\"hljs-symbol\">.equ</span> TOTAL,      <span class=\"hljs-number\">2048</span>\n<span class=\"hljs-symbol\">.equ</span> BUFFERSIZE, <span class=\"hljs-number\">80</span>\n \n<span class=\"hljs-symbol\">.equ</span> KEYSIZE,    <span class=\"hljs-number\">8</span>\n<span class=\"hljs-symbol\">.equ</span> IOCTL,     <span class=\"hljs-number\">0x1D</span>  <span class=\"hljs-comment\">// Linux syscall</span>\n<span class=\"hljs-symbol\">.equ</span> SIGACTION, <span class=\"hljs-number\">0x86</span>  <span class=\"hljs-comment\">// Linux syscall</span>\n<span class=\"hljs-symbol\">.equ</span> SYSPOLL,   <span class=\"hljs-number\">0x16</span>  <span class=\"hljs-comment\">// Linux syscall</span>\n<span class=\"hljs-symbol\">.equ</span> CREATPOLL, <span class=\"hljs-number\">0x14</span>  <span class=\"hljs-comment\">// Linux syscall</span>\n<span class=\"hljs-symbol\">.equ</span> CTLPOLL,   <span class=\"hljs-number\">0x15</span>  <span class=\"hljs-comment\">// Linux syscall</span>\n \n<span class=\"hljs-symbol\">.equ</span> TCGETS,    <span class=\"hljs-number\">0x5401</span>\n<span class=\"hljs-symbol\">.equ</span> TCSETS,    <span class=\"hljs-number\">0x5402</span>\n<span class=\"hljs-symbol\">.equ</span> ICANON,    <span class=\"hljs-number\">2</span>\n<span class=\"hljs-symbol\">.equ</span> ECHO,     <span class=\"hljs-number\">10</span>\n<span class=\"hljs-symbol\">.equ</span> POLLIN,    <span class=\"hljs-number\">1</span>\n<span class=\"hljs-symbol\">.equ</span> EPOLL_CTL_ADD,    <span class=\"hljs-number\">1</span>\n \n<span class=\"hljs-symbol\">.equ</span> SIGINT,   <span class=\"hljs-number\">2</span>      <span class=\"hljs-comment\">// Issued if the user sends an interrupt signal (Ctrl + C)</span>\n<span class=\"hljs-symbol\">.equ</span> SIGQUIT,  <span class=\"hljs-number\">3</span>      <span class=\"hljs-comment\">// Issued if the user sends a quit signal (Ctrl + D)</span>\n<span class=\"hljs-symbol\">.equ</span> SIGTERM, <span class=\"hljs-number\">15</span>      <span class=\"hljs-comment\">// Software termination signal (sent by kill by default)</span>\n<span class=\"hljs-symbol\">.equ</span> SIGTTOU, <span class=\"hljs-number\">22</span>\n \n<span class=\"hljs-comment\">/*******************************************/</span>\n<span class=\"hljs-comment\">/* Structures                               */</span>\n<span class=\"hljs-comment\">/********************************************/</span>\n<span class=\"hljs-comment\">/* structure termios see doc linux*/</span>\n    .struct  <span class=\"hljs-number\">0</span>\n<span class=\"hljs-symbol\">term_c_iflag:</span>                    <span class=\"hljs-comment\">// input modes</span>\n    .struct  term_c_iflag + <span class=\"hljs-number\">4</span> \n<span class=\"hljs-symbol\">term_c_oflag:</span>                    <span class=\"hljs-comment\">// output modes</span>\n    .struct  term_c_oflag + <span class=\"hljs-number\">4</span> \n<span class=\"hljs-symbol\">term_c_cflag:</span>                    <span class=\"hljs-comment\">// control modes</span>\n    .struct  term_c_cflag + <span class=\"hljs-number\">4</span> \n<span class=\"hljs-symbol\">term_c_lflag:</span>                    <span class=\"hljs-comment\">// local modes</span>\n    .struct  term_c_lflag + <span class=\"hljs-number\">4</span> \n<span class=\"hljs-symbol\">term_c_cc:</span>                       <span class=\"hljs-comment\">// special characters</span>\n    .struct  term_c_cc + <span class=\"hljs-number\">40</span>      <span class=\"hljs-comment\">// see length if necessary </span>\n<span class=\"hljs-symbol\">term_fin:</span>\n \n<span class=\"hljs-comment\">/* structure sigaction see doc linux */</span>\n    .struct  <span class=\"hljs-number\">0</span>\n<span class=\"hljs-symbol\">sa_handler:</span>\n    .struct  sa_handler + <span class=\"hljs-number\">8</span> \n<span class=\"hljs-symbol\">sa_mask:</span>\n    .struct  sa_mask + <span class=\"hljs-number\">8</span> \n<span class=\"hljs-symbol\">sa_flags:</span>\n    .struct  sa_flags + <span class=\"hljs-number\">8</span>\n<span class=\"hljs-symbol\">sa_sigaction:</span>\n    .struct  sa_sigaction + <span class=\"hljs-number\">8</span>\n<span class=\"hljs-symbol\">sa_fin:</span>\n \n<span class=\"hljs-comment\">/* structure poll see doc linux */</span>\n    .struct  <span class=\"hljs-number\">0</span>\n<span class=\"hljs-symbol\">poll_event:</span>                        <span class=\"hljs-comment\">//  events mask</span>\n    .struct  poll_event + <span class=\"hljs-number\">8</span>\n<span class=\"hljs-symbol\">poll_fd:</span>                           <span class=\"hljs-comment\">// events returned</span>\n    .struct  poll_fd  + <span class=\"hljs-number\">8</span>\n<span class=\"hljs-symbol\">poll_fin:</span>\n<span class=\"hljs-comment\">/*********************************/</span>\n<span class=\"hljs-comment\">/* Initialized data              */</span>\n<span class=\"hljs-comment\">/*********************************/</span>\n<span class=\"hljs-symbol\">.data</span>\n<span class=\"hljs-symbol\">szMessOK:</span>           <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;Bravo !! You win. \\n&quot;</span>\n<span class=\"hljs-symbol\">szMessNotOK:</span>        <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;You lost !! \\n&quot;</span>\n<span class=\"hljs-symbol\">szMessNewGame:</span>      <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;New game (y/n) ? \\n&quot;</span>\n<span class=\"hljs-symbol\">szMessErreur:</span>       <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;Error detected.\\n&quot;</span>\n<span class=\"hljs-symbol\">szMessErrInitTerm:</span>  <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;Error terminal init.\\n&quot;</span>\n<span class=\"hljs-symbol\">szMessErrInitPoll:</span>  <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;Error poll init.\\n&quot;</span>\n<span class=\"hljs-symbol\">szMessErreurKey:</span>    <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;Error read key.\\n&quot;</span>\n<span class=\"hljs-symbol\">szMessErr:</span>          <span class=\"hljs-meta\">.asciz</span>    <span class=\"hljs-string\">&quot;Error code hexa : @ d√©cimal : @ \\n&quot;</span>\n<span class=\"hljs-symbol\">szCarriageReturn:</span>   <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;\\n&quot;</span>\n<span class=\"hljs-symbol\">szMess0:</span>            <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;      &quot;</span>\n<span class=\"hljs-symbol\">szMess2:</span>            <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;   2  &quot;</span>\n<span class=\"hljs-symbol\">szMess4:</span>            <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;   4  &quot;</span>\n<span class=\"hljs-symbol\">szMess8:</span>            <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;   8  &quot;</span>\n<span class=\"hljs-symbol\">szMess16:</span>           <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;  16  &quot;</span>\n<span class=\"hljs-symbol\">szMess32:</span>           <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;  32  &quot;</span>\n<span class=\"hljs-symbol\">szMess64:</span>           <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;  64  &quot;</span>\n<span class=\"hljs-symbol\">szMess128:</span>          <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot; 128  &quot;</span>\n<span class=\"hljs-symbol\">szMess256:</span>          <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot; 256  &quot;</span>\n<span class=\"hljs-symbol\">szMess512:</span>          <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot; 512  &quot;</span>\n<span class=\"hljs-symbol\">szMess1024:</span>         <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot; 1024 &quot;</span>\n<span class=\"hljs-symbol\">szMess2048:</span>         <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot; 2048 &quot;</span>\n<span class=\"hljs-symbol\">szCleax1:</span>           <span class=\"hljs-meta\">.byte</span> <span class=\"hljs-number\">0x1B</span> \n                    <span class=\"hljs-meta\">.byte</span> <span class=\"hljs-string\">&#x27;c&#x27;</span>           <span class=\"hljs-comment\">// other console clear</span>\n                    <span class=\"hljs-meta\">.byte</span> <span class=\"hljs-number\">0</span>\n \n<span class=\"hljs-symbol\">szLineH:</span>            <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;-----------------------------\\n&quot;</span>\n<span class=\"hljs-symbol\">szLineV:</span>            <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;|&quot;</span>\n<span class=\"hljs-symbol\">szLineVT:</span>           <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;|      |      |      |      |\\n&quot;</span>\n<span class=\"hljs-symbol\">.align</span> <span class=\"hljs-number\">4</span>\n<span class=\"hljs-symbol\">qGraine:</span>            .quad <span class=\"hljs-number\">123456</span>\n<span class=\"hljs-comment\">/*********************************/</span>\n<span class=\"hljs-comment\">/* UnInitialized data            */</span>\n<span class=\"hljs-comment\">/*********************************/</span>\n<span class=\"hljs-symbol\">.bss</span>\n<span class=\"hljs-symbol\">.align</span> <span class=\"hljs-number\">4</span>\n<span class=\"hljs-symbol\">sZoneConv:</span>      <span class=\"hljs-meta\">.skip</span> <span class=\"hljs-number\">24</span>\n<span class=\"hljs-symbol\">sBuffer:</span>        <span class=\"hljs-meta\">.skip</span> BUFFERSIZE\n<span class=\"hljs-symbol\">qTbCase:</span>        <span class=\"hljs-meta\">.skip</span> <span class=\"hljs-number\">8</span> * SIZE * SIZE\n<span class=\"hljs-symbol\">qEnd:</span>           <span class=\"hljs-meta\">.skip</span> <span class=\"hljs-number\">8</span>                        <span class=\"hljs-comment\">// 0 loop  1 = end loop</span>\n<span class=\"hljs-symbol\">qTouche:</span>        <span class=\"hljs-meta\">.skip</span> KEYSIZE                  <span class=\"hljs-comment\">// value key pressed</span>\n<span class=\"hljs-symbol\">stOldtio:</span>       <span class=\"hljs-meta\">.skip</span> term_fin                 <span class=\"hljs-comment\">// old terminal state</span>\n<span class=\"hljs-symbol\">stCurtio:</span>       <span class=\"hljs-meta\">.skip</span> term_fin                 <span class=\"hljs-comment\">// current terminal state</span>\n<span class=\"hljs-symbol\">stSigAction:</span>    <span class=\"hljs-meta\">.skip</span> sa_fin                   <span class=\"hljs-comment\">// area signal structure</span>\n<span class=\"hljs-symbol\">stSigAction1:</span>   <span class=\"hljs-meta\">.skip</span> sa_fin\n<span class=\"hljs-symbol\">stSigAction2:</span>   <span class=\"hljs-meta\">.skip</span> sa_fin\n<span class=\"hljs-symbol\">stSigAction3:</span>   <span class=\"hljs-meta\">.skip</span> sa_fin\n<span class=\"hljs-symbol\">stPoll1:</span>        <span class=\"hljs-meta\">.skip</span> poll_fin                 <span class=\"hljs-comment\">// area poll structure</span>\n<span class=\"hljs-symbol\">stPoll2:</span>        <span class=\"hljs-meta\">.skip</span> poll_fin\n<span class=\"hljs-symbol\">stevents:</span>       <span class=\"hljs-meta\">.skip</span> <span class=\"hljs-number\">16</span>\n<span class=\"hljs-comment\">/*********************************/</span>\n<span class=\"hljs-comment\">/*  code section                 */</span>\n<span class=\"hljs-comment\">/*********************************/</span>\n<span class=\"hljs-symbol\">.text</span>\n<span class=\"hljs-symbol\">.global</span> main\n<span class=\"hljs-symbol\">main:</span>                                <span class=\"hljs-comment\">// entry of program </span>\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">bl</span> initTerm                      <span class=\"hljs-comment\">// terminal init</span>\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">0</span>                         <span class=\"hljs-comment\">// error ?</span>\n    <span class=\"hljs-keyword\">blt</span> <span class=\"hljs-number\">100</span>f\n    <span class=\"hljs-keyword\">bl</span> initPoll                      <span class=\"hljs-comment\">// epoll instance init</span>\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">blt</span> <span class=\"hljs-number\">99</span>f\n    <span class=\"hljs-keyword\">mov</span> x22,x0                        <span class=\"hljs-comment\">// save epfd</span>\n<span class=\"hljs-number\">1</span>:                                    <span class=\"hljs-comment\">// begin game loop</span>\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszCleax1\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">bl</span> razTable\n<span class=\"hljs-number\">2</span>:\n    <span class=\"hljs-keyword\">bl</span> addDigit   \n    <span class=\"hljs-keyword\">cmp</span> x0,#-<span class=\"hljs-number\">1</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">5</span>f                            <span class=\"hljs-comment\">// end game</span>\n    <span class=\"hljs-keyword\">bl</span> displayGame\n<span class=\"hljs-number\">3</span>:\n    <span class=\"hljs-keyword\">mov</span> x0,x22\n    <span class=\"hljs-keyword\">bl</span> waitKey\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">3</span>b\n    <span class=\"hljs-keyword\">bl</span> readKey\n    <span class=\"hljs-keyword\">cmp</span> x0,#-<span class=\"hljs-number\">1</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">99</span>f                          <span class=\"hljs-comment\">// error</span>\n    <span class=\"hljs-keyword\">bl</span> keyMove\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">3</span>b                            <span class=\"hljs-comment\">// no change -&gt; loop</span>\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#2</span>                         <span class=\"hljs-comment\">// last addition = 2048 ?</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">4</span>f\n    <span class=\"hljs-keyword\">cmp</span> x0,#-<span class=\"hljs-number\">1</span>                        <span class=\"hljs-comment\">// quit ?</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">2</span>b                            <span class=\"hljs-comment\">// loop</span>\n \n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">10</span>f\n<span class=\"hljs-number\">4</span>:                                    <span class=\"hljs-comment\">// last addition = 2048 </span>\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMessOK\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">10</span>f\n<span class=\"hljs-number\">5</span>:                                    <span class=\"hljs-comment\">// display message no solution</span>\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMessNotOK\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n \n<span class=\"hljs-number\">10</span>:                                   <span class=\"hljs-comment\">// display new game ?</span>\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszCarriageReturn\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMessNewGame\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n<span class=\"hljs-number\">11</span>:\n    <span class=\"hljs-keyword\">mov</span> x0,x22\n    <span class=\"hljs-keyword\">bl</span> waitKey\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">11</span>b\n    <span class=\"hljs-keyword\">bl</span> readKey\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrqTouche\n    <span class=\"hljs-keyword\">ldrb</span> w0,[x0]\n    <span class=\"hljs-keyword\">cmp</span> w0,#<span class=\"hljs-string\">&#x27;y&#x27;</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">1</span>b\n    <span class=\"hljs-keyword\">cmp</span> w0,#<span class=\"hljs-string\">&#x27;Y&#x27;</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">1</span>b\n<span class=\"hljs-number\">99</span>:\n    <span class=\"hljs-keyword\">bl</span> restauTerm                     <span class=\"hljs-comment\">// terminal restaur</span>\n<span class=\"hljs-number\">100</span>:                                  <span class=\"hljs-comment\">// standard end of the program </span>\n    <span class=\"hljs-keyword\">mov</span> x0, <span class=\"hljs-number\">#0</span>                        <span class=\"hljs-comment\">// return code</span>\n    <span class=\"hljs-keyword\">mov</span> x8, <span class=\"hljs-symbol\">#EXIT</span>                     <span class=\"hljs-comment\">// request to exit program</span>\n    <span class=\"hljs-keyword\">svc</span> <span class=\"hljs-number\">#0</span>                            <span class=\"hljs-comment\">// perform the system call</span>\n \n<span class=\"hljs-symbol\">qAdrszCarriageReturn:</span>     .quad szCarriageReturn\n<span class=\"hljs-symbol\">qAdrszMessNotOK:</span>          .quad szMessNotOK\n<span class=\"hljs-symbol\">qAdrszMessOK:</span>             .quad szMessOK\n<span class=\"hljs-symbol\">qAdrszMessNewGame:</span>        .quad szMessNewGame\n<span class=\"hljs-symbol\">qAdrsZoneConv:</span>            .quad sZoneConv\n<span class=\"hljs-symbol\">qAdrszCleax1:</span>             .quad szCleax1\n<span class=\"hljs-symbol\">qAdrszMessErrInitTerm:</span>    .quad szMessErrInitTerm\n<span class=\"hljs-symbol\">qAdrszMessErrInitPoll:</span>    .quad szMessErrInitPoll\n<span class=\"hljs-symbol\">qAdrszMessErreurKey:</span>      .quad szMessErreurKey\n<span class=\"hljs-symbol\">qAdrstOldtio:</span>             .quad stOldtio\n<span class=\"hljs-symbol\">qAdrstCurtio:</span>             .quad stCurtio\n<span class=\"hljs-symbol\">qAdrstSigAction:</span>          .quad stSigAction\n<span class=\"hljs-symbol\">qAdrstSigAction1:</span>         .quad stSigAction1\n<span class=\"hljs-symbol\">qAdrSIG_IGN:</span>              .quad <span class=\"hljs-number\">1</span>\n<span class=\"hljs-symbol\">qAdrqEnd:</span>                 .quad qEnd\n<span class=\"hljs-symbol\">qAdrqTouche:</span>              .quad qTouche\n<span class=\"hljs-symbol\">qAdrstevents:</span>             .quad stevents\n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/*     raz table cases                                                   */</span> \n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-symbol\">razTable:</span>\n    stp x0,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!     <span class=\"hljs-comment\">// save  registres</span>\n    stp x1,x2,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!     <span class=\"hljs-comment\">// save  registres</span>\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrqTbCase\n    <span class=\"hljs-keyword\">mov</span> x2,<span class=\"hljs-number\">#0</span>\n<span class=\"hljs-number\">1</span>:\n    <span class=\"hljs-keyword\">str</span> xzr,[x1,x2,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">add</span> x2,x2,<span class=\"hljs-number\">#1</span>\n    <span class=\"hljs-keyword\">cmp</span> x2,<span class=\"hljs-symbol\">#SIZE</span> * SIZE\n    <span class=\"hljs-keyword\">blt</span> <span class=\"hljs-number\">1</span>b\n<span class=\"hljs-number\">100</span>:\n    ldp x1,x2,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>       <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x0,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>       <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ret\n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/*     key move                                                   */</span> \n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/* x0 contains key value               */</span>\n<span class=\"hljs-symbol\">keyMove:</span>\n    stp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!     <span class=\"hljs-comment\">// save  registres</span>\n    <span class=\"hljs-keyword\">lsr</span> x0,x0,<span class=\"hljs-number\">#16</span>\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#0x42</span>                  <span class=\"hljs-comment\">// down arrow </span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">1</span>f\n    <span class=\"hljs-keyword\">bl</span> moveDown\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">1</span>:\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#0x41</span>                  <span class=\"hljs-comment\">// high arrow</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">2</span>f\n    <span class=\"hljs-keyword\">bl</span> moveUp\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">2</span>:\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#0x43</span>                  <span class=\"hljs-comment\">// right arrow</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">3</span>f\n    <span class=\"hljs-keyword\">bl</span> moveRight\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">3</span>:\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#0x44</span>                  <span class=\"hljs-comment\">// left arrow</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">4</span>f\n    <span class=\"hljs-keyword\">bl</span> moveLeft\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">4</span>:\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrqTouche\n    <span class=\"hljs-keyword\">ldrb</span> w0,[x0]\n    <span class=\"hljs-keyword\">cmp</span> w0,#<span class=\"hljs-string\">&#x27;q&#x27;</span>                   <span class=\"hljs-comment\">// quit game</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">5</span>f\n    <span class=\"hljs-keyword\">mov</span> x0,#-<span class=\"hljs-number\">1</span>\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">5</span>:\n    <span class=\"hljs-keyword\">cmp</span> w0,#<span class=\"hljs-string\">&#x27;Q&#x27;</span>                   <span class=\"hljs-comment\">// quit game</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">100</span>f\n    <span class=\"hljs-keyword\">mov</span> x0,#-<span class=\"hljs-number\">1</span>\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n \n<span class=\"hljs-number\">100</span>:\n    ldp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>       <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ret\n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/*           move left                                   */</span> \n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/* x0 return -1 if ok     */</span>\n<span class=\"hljs-symbol\">moveLeft:</span>\n    stp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x2,x3,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x4,x5,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x6,x7,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x8,x9,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x10,x11,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!        <span class=\"hljs-comment\">// save  registres</span>\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrqTbCase\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#0</span>                   <span class=\"hljs-comment\">// top move Ok</span>\n    <span class=\"hljs-keyword\">mov</span> x2,<span class=\"hljs-number\">#0</span>                   <span class=\"hljs-comment\">// line indice</span>\n<span class=\"hljs-number\">1</span>:\n    <span class=\"hljs-keyword\">mov</span> x6,<span class=\"hljs-number\">#0</span>                   <span class=\"hljs-comment\">// counter empty case</span>\n    <span class=\"hljs-keyword\">mov</span> x7,<span class=\"hljs-number\">#0</span>                   <span class=\"hljs-comment\">// first digit</span>\n    <span class=\"hljs-keyword\">mov</span> x10,<span class=\"hljs-number\">#0</span>                  <span class=\"hljs-comment\">// last digit to add</span>\n    <span class=\"hljs-keyword\">mov</span> x3,<span class=\"hljs-number\">#0</span>                   <span class=\"hljs-comment\">// column indice</span>\n<span class=\"hljs-number\">2</span>:\n    <span class=\"hljs-keyword\">lsl</span> x5,x2,<span class=\"hljs-number\">#2</span>                <span class=\"hljs-comment\">// change this if size &lt;&gt; 4</span>\n    <span class=\"hljs-keyword\">add</span> x5,x5,x3                <span class=\"hljs-comment\">// compute table indice</span>\n    <span class=\"hljs-keyword\">ldr</span> x4,[x1,x5,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">cmp</span> x4,<span class=\"hljs-number\">#0</span>\n    cinc x6,x6,eq               <span class=\"hljs-comment\">// positions vides</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">5</span>f\n    <span class=\"hljs-keyword\">cmp</span> x6,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">3</span>f                      <span class=\"hljs-comment\">// no empty left case</span>\n    <span class=\"hljs-keyword\">mov</span> x8,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">str</span> x8,[x1,x5,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]       <span class=\"hljs-comment\">// raz digit</span>\n    <span class=\"hljs-keyword\">sub</span> x5,x5,x6\n    <span class=\"hljs-keyword\">str</span> x4,[x1,x5,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]       <span class=\"hljs-comment\">// and store to left empty position</span>\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#1</span>                   <span class=\"hljs-comment\">// move Ok</span>\n<span class=\"hljs-number\">3</span>:\n    <span class=\"hljs-keyword\">cmp</span> x7,<span class=\"hljs-number\">#0</span>                   <span class=\"hljs-comment\">// first digit</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">4</span>f\n    <span class=\"hljs-keyword\">cmp</span> x10,x4                  <span class=\"hljs-comment\">// prec digit have to add </span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">4</span>f\n    <span class=\"hljs-keyword\">sub</span> x8,x5,<span class=\"hljs-number\">#1</span>                <span class=\"hljs-comment\">// prec digit </span>\n    <span class=\"hljs-keyword\">ldr</span> x9,[x1,x8,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">cmp</span> x4,x9                   <span class=\"hljs-comment\">// equal ?</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">4</span>f\n    <span class=\"hljs-keyword\">mov</span> x10,x4                  <span class=\"hljs-comment\">// save digit </span>\n    <span class=\"hljs-keyword\">add</span> x4,x4,x9                <span class=\"hljs-comment\">// yes -&gt; add</span>\n    <span class=\"hljs-keyword\">str</span> x4,[x1,x8,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">cmp</span> x4,<span class=\"hljs-symbol\">#TOTAL</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">6</span>f\n    <span class=\"hljs-keyword\">mov</span> x4,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">str</span> x4,[x1,x5,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">add</span> x6,x6,<span class=\"hljs-number\">#1</span>                <span class=\"hljs-comment\">// empty case + 1</span>\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#1</span>                   <span class=\"hljs-comment\">// move Ok</span>\n<span class=\"hljs-number\">4</span>:\n    <span class=\"hljs-keyword\">add</span> x7,x7,<span class=\"hljs-number\">#1</span>                <span class=\"hljs-comment\">// no first digit</span>\n \n<span class=\"hljs-number\">5</span>:                              <span class=\"hljs-comment\">// and loop</span>\n    <span class=\"hljs-keyword\">add</span> x3,x3,<span class=\"hljs-number\">#1</span>\n    <span class=\"hljs-keyword\">cmp</span> x3,<span class=\"hljs-symbol\">#SIZE</span>\n    <span class=\"hljs-keyword\">blt</span> <span class=\"hljs-number\">2</span>b\n    <span class=\"hljs-keyword\">add</span> x2,x2,<span class=\"hljs-number\">#1</span>\n    <span class=\"hljs-keyword\">cmp</span> x2,<span class=\"hljs-symbol\">#SIZE</span>\n    <span class=\"hljs-keyword\">blt</span> <span class=\"hljs-number\">1</span>b\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">6</span>:\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#2</span>                   <span class=\"hljs-comment\">// total = 2048</span>\n<span class=\"hljs-number\">100</span>:\n    ldp x10,x11,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>         <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x8,x9,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x6,x7,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x4,x5,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x2,x3,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ret\n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/*           move right                                   */</span> \n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/* x0 return -1 if ok     */</span>\n<span class=\"hljs-symbol\">moveRight:</span>\n    stp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x2,x3,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x4,x5,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x6,x7,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x8,x9,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x10,x11,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!        <span class=\"hljs-comment\">// save  registres</span>\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrqTbCase\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">mov</span> x2,<span class=\"hljs-number\">#0</span>\n<span class=\"hljs-number\">1</span>:\n    <span class=\"hljs-keyword\">mov</span> x6,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">mov</span> x7,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">mov</span> x10,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">mov</span> x3,<span class=\"hljs-symbol\">#SIZE</span>-<span class=\"hljs-number\">1</span>\n<span class=\"hljs-number\">2</span>:\n    <span class=\"hljs-keyword\">lsl</span> x5,x2,<span class=\"hljs-number\">#2</span>                  <span class=\"hljs-comment\">// change this if size &lt;&gt; 4</span>\n    <span class=\"hljs-keyword\">add</span> x5,x5,x3\n    <span class=\"hljs-keyword\">ldr</span> x4,[x1,x5,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">cmp</span> x4,<span class=\"hljs-number\">#0</span>\n    cinc x6,x6,eq               <span class=\"hljs-comment\">// positions vides</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">5</span>f\n \n    <span class=\"hljs-keyword\">cmp</span> x6,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">3</span>f                      <span class=\"hljs-comment\">// no empty right case</span>\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">str</span> x0,[x1,x5,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]       <span class=\"hljs-comment\">// raz digit</span>\n    <span class=\"hljs-keyword\">add</span> x5,x5,x6\n    <span class=\"hljs-keyword\">str</span> x4,[x1,x5,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]       <span class=\"hljs-comment\">// and store to right empty position</span>\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#1</span>\n<span class=\"hljs-number\">3</span>:\n    <span class=\"hljs-keyword\">cmp</span> x7,<span class=\"hljs-number\">#0</span>                   <span class=\"hljs-comment\">// first digit</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">4</span>f\n    <span class=\"hljs-keyword\">add</span> x8,x5,<span class=\"hljs-number\">#1</span>                <span class=\"hljs-comment\">// next digit </span>\n    <span class=\"hljs-keyword\">ldr</span> x9,[x1,x8,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">cmp</span> x4,x9                   <span class=\"hljs-comment\">// equal ?</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">4</span>f\n    <span class=\"hljs-keyword\">cmp</span> x10,x4\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">4</span>f\n    <span class=\"hljs-keyword\">mov</span> x10,x4\n    <span class=\"hljs-keyword\">add</span> x4,x4,x9                <span class=\"hljs-comment\">// yes -&gt; add</span>\n    <span class=\"hljs-keyword\">str</span> x4,[x1,x8,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">cmp</span> x4,<span class=\"hljs-symbol\">#TOTAL</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">6</span>f\n    <span class=\"hljs-keyword\">mov</span> x4,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">str</span> x4,[x1,x5,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">add</span> x6,x6,<span class=\"hljs-number\">#1</span>                <span class=\"hljs-comment\">// empty case + 1</span>\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#1</span>\n<span class=\"hljs-number\">4</span>:\n    <span class=\"hljs-keyword\">add</span> x7,x7,<span class=\"hljs-number\">#1</span>                <span class=\"hljs-comment\">// no first digit</span>\n \n<span class=\"hljs-number\">5</span>:                              <span class=\"hljs-comment\">// and loop</span>\n    <span class=\"hljs-keyword\">sub</span> x3,x3,<span class=\"hljs-number\">#1</span>\n    <span class=\"hljs-keyword\">cmp</span> x3,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">bge</span> <span class=\"hljs-number\">2</span>b\n    <span class=\"hljs-keyword\">add</span> x2,x2,<span class=\"hljs-number\">#1</span>\n    <span class=\"hljs-keyword\">cmp</span> x2,<span class=\"hljs-symbol\">#SIZE</span>\n    <span class=\"hljs-keyword\">blt</span> <span class=\"hljs-number\">1</span>b\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">6</span>:\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#2</span>\n<span class=\"hljs-number\">100</span>:\n    ldp x10,x11,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>         <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x8,x9,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x6,x7,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x4,x5,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x2,x3,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ret\n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/*           move down                                   */</span> \n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/* x0 return -1 if ok     */</span>\n<span class=\"hljs-symbol\">moveDown:</span>\n    stp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x2,x3,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x4,x5,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x6,x7,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x8,x9,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x10,x11,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!        <span class=\"hljs-comment\">// save  registres</span>\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrqTbCase\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">mov</span> x3,<span class=\"hljs-number\">#0</span>\n<span class=\"hljs-number\">1</span>:\n    <span class=\"hljs-keyword\">mov</span> x6,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">mov</span> x7,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">mov</span> x10,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">mov</span> x2,<span class=\"hljs-symbol\">#SIZE</span>-<span class=\"hljs-number\">1</span>\n<span class=\"hljs-number\">2</span>:\n    <span class=\"hljs-keyword\">lsl</span> x5,x2,<span class=\"hljs-number\">#2</span>                  <span class=\"hljs-comment\">// change this if size &lt;&gt; 4</span>\n    <span class=\"hljs-keyword\">add</span> x5,x5,x3\n    <span class=\"hljs-keyword\">ldr</span> x4,[x1,x5,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">cmp</span> x4,<span class=\"hljs-number\">#0</span>\n    cinc x6,x6,eq               <span class=\"hljs-comment\">// positions vides</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">5</span>f\n    <span class=\"hljs-keyword\">cmp</span> x6,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">3</span>f                      <span class=\"hljs-comment\">// no empty right case</span>\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">str</span> x0,[x1,x5,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]       <span class=\"hljs-comment\">// raz digit</span>\n    <span class=\"hljs-keyword\">lsl</span> x0,x6,<span class=\"hljs-number\">#2</span>\n    <span class=\"hljs-keyword\">add</span> x5,x5,x0\n    <span class=\"hljs-keyword\">str</span> x4,[x1,x5,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]       <span class=\"hljs-comment\">// and store to right empty position</span>\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#1</span>\n<span class=\"hljs-number\">3</span>:\n    <span class=\"hljs-keyword\">cmp</span> x7,<span class=\"hljs-number\">#0</span>                   <span class=\"hljs-comment\">// first digit</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">4</span>f\n    <span class=\"hljs-keyword\">add</span> x8,x5,<span class=\"hljs-symbol\">#SIZE</span>                <span class=\"hljs-comment\">// down digit </span>\n    <span class=\"hljs-keyword\">ldr</span> x9,[x1,x8,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">cmp</span> x4,x9                   <span class=\"hljs-comment\">// equal ?</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">4</span>f\n    <span class=\"hljs-keyword\">cmp</span> x10,x4\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">4</span>f\n    <span class=\"hljs-keyword\">mov</span> x10,x4\n    <span class=\"hljs-keyword\">add</span> x4,x4,x9                <span class=\"hljs-comment\">// yes -&gt; add</span>\n    <span class=\"hljs-keyword\">str</span> x4,[x1,x8,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">cmp</span> x4,<span class=\"hljs-symbol\">#TOTAL</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">6</span>f\n    <span class=\"hljs-keyword\">mov</span> x4,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">str</span> x4,[x1,x5,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">add</span> x6,x6,<span class=\"hljs-number\">#1</span>                <span class=\"hljs-comment\">// empty case + 1</span>\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#1</span>\n<span class=\"hljs-number\">4</span>:\n    <span class=\"hljs-keyword\">add</span> x7,x7,<span class=\"hljs-number\">#1</span>                   <span class=\"hljs-comment\">// no first digit</span>\n \n<span class=\"hljs-number\">5</span>:                           <span class=\"hljs-comment\">// and loop</span>\n    <span class=\"hljs-keyword\">sub</span> x2,x2,<span class=\"hljs-number\">#1</span>\n    <span class=\"hljs-keyword\">cmp</span> x2,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">bge</span> <span class=\"hljs-number\">2</span>b\n    <span class=\"hljs-keyword\">add</span> x3,x3,<span class=\"hljs-number\">#1</span>\n    <span class=\"hljs-keyword\">cmp</span> x3,<span class=\"hljs-symbol\">#SIZE</span>\n    <span class=\"hljs-keyword\">blt</span> <span class=\"hljs-number\">1</span>b\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">6</span>:\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#2</span>\n<span class=\"hljs-number\">100</span>:\n    ldp x10,x11,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>         <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x8,x9,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x6,x7,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x4,x5,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x2,x3,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ret\n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/*           move up                                   */</span> \n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/* x0 return -1 if ok     */</span>\n<span class=\"hljs-symbol\">moveUp:</span>\n    stp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x2,x3,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x4,x5,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x6,x7,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x8,x9,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x10,x11,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!        <span class=\"hljs-comment\">// save  registres</span>\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrqTbCase\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">mov</span> x3,<span class=\"hljs-number\">#0</span>\n<span class=\"hljs-number\">1</span>:\n    <span class=\"hljs-keyword\">mov</span> x6,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">mov</span> x7,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">mov</span> x10,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">mov</span> x2,<span class=\"hljs-number\">#0</span>\n<span class=\"hljs-number\">2</span>:\n    <span class=\"hljs-keyword\">lsl</span> x5,x2,<span class=\"hljs-number\">#2</span>                  <span class=\"hljs-comment\">// change this if size &lt;&gt; 4</span>\n    <span class=\"hljs-keyword\">add</span> x5,x5,x3\n    <span class=\"hljs-keyword\">ldr</span> x4,[x1,x5,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">cmp</span> x4,<span class=\"hljs-number\">#0</span>\n    cinc x6,x6,eq               <span class=\"hljs-comment\">// positions vides</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">5</span>f\n    <span class=\"hljs-keyword\">cmp</span> x6,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">3</span>f                      <span class=\"hljs-comment\">// no empty right case</span>\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">str</span> x0,[x1,x5,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]       <span class=\"hljs-comment\">// raz digit</span>\n    <span class=\"hljs-keyword\">lsl</span> x0,x6,<span class=\"hljs-number\">#2</span>\n    <span class=\"hljs-keyword\">sub</span> x5,x5,x0\n    <span class=\"hljs-keyword\">str</span> x4,[x1,x5,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]       <span class=\"hljs-comment\">// and store to right empty position</span>\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#1</span>\n<span class=\"hljs-number\">3</span>:\n    <span class=\"hljs-keyword\">cmp</span> x7,<span class=\"hljs-number\">#0</span>                   <span class=\"hljs-comment\">// first digit</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">4</span>f\n    <span class=\"hljs-keyword\">sub</span> x8,x5,<span class=\"hljs-symbol\">#SIZE</span>             <span class=\"hljs-comment\">// up digit </span>\n    <span class=\"hljs-keyword\">ldr</span> x9,[x1,x8,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">cmp</span> x4,x9                   <span class=\"hljs-comment\">// equal ?</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">4</span>f\n    <span class=\"hljs-keyword\">cmp</span> x10,x4\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">4</span>f\n    <span class=\"hljs-keyword\">mov</span> x10,x4\n    <span class=\"hljs-keyword\">add</span> x4,x4,x9                <span class=\"hljs-comment\">// yes -&gt; add</span>\n    <span class=\"hljs-keyword\">str</span> x4,[x1,x8,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">cmp</span> x4,<span class=\"hljs-symbol\">#TOTAL</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">6</span>f\n    <span class=\"hljs-keyword\">mov</span> x4,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">str</span> x4,[x1,x5,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">add</span> x6,x6,<span class=\"hljs-number\">#1</span>                <span class=\"hljs-comment\">// empty case + 1</span>\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#1</span>\n<span class=\"hljs-number\">4</span>:\n    <span class=\"hljs-keyword\">add</span> x7,x7,<span class=\"hljs-number\">#1</span>                <span class=\"hljs-comment\">// no first digit</span>\n \n<span class=\"hljs-number\">5</span>:                              <span class=\"hljs-comment\">// and loop</span>\n    <span class=\"hljs-keyword\">add</span> x2,x2,<span class=\"hljs-number\">#1</span>\n    <span class=\"hljs-keyword\">cmp</span> x2,<span class=\"hljs-symbol\">#SIZE</span>\n    <span class=\"hljs-keyword\">blt</span> <span class=\"hljs-number\">2</span>b\n    <span class=\"hljs-keyword\">add</span> x3,x3,<span class=\"hljs-number\">#1</span>\n    <span class=\"hljs-keyword\">cmp</span> x3,<span class=\"hljs-symbol\">#SIZE</span>\n    <span class=\"hljs-keyword\">blt</span> <span class=\"hljs-number\">1</span>b\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">6</span>:\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#2</span>\n<span class=\"hljs-number\">100</span>:\n    ldp x10,x11,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>         <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x8,x9,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x6,x7,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x4,x5,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x2,x3,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ret\n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/*           add new digit on game                                   */</span> \n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/* x0 return -1 if ok     */</span>\n<span class=\"hljs-symbol\">addDigit:</span>\n    stp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x2,x3,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x4,x5,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    <span class=\"hljs-keyword\">sub</span> <span class=\"hljs-built_in\">sp</span>,<span class=\"hljs-built_in\">sp</span>,<span class=\"hljs-number\">#8</span> * SIZE*SIZE\n    <span class=\"hljs-keyword\">mov</span> <span class=\"hljs-built_in\">fp</span>,<span class=\"hljs-built_in\">sp</span>\n \n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#100</span>\n    <span class=\"hljs-keyword\">bl</span> genereraleas\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#10</span>\n    <span class=\"hljs-keyword\">mov</span> x1,<span class=\"hljs-number\">#4</span>\n    <span class=\"hljs-keyword\">mov</span> x5,<span class=\"hljs-number\">#2</span>\n    csel x5,x5,x1,ge\n   <span class=\"hljs-comment\">// movlt x5,#4</span>\n    <span class=\"hljs-comment\">//movge x5,#2</span>\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrqTbCase\n    <span class=\"hljs-keyword\">mov</span> x3,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">mov</span> x4,<span class=\"hljs-number\">#0</span>\n<span class=\"hljs-number\">1</span>:  \n    <span class=\"hljs-keyword\">ldr</span> x2,[x1,x3,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">3</span>]\n    <span class=\"hljs-keyword\">cmp</span> x2,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">2</span>f\n    <span class=\"hljs-keyword\">str</span> x3,[<span class=\"hljs-built_in\">fp</span>,x4,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">3</span>]\n    <span class=\"hljs-keyword\">add</span> x4,x4,<span class=\"hljs-number\">#1</span>\n<span class=\"hljs-number\">2</span>:\n    <span class=\"hljs-keyword\">add</span> x3,x3,<span class=\"hljs-number\">#1</span>\n    <span class=\"hljs-keyword\">cmp</span> x3,<span class=\"hljs-symbol\">#SIZE</span>*SIZE\n    <span class=\"hljs-keyword\">blt</span> <span class=\"hljs-number\">1</span>b\n    <span class=\"hljs-keyword\">cmp</span> x4,<span class=\"hljs-number\">#0</span>                 <span class=\"hljs-comment\">// no empty case</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">4</span>f\n    <span class=\"hljs-keyword\">cmp</span> x4,<span class=\"hljs-number\">#1</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">3</span>f\n    <span class=\"hljs-keyword\">ldr</span> x2,[<span class=\"hljs-built_in\">fp</span>]               <span class=\"hljs-comment\">// one case</span>\n    <span class=\"hljs-keyword\">str</span> x5,[x1,x2,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">3</span>]\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">3</span>:                            <span class=\"hljs-comment\">// multiple case</span>\n    <span class=\"hljs-keyword\">sub</span> x0,x4,<span class=\"hljs-number\">#1</span>\n    <span class=\"hljs-keyword\">bl</span> genereraleas\n    <span class=\"hljs-keyword\">ldr</span> x2,[<span class=\"hljs-built_in\">fp</span>,x0,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">3</span>]\n    <span class=\"hljs-keyword\">str</span> x5,[x1,x2,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">3</span>]\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">4</span>:\n    <span class=\"hljs-keyword\">mov</span> x0,#-<span class=\"hljs-number\">1</span>\n<span class=\"hljs-number\">100</span>:\n    <span class=\"hljs-keyword\">add</span> <span class=\"hljs-built_in\">sp</span>,<span class=\"hljs-built_in\">sp</span>,<span class=\"hljs-number\">#8</span>*  (SIZE*SIZE)  <span class=\"hljs-comment\">// stack alignement</span>\n    ldp x4,x5,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x2,x3,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ret\n<span class=\"hljs-symbol\">qAdrqTbCase:</span>         .quad qTbCase\n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/*            display game                                      */</span> \n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-symbol\">displayGame:</span>\n    stp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    stp x2,x3,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszCleax1\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineH\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineVT\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineV\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrqTbCase\n    <span class=\"hljs-keyword\">mov</span> x2,<span class=\"hljs-number\">#0</span>\n<span class=\"hljs-number\">1</span>:\n    <span class=\"hljs-keyword\">ldr</span> x0,[x1,x2,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">bl</span> digitString\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineV\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">add</span> x2,x2,<span class=\"hljs-number\">#1</span>\n    <span class=\"hljs-keyword\">cmp</span> x2,<span class=\"hljs-symbol\">#SIZE</span>\n    <span class=\"hljs-keyword\">blt</span> <span class=\"hljs-number\">1</span>b\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszCarriageReturn\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineVT\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineH\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineVT\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineV\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n<span class=\"hljs-number\">2</span>:\n    <span class=\"hljs-keyword\">ldr</span> x0,[x1,x2,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">bl</span> digitString\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineV\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">add</span> x2,x2,<span class=\"hljs-number\">#1</span>\n    <span class=\"hljs-keyword\">cmp</span> x2,<span class=\"hljs-symbol\">#SIZE</span>*<span class=\"hljs-number\">2</span>\n    <span class=\"hljs-keyword\">blt</span> <span class=\"hljs-number\">2</span>b\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszCarriageReturn\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineVT\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineH\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineVT\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineV\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n<span class=\"hljs-number\">3</span>:\n    <span class=\"hljs-keyword\">ldr</span> x0,[x1,x2,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">bl</span> digitString\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineV\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">add</span> x2,x2,<span class=\"hljs-number\">#1</span>\n    <span class=\"hljs-keyword\">cmp</span> x2,<span class=\"hljs-symbol\">#SIZE</span>*<span class=\"hljs-number\">3</span>\n    <span class=\"hljs-keyword\">blt</span> <span class=\"hljs-number\">3</span>b\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszCarriageReturn\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineVT\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineH\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineVT\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineV\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n<span class=\"hljs-number\">4</span>:\n    <span class=\"hljs-keyword\">ldr</span> x0,[x1,x2,<span class=\"hljs-keyword\">lsl</span> <span class=\"hljs-number\">#3</span>]\n    <span class=\"hljs-keyword\">bl</span> digitString\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineV\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">add</span> x2,x2,<span class=\"hljs-number\">#1</span>\n    <span class=\"hljs-keyword\">cmp</span> x2,<span class=\"hljs-symbol\">#SIZE</span>*<span class=\"hljs-number\">4</span>\n    <span class=\"hljs-keyword\">blt</span> <span class=\"hljs-number\">4</span>b\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszCarriageReturn\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineVT\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszLineH\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n \n<span class=\"hljs-number\">100</span>:\n    ldp x2,x3,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ret\n<span class=\"hljs-symbol\">qAdrszLineH:</span>         .quad szLineH\n<span class=\"hljs-symbol\">qAdrszLineV:</span>         .quad szLineV\n<span class=\"hljs-symbol\">qAdrszLineVT:</span>        .quad szLineVT\n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/*            digits string                                       */</span> \n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/* x0 contains number */</span>\n<span class=\"hljs-comment\">/* x0 return address string */</span>\n<span class=\"hljs-symbol\">digitString:</span>\n    stp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!          <span class=\"hljs-comment\">// save  registres</span>\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">1</span>f\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMess0\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">1</span>:\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#2</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">2</span>f\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMess2\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">2</span>:\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#4</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">3</span>f\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMess4\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">3</span>:\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#8</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">4</span>f\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMess8\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">4</span>:\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#16</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">5</span>f\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMess16\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">5</span>:\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#32</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">6</span>f\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMess32\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">6</span>:\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#64</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">7</span>f\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMess64\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">7</span>:\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#128</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">8</span>f\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMess128\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">8</span>:\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#256</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">9</span>f\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMess256\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">9</span>:\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#512</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">10</span>f\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMess512\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">10</span>:\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#1024</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">11</span>f\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMess1024\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">11</span>:\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#2048</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">12</span>f\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMess2048\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">12</span>:\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrszMessErreur                       <span class=\"hljs-comment\">// error message</span>\n    <span class=\"hljs-keyword\">bl</span>   displayError\n<span class=\"hljs-number\">100</span>:\n    ldp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>           <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ret\n<span class=\"hljs-symbol\">qAdrszMess0:</span>          .quad szMess0\n<span class=\"hljs-symbol\">qAdrszMess2:</span>          .quad szMess2\n<span class=\"hljs-symbol\">qAdrszMess4:</span>          .quad szMess4\n<span class=\"hljs-symbol\">qAdrszMess8:</span>          .quad szMess8\n<span class=\"hljs-symbol\">qAdrszMess16:</span>         .quad szMess16\n<span class=\"hljs-symbol\">qAdrszMess32:</span>         .quad szMess32\n<span class=\"hljs-symbol\">qAdrszMess64:</span>         .quad szMess64\n<span class=\"hljs-symbol\">qAdrszMess128:</span>        .quad szMess128\n<span class=\"hljs-symbol\">qAdrszMess256:</span>        .quad szMess256\n<span class=\"hljs-symbol\">qAdrszMess512:</span>        .quad szMess512\n<span class=\"hljs-symbol\">qAdrszMess1024:</span>       .quad szMess1024\n<span class=\"hljs-symbol\">qAdrszMess2048:</span>        .quad szMess2048\n \n<span class=\"hljs-comment\">//qAdrsBuffer:         .quad sBuffer</span>\n<span class=\"hljs-symbol\">qAdrszMessErreur</span> :        .quad szMessErreur \n \n<span class=\"hljs-comment\">/***************************************************/</span>\n<span class=\"hljs-comment\">/*   Generation random number                  */</span>\n<span class=\"hljs-comment\">/***************************************************/</span>\n<span class=\"hljs-comment\">/* x0 contains limit  */</span>\n<span class=\"hljs-symbol\">genereraleas:</span>\n    stp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!            <span class=\"hljs-comment\">// save  registers</span>\n    stp x2,x3,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!            <span class=\"hljs-comment\">// save  registers</span>\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrqGraine\n    <span class=\"hljs-keyword\">ldr</span> x2,[x1]\n    <span class=\"hljs-keyword\">ldr</span> x3,qNbDep1\n    <span class=\"hljs-keyword\">mul</span> x2,x3,x2\n    <span class=\"hljs-keyword\">ldr</span> x3,qNbDep2\n    <span class=\"hljs-keyword\">add</span> x2,x2,x3\n    <span class=\"hljs-keyword\">str</span> x2,[x1]                    <span class=\"hljs-comment\">// maj de la graine pour l appel suivant </span>\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">100</span>f\n    udiv x3,x2,x0\n    msub x0,x3,x0,x2               <span class=\"hljs-comment\">// r√©sult = remainder</span>\n \n<span class=\"hljs-number\">100</span>:                               <span class=\"hljs-comment\">// end function</span>\n    ldp x2,x3,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>              <span class=\"hljs-comment\">// restaur  2 registers</span>\n    ldp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>              <span class=\"hljs-comment\">// restaur  2 registers</span>\n    ret                            <span class=\"hljs-comment\">// return to address lr x30</span>\n<span class=\"hljs-comment\">/*****************************************************/</span>\n<span class=\"hljs-symbol\">qAdrqGraine:</span> .quad qGraine\n<span class=\"hljs-symbol\">qNbDep1:</span>     .quad <span class=\"hljs-number\">0x0019660d</span>\n<span class=\"hljs-symbol\">qNbDep2:</span>     .quad <span class=\"hljs-number\">0x3c6ef35f</span>\n \n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/*     traitement du signal                                       */</span> \n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-symbol\">sighandler:</span>\n    stp x0,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!            <span class=\"hljs-comment\">// save  registers</span>\n    <span class=\"hljs-keyword\">str</span> x1,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]! \n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrqEnd\n    <span class=\"hljs-keyword\">mov</span> x1,<span class=\"hljs-number\">#1</span>                      <span class=\"hljs-comment\">// maj zone end</span>\n    <span class=\"hljs-keyword\">str</span> x1,[x0]\n    <span class=\"hljs-keyword\">ldr</span> x1,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>\n    ldp x0,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>              <span class=\"hljs-comment\">// restaur  2 registers</span>\n    ret                            <span class=\"hljs-comment\">// return to address lr x30</span>\n<span class=\"hljs-comment\">/***************************************************/</span>\n<span class=\"hljs-comment\">/*   display error message                         */</span>\n<span class=\"hljs-comment\">/***************************************************/</span>\n<span class=\"hljs-comment\">/* x0 contains error code  x1 : message address */</span>\n<span class=\"hljs-symbol\">displayError:</span>\n    stp x2,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!            <span class=\"hljs-comment\">// save  registers</span>\n    <span class=\"hljs-keyword\">mov</span> x2,x0                      <span class=\"hljs-comment\">// save error code</span>\n    <span class=\"hljs-keyword\">mov</span> x0,x1\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">mov</span> x0,x2                      <span class=\"hljs-comment\">// error code</span>\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrsZoneConv\n    <span class=\"hljs-keyword\">bl</span> conversion16                <span class=\"hljs-comment\">// conversion hexa</span>\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMessErr           <span class=\"hljs-comment\">// display error message</span>\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrsZoneConv\n    <span class=\"hljs-keyword\">bl</span> strInsertAtCharInc               <span class=\"hljs-comment\">// insert result at @ character</span>\n    <span class=\"hljs-keyword\">mov</span> x3,x0\n    <span class=\"hljs-keyword\">mov</span> x0,x2                      <span class=\"hljs-comment\">// error code</span>\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrsZoneConv               <span class=\"hljs-comment\">// result address</span>\n    <span class=\"hljs-keyword\">bl</span> conversion10S                <span class=\"hljs-comment\">// conversion decimale</span>\n    <span class=\"hljs-keyword\">mov</span> x0,x3\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrsZoneConv\n    <span class=\"hljs-keyword\">bl</span> strInsertAtCharInc               <span class=\"hljs-comment\">// insert result at @ character</span>\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n<span class=\"hljs-number\">100</span>:\n    ldp x2,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>              <span class=\"hljs-comment\">// restaur  2 registers</span>\n    ret                            <span class=\"hljs-comment\">// return to address lr x30</span>\n<span class=\"hljs-symbol\">qAdrszMessErr:</span>                 .quad szMessErr\n<span class=\"hljs-comment\">/*********************************/</span>\n<span class=\"hljs-comment\">/* init terminal state            */</span>\n<span class=\"hljs-comment\">/*********************************/</span>\n<span class=\"hljs-symbol\">initTerm:</span>\n    stp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!            <span class=\"hljs-comment\">// save  registers</span>\n    <span class=\"hljs-comment\">/* read terminal state */</span>\n    <span class=\"hljs-keyword\">mov</span> x0,STDIN                   <span class=\"hljs-comment\">// input console</span>\n    <span class=\"hljs-keyword\">mov</span> x1,TCGETS\n    <span class=\"hljs-keyword\">ldr</span> x2,qAdrstOldtio\n    <span class=\"hljs-keyword\">mov</span> x8,IOCTL                   <span class=\"hljs-comment\">// call system Linux</span>\n    <span class=\"hljs-keyword\">svc</span> <span class=\"hljs-number\">0</span> \n    <span class=\"hljs-keyword\">cbnz</span> x0,<span class=\"hljs-number\">98</span>f                    <span class=\"hljs-comment\">// error ?</span>\n \n    <span class=\"hljs-keyword\">adr</span> x0,sighandler              <span class=\"hljs-comment\">// adresse routine traitement signal</span>\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrstSigAction         <span class=\"hljs-comment\">// adresse structure sigaction</span>\n    <span class=\"hljs-keyword\">str</span> x0,[x1,sa_handler]         <span class=\"hljs-comment\">// maj handler</span>\n    <span class=\"hljs-keyword\">mov</span> x0,SIGINT                  <span class=\"hljs-comment\">// signal type</span>\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrstSigAction\n    <span class=\"hljs-keyword\">mov</span> x2,<span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">mov</span> x3,<span class=\"hljs-number\">8</span>\n    <span class=\"hljs-keyword\">mov</span> x8,SIGACTION               <span class=\"hljs-comment\">// call system</span>\n    <span class=\"hljs-keyword\">svc</span> <span class=\"hljs-number\">0</span> \n \n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">0</span>                       <span class=\"hljs-comment\">// error ?</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">98</span>f\n    <span class=\"hljs-keyword\">mov</span> x0,SIGQUIT\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrstSigAction\n    <span class=\"hljs-keyword\">mov</span> x2,<span class=\"hljs-number\">0</span>                       <span class=\"hljs-comment\">// NULL</span>\n    <span class=\"hljs-keyword\">mov</span> x8,SIGACTION               <span class=\"hljs-comment\">// call system </span>\n    <span class=\"hljs-keyword\">svc</span> <span class=\"hljs-number\">0</span> \n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">0</span>                       <span class=\"hljs-comment\">// error ?</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">98</span>f\n    <span class=\"hljs-keyword\">mov</span> x0,SIGTERM\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrstSigAction\n    <span class=\"hljs-keyword\">mov</span> x2,<span class=\"hljs-number\">0</span>                       <span class=\"hljs-comment\">// NULL</span>\n    <span class=\"hljs-keyword\">mov</span> x8,SIGACTION               <span class=\"hljs-comment\">// appel systeme </span>\n    <span class=\"hljs-keyword\">svc</span> <span class=\"hljs-number\">0</span> \n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">98</span>f\n    <span class=\"hljs-comment\">//</span>\n    <span class=\"hljs-keyword\">adr</span> x0,qAdrSIG_IGN             <span class=\"hljs-comment\">// address signal igonre function</span>\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrstSigAction1\n    <span class=\"hljs-keyword\">str</span> x0,[x1,sa_handler]\n    <span class=\"hljs-keyword\">mov</span> x0,SIGTTOU                 <span class=\"hljs-comment\">//invalidate other process signal</span>\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrstSigAction1\n    <span class=\"hljs-keyword\">mov</span> x2,<span class=\"hljs-number\">0</span>                       <span class=\"hljs-comment\">// NULL</span>\n    <span class=\"hljs-keyword\">mov</span> x8,SIGACTION               <span class=\"hljs-comment\">// call system </span>\n    <span class=\"hljs-keyword\">svc</span> <span class=\"hljs-number\">0</span> \n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">98</span>f\n    <span class=\"hljs-comment\">//</span>\n    <span class=\"hljs-comment\">/* read terminal current state  */</span>\n    <span class=\"hljs-keyword\">mov</span> x0,STDIN\n    <span class=\"hljs-keyword\">mov</span> x1,TCGETS\n    <span class=\"hljs-keyword\">ldr</span> x2,qAdrstCurtio            <span class=\"hljs-comment\">// address current termio</span>\n    <span class=\"hljs-keyword\">mov</span> x8,IOCTL                   <span class=\"hljs-comment\">// call systeme </span>\n    <span class=\"hljs-keyword\">svc</span> <span class=\"hljs-number\">0</span> \n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">0</span>                       <span class=\"hljs-comment\">// error ?</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">98</span>f\n    <span class=\"hljs-keyword\">mov</span> x2,ICANON <span class=\"hljs-title\">| ECHO           // no key pressed echo on display\n    mvn x2,x2                      // and one key \n    ldr x1,qAdrstCurtio\n    ldr x3,[x1,#term_c_lflag]\n    and x3,x2,x2                   // add flags \n    str x3,[x1,#term_c_lflag]      // and store\n    mov x0,STDIN                   // maj terminal current state \n    mov x1,TCSETS\n    ldr x2,qAdrstCurtio\n    mov x8,IOCTL                   // call system\n    svc 0 \n    cbz x0,100f\n98:                                // error display\n    ldr x1,qAdrszMessErrInitTerm\n    bl   displayError\n    mov x0,-1\n100:\n    ldp x1,lr,[sp],16              // restaur  2 registers\n    ret                            // return to address lr x30\nqAdrstSigAction2:    .quad stSigAction2\nqAdrstSigAction3:    .quad stSigAction3\n/*********************************/\n/* init instance epool            */\n/*********************************/\ninitPoll:\n    stp x1,lr,[sp,-16]!            // save  registers\n    ldr x0,qAdrstevents\n    mov x1,STDIN                   // maj structure events\n    str x1,[x0,#poll_fd]           // maj FD\n    mov x1,POLLIN                  // action code\n    str x1,[x0,#poll_event]\n    mov x0,0\n    mov x8,CREATPOLL               // create epoll instance\n    svc 0\n    cmp x0,0                       // error ?\n    ble 98f\n    mov x10,x0                     // return FD epoll instance\n    mov x1,EPOLL_CTL_ADD\n    mov x2,STDIN                   // Fd to we want add\n    ldr x3,qAdrstevents            // structure events address\n    mov x8,CTLPOLL                 // call system control epoll\n    svc 0\n    cmp x0,0                       // error ?\n    blt 98f                       // no\n    mov x0,x10                     // return FD epoll instance\n    b 100f\n98:                                // error display\n    ldr x1,qAdrszMessErrInitPoll   // error message\n    bl   displayError\n    mov x0,-1\n100:\n    ldp x1,lr,[sp],16              // restaur  2 registers\n    ret                            // return to address lr x30\n/*********************************/\n/* wait key                      */\n/*********************************/\n/* x0 contains FD poll    */\nwaitKey:\n    stp x1,lr,[sp,-16]!            // save  registers\n    ldr x11,qAdrqTouche            // key address\n    str xzr,[x11]                  // raz key\n1:\n    ldr x1,qAdrqEnd                // if signal ctrl-c  -&gt; end\n    ldr x1,[x1]\n    cbnz x1,100f\n \n    ldr x1,qAdrstevents\n    mov x2,12                      // size events\n    mov x3,1                       // timeout = 1  TODO: ??\n    mov x4,0\n    mov x8,SYSPOLL                 // call system wait POLL\n    svc 0 \n    cmp x0,0                       // key pressed ?\n    bge 100f\n98:                                // error display\n    ldr x1,qAdrszMessErreurKey        // error message\n    bl   displayError\n    mov x0,-1\n100:\n    ldp x1,lr,[sp],16              // restaur  2 registers\n    ret                            // return to address lr x30\n/*********************************/\n/* read key                      */\n/*********************************/\n/* x0 returns key value */\nreadKey:\n    stp x1,lr,[sp,-16]!            // save  registers\n    mov x0,STDIN                   // File Descriptor\n    ldr x1,qAdrqTouche             // buffer address\n    mov x2,KEYSIZE                 // key size\n    mov x8,READ                    // read key\n    svc #0\n    cmp x0,0                       // error ?\n    ble 98f\n    ldr x2,qAdrqTouche             // key address\n    ldr x0,[x2]\n    b 100f\n98:                                // error display\n    ldr x1,qAdrszMessErreur        // error message\n    bl   displayError\n    mov x0,-1\n100:\n    ldp x1,lr,[sp],16              // restaur  2 registers\n    ret                            // return to address lr x30\n/*********************************/\n/* restaur terminal state        */\n/*********************************/\nrestauTerm:\n    stp x1,lr,[sp,-16]!            // save  registers\n    mov x0,STDIN                   // end then restaur begin state terminal\n    mov x1,TCSETS\n    ldr x2,qAdrstOldtio\n    mov x8,IOCTL                   // call system  \n    svc 0\n    cbz x0,100f\n    ldr x1,qAdrszMessErreur        // error message\n    bl   displayError\n100:\n    ldp x1,lr,[sp],16              // restaur  2 registers\n    ret                            // return to address lr x30\n/********************************************************/\n/*        File Include fonctions                        */\n/********************************************************/\n/* for this file see task include a file in language AArch64 assembly */\n.include &quot;../includeARM64.inc&quot;\n</span>"
    }
  },
  "contributors": [],
  "explanationUrl": {}
}
