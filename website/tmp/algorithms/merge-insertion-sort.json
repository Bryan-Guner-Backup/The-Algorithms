{
  "slug": "merge-insertion-sort",
  "name": "Merge Insertion Sort",
  "categories": ["sorts"],
  "body": {},
  "implementations": {
    "python": {
      "dir": "sorts/merge_insertion_sort.py",
      "url": "https://github.com/TheAlgorithms/python/tree/master/sorts/merge_insertion_sort.py",
      "code": "<span class=\"hljs-string\">&quot;&quot;&quot;\nThis is a pure Python implementation of the merge-insertion sort algorithm\nSource: https://en.wikipedia.org/wiki/Merge-insertion_sort\n\nFor doctests run following command:\npython3 -m doctest -v merge_insertion_sort.py\nor\npython -m doctest -v merge_insertion_sort.py\n\nFor manual testing run:\npython3 merge_insertion_sort.py\n&quot;&quot;&quot;</span>\n\n<span class=\"hljs-keyword\">from</span> __future__ <span class=\"hljs-keyword\">import</span> annotations\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">merge_insertion_sort</span>(<span class=\"hljs-params\">collection: <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">int</span>]</span>) -&gt; <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">int</span>]:\n    <span class=\"hljs-string\">&quot;&quot;&quot;Pure implementation of merge-insertion sort algorithm in Python\n\n    :param collection: some mutable ordered collection with heterogeneous\n    comparable items inside\n    :return: the same collection ordered by ascending\n\n    Examples:\n    &gt;&gt;&gt; merge_insertion_sort([0, 5, 3, 2, 2])\n    [0, 2, 2, 3, 5]\n\n    &gt;&gt;&gt; merge_insertion_sort([99])\n    [99]\n\n    &gt;&gt;&gt; merge_insertion_sort([-2, -5, -45])\n    [-45, -5, -2]\n    &quot;&quot;&quot;</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">binary_search_insertion</span>(<span class=\"hljs-params\">sorted_list, item</span>):\n        left = <span class=\"hljs-number\">0</span>\n        right = <span class=\"hljs-built_in\">len</span>(sorted_list) - <span class=\"hljs-number\">1</span>\n        <span class=\"hljs-keyword\">while</span> left &lt;= right:\n            middle = (left + right) // <span class=\"hljs-number\">2</span>\n            <span class=\"hljs-keyword\">if</span> left == right:\n                <span class=\"hljs-keyword\">if</span> sorted_list[middle] &lt; item:\n                    left = middle + <span class=\"hljs-number\">1</span>\n                <span class=\"hljs-keyword\">break</span>\n            <span class=\"hljs-keyword\">elif</span> sorted_list[middle] &lt; item:\n                left = middle + <span class=\"hljs-number\">1</span>\n            <span class=\"hljs-keyword\">else</span>:\n                right = middle - <span class=\"hljs-number\">1</span>\n        sorted_list.insert(left, item)\n        <span class=\"hljs-keyword\">return</span> sorted_list\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">sortlist_2d</span>(<span class=\"hljs-params\">list_2d</span>):\n        <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">merge</span>(<span class=\"hljs-params\">left, right</span>):\n            result = []\n            <span class=\"hljs-keyword\">while</span> left <span class=\"hljs-keyword\">and</span> right:\n                <span class=\"hljs-keyword\">if</span> left[<span class=\"hljs-number\">0</span>][<span class=\"hljs-number\">0</span>] &lt; right[<span class=\"hljs-number\">0</span>][<span class=\"hljs-number\">0</span>]:\n                    result.append(left.pop(<span class=\"hljs-number\">0</span>))\n                <span class=\"hljs-keyword\">else</span>:\n                    result.append(right.pop(<span class=\"hljs-number\">0</span>))\n            <span class=\"hljs-keyword\">return</span> result + left + right\n\n        length = <span class=\"hljs-built_in\">len</span>(list_2d)\n        <span class=\"hljs-keyword\">if</span> length &lt;= <span class=\"hljs-number\">1</span>:\n            <span class=\"hljs-keyword\">return</span> list_2d\n        middle = length // <span class=\"hljs-number\">2</span>\n        <span class=\"hljs-keyword\">return</span> merge(sortlist_2d(list_2d[:middle]), sortlist_2d(list_2d[middle:]))\n\n    <span class=\"hljs-keyword\">if</span> <span class=\"hljs-built_in\">len</span>(collection) &lt;= <span class=\"hljs-number\">1</span>:\n        <span class=\"hljs-keyword\">return</span> collection\n\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    Group the items into two pairs, and leave one element if there is a last odd item.\n\n    Example: [999, 100, 75, 40, 10000]\n                -&gt; [999, 100], [75, 40]. Leave 10000.\n    &quot;&quot;&quot;</span>\n    two_paired_list = []\n    has_last_odd_item = <span class=\"hljs-literal\">False</span>\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">0</span>, <span class=\"hljs-built_in\">len</span>(collection), <span class=\"hljs-number\">2</span>):\n        <span class=\"hljs-keyword\">if</span> i == <span class=\"hljs-built_in\">len</span>(collection) - <span class=\"hljs-number\">1</span>:\n            has_last_odd_item = <span class=\"hljs-literal\">True</span>\n        <span class=\"hljs-keyword\">else</span>:\n            <span class=\"hljs-string\">&quot;&quot;&quot;\n            Sort two-pairs in each groups.\n\n            Example: [999, 100], [75, 40]\n                        -&gt; [100, 999], [40, 75]\n            &quot;&quot;&quot;</span>\n            <span class=\"hljs-keyword\">if</span> collection[i] &lt; collection[i + <span class=\"hljs-number\">1</span>]:\n                two_paired_list.append([collection[i], collection[i + <span class=\"hljs-number\">1</span>]])\n            <span class=\"hljs-keyword\">else</span>:\n                two_paired_list.append([collection[i + <span class=\"hljs-number\">1</span>], collection[i]])\n\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    Sort two_paired_list.\n\n    Example: [100, 999], [40, 75]\n                -&gt; [40, 75], [100, 999]\n    &quot;&quot;&quot;</span>\n    sorted_list_2d = sortlist_2d(two_paired_list)\n\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    40 &lt; 100 is sure because it has already been sorted.\n    Generate the sorted_list of them so that you can avoid unnecessary comparison.\n\n    Example:\n           group0 group1\n           40     100\n           75     999\n        -&gt;\n           group0 group1\n           [40,   100]\n           75     999\n    &quot;&quot;&quot;</span>\n    result = [i[<span class=\"hljs-number\">0</span>] <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> sorted_list_2d]\n\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    100 &lt; 999 is sure because it has already been sorted.\n    Put 999 in last of the sorted_list so that you can avoid unnecessary comparison.\n\n    Example:\n           group0 group1\n           [40,   100]\n           75     999\n        -&gt;\n           group0 group1\n           [40,   100,   999]\n           75\n    &quot;&quot;&quot;</span>\n    result.append(sorted_list_2d[-<span class=\"hljs-number\">1</span>][<span class=\"hljs-number\">1</span>])\n\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    Insert the last odd item left if there is.\n\n    Example:\n           group0 group1\n           [40,   100,   999]\n           75\n        -&gt;\n           group0 group1\n           [40,   100,   999,   10000]\n           75\n    &quot;&quot;&quot;</span>\n    <span class=\"hljs-keyword\">if</span> has_last_odd_item:\n        pivot = collection[-<span class=\"hljs-number\">1</span>]\n        result = binary_search_insertion(result, pivot)\n\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    Insert the remaining items.\n    In this case, 40 &lt; 75 is sure because it has already been sorted.\n    Therefore, you only need to insert 75 into [100, 999, 10000],\n    so that you can avoid unnecessary comparison.\n\n    Example:\n           group0 group1\n           [40,   100,   999,   10000]\n            ^ You don&#x27;t need to compare with this as 40 &lt; 75 is already sure.\n           75\n        -&gt;\n           [40,   75,    100,   999,   10000]\n    &quot;&quot;&quot;</span>\n    is_last_odd_item_inserted_before_this_index = <span class=\"hljs-literal\">False</span>\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-built_in\">len</span>(sorted_list_2d) - <span class=\"hljs-number\">1</span>):\n        <span class=\"hljs-keyword\">if</span> result[i] == collection[-i]:\n            is_last_odd_item_inserted_before_this_index = <span class=\"hljs-literal\">True</span>\n        pivot = sorted_list_2d[i][<span class=\"hljs-number\">1</span>]\n        <span class=\"hljs-comment\"># If last_odd_item is inserted before the item&#x27;s index,</span>\n        <span class=\"hljs-comment\"># you should forward index one more.</span>\n        <span class=\"hljs-keyword\">if</span> is_last_odd_item_inserted_before_this_index:\n            result = result[: i + <span class=\"hljs-number\">2</span>] + binary_search_insertion(result[i + <span class=\"hljs-number\">2</span> :], pivot)\n        <span class=\"hljs-keyword\">else</span>:\n            result = result[: i + <span class=\"hljs-number\">1</span>] + binary_search_insertion(result[i + <span class=\"hljs-number\">1</span> :], pivot)\n\n    <span class=\"hljs-keyword\">return</span> result\n\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\n    user_input = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&quot;Enter numbers separated by a comma:\\n&quot;</span>).strip()\n    unsorted = [<span class=\"hljs-built_in\">int</span>(item) <span class=\"hljs-keyword\">for</span> item <span class=\"hljs-keyword\">in</span> user_input.split(<span class=\"hljs-string\">&quot;,&quot;</span>)]\n    <span class=\"hljs-built_in\">print</span>(merge_insertion_sort(unsorted))\n"
    },
    "c-plus-plus": {
      "dir": "sorting/merge_insertion_sort.cpp",
      "url": "https://github.com/TheAlgorithms/c-plus-plus/tree/master/sorting/merge_insertion_sort.cpp",
      "code": "<span class=\"hljs-comment\">/**\n * @file\n * @author [@sinkyoungdeok](https://github.com/sinkyoungdeok)\n * @author [Krishna Vedala](https://github.com/kvedala)\n * @brief Algorithm that combines insertion sort and merge sort. [Wiki\n * link](https://en.wikipedia.org/wiki/Merge-insertion_sort)\n *\n * @see Individual algorithms: insertion_sort.cpp and merge_sort.cpp\n */</span>\n<span class=\"hljs-meta\">#<span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&lt;algorithm&gt;</span></span>\n<span class=\"hljs-meta\">#<span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&lt;array&gt;</span></span>\n<span class=\"hljs-meta\">#<span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&lt;cassert&gt;</span></span>\n<span class=\"hljs-meta\">#<span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&lt;ctime&gt;</span></span>\n<span class=\"hljs-meta\">#<span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&lt;iostream&gt;</span></span>\n<span class=\"hljs-meta\">#<span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&lt;memory&gt;</span></span>\n\n<span class=\"hljs-comment\">/** \\namespace sorting\n * \\brief Sorting algorithms\n */</span>\n<span class=\"hljs-keyword\">namespace</span> sorting {\n<span class=\"hljs-comment\">/** \\namespace merge_insertion\n * \\brief Combined Intersion-Merge sorting algorithm\n */</span>\n<span class=\"hljs-keyword\">namespace</span> merge_insertion {\n\n<span class=\"hljs-comment\">/**\n * @brief Insertion merge algorithm\n * @see insertion_sort.cpp\n *\n * @tparam T array data type\n * @tparam N length of array\n * @param A pointer to array to sort\n * @param start start index of sorting window\n * @param end end index of sorting window\n */</span>\n<span class=\"hljs-keyword\">template</span> &lt;<span class=\"hljs-keyword\">typename</span> T, <span class=\"hljs-type\">size_t</span> N&gt;\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">static</span> <span class=\"hljs-type\">void</span> <span class=\"hljs-title\">InsertionSort</span><span class=\"hljs-params\">(std::array&lt;T, N&gt; *A, <span class=\"hljs-type\">size_t</span> start, <span class=\"hljs-type\">size_t</span> end)</span> </span>{\n    <span class=\"hljs-type\">size_t</span> i = <span class=\"hljs-number\">0</span>, j = <span class=\"hljs-number\">0</span>;\n    T *ptr = A-&gt;<span class=\"hljs-built_in\">data</span>();\n\n    <span class=\"hljs-keyword\">for</span> (i = start; i &lt; end; i++) {\n        T temp = ptr[i];\n        j = i;\n        <span class=\"hljs-keyword\">while</span> (j &gt; start &amp;&amp; temp &lt; ptr[j - <span class=\"hljs-number\">1</span>]) {\n            ptr[j] = ptr[j - <span class=\"hljs-number\">1</span>];\n            j--;\n        }\n        <span class=\"hljs-comment\">//   for (j = i; j &gt; start &amp;&amp; temp &lt; ptr[j - 1]; --j) {</span>\n        <span class=\"hljs-comment\">//       ptr[j] = ptr[j - 1];</span>\n        <span class=\"hljs-comment\">//   }</span>\n\n        ptr[j] = temp;\n    }\n}\n\n<span class=\"hljs-comment\">/**\n * @brief Perform merge of data in a window\n *\n * @tparam T array data type\n * @tparam N length of array\n * @param A pointer to array to sort\n * @param min start index of window\n * @param max end index of window\n * @param mid mid-point of window\n */</span>\n<span class=\"hljs-keyword\">template</span> &lt;<span class=\"hljs-keyword\">typename</span> T, <span class=\"hljs-type\">size_t</span> N&gt;\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">static</span> <span class=\"hljs-type\">void</span> <span class=\"hljs-title\">merge</span><span class=\"hljs-params\">(std::array&lt;T, N&gt; *array, <span class=\"hljs-type\">size_t</span> min, <span class=\"hljs-type\">size_t</span> max, <span class=\"hljs-type\">size_t</span> mid)</span> </span>{\n    <span class=\"hljs-type\">size_t</span> firstIndex = min;\n    <span class=\"hljs-type\">size_t</span> secondIndex = mid + <span class=\"hljs-number\">1</span>;\n\n    <span class=\"hljs-keyword\">auto</span> ptr = array-&gt;<span class=\"hljs-built_in\">data</span>();\n    std::array&lt;T, N + 1&gt; tempArray{<span class=\"hljs-number\">0</span>};\n\n    <span class=\"hljs-comment\">// While there are elements in the left or right runs</span>\n    <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">size_t</span> index = min; index &lt;= max; index++) {\n        <span class=\"hljs-comment\">// If left run head exists and is &lt;= existing right run head.</span>\n        <span class=\"hljs-keyword\">if</span> (firstIndex &lt;= mid &amp;&amp;\n            (secondIndex &gt; max || ptr[firstIndex] &lt;= ptr[secondIndex])) {\n            tempArray[index] = ptr[firstIndex];\n            firstIndex++;\n        } <span class=\"hljs-keyword\">else</span> {\n            tempArray[index] = ptr[secondIndex];\n            secondIndex++;\n        }\n    }\n\n    <span class=\"hljs-comment\">// transfer to the initial array</span>\n    <span class=\"hljs-built_in\">memcpy</span>(ptr + min, tempArray.<span class=\"hljs-built_in\">data</span>() + min, (max - min) * <span class=\"hljs-built_in\">sizeof</span>(T));\n    <span class=\"hljs-comment\">//  for (int index = min; index &lt;= max; index++) ptr[index] =</span>\n    <span class=\"hljs-comment\">//  tempArray[index];</span>\n}\n\n<span class=\"hljs-comment\">/**\n * @brief Final combined algorithm.\n * Algorithm utilizes ::sorting::merge_insertion::InsertionSort if window length\n * is less than threshold, else performs merge sort recursively using\n * ::sorting::merge_insertion::mergeSort\n *\n * @tparam T array data type\n * @tparam N length of array\n * @param A pointer to array to sort\n * @param min start index of sort window\n * @param max end index of sort window\n * @param threshold window length threshold\n */</span>\n<span class=\"hljs-keyword\">template</span> &lt;<span class=\"hljs-keyword\">typename</span> T, <span class=\"hljs-type\">size_t</span> N&gt;\n<span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">mergeSort</span><span class=\"hljs-params\">(std::array&lt;T, N&gt; *array, <span class=\"hljs-type\">size_t</span> min, <span class=\"hljs-type\">size_t</span> max,\n               <span class=\"hljs-type\">size_t</span> threshold)</span> </span>{\n    <span class=\"hljs-comment\">// prerequisite</span>\n    <span class=\"hljs-keyword\">if</span> ((max - min) &lt;= threshold) {\n        <span class=\"hljs-built_in\">InsertionSort</span>(array, min, max);\n    } <span class=\"hljs-keyword\">else</span> {\n        <span class=\"hljs-comment\">// get the middle point</span>\n        <span class=\"hljs-type\">size_t</span> mid = (max + min) &gt;&gt; <span class=\"hljs-number\">1</span>;\n\n        <span class=\"hljs-comment\">// apply merge sort to both parts of this</span>\n        <span class=\"hljs-built_in\">mergeSort</span>(array, min, mid, threshold);\n        <span class=\"hljs-built_in\">mergeSort</span>(array, mid, max, threshold);\n\n        <span class=\"hljs-comment\">// and finally merge all that sorted stuff</span>\n        <span class=\"hljs-built_in\">merge</span>(array, min, max, mid);\n    }\n}\n\n}  <span class=\"hljs-comment\">// namespace merge_insertion</span>\n}  <span class=\"hljs-comment\">// namespace sorting</span>\n\n<span class=\"hljs-comment\">/**\n * @brief Function to test code using random arrays\n * @returns none\n */</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">static</span> <span class=\"hljs-type\">void</span> <span class=\"hljs-title\">test</span><span class=\"hljs-params\">()</span> </span>{\n    <span class=\"hljs-keyword\">constexpr</span> <span class=\"hljs-type\">size_t</span> size = <span class=\"hljs-number\">30</span>;\n    std::array&lt;<span class=\"hljs-type\">int</span>, size&gt; array{<span class=\"hljs-number\">0</span>};\n    <span class=\"hljs-comment\">// input</span>\n    <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; size; i++) {\n        array[i] = std::<span class=\"hljs-built_in\">rand</span>() % <span class=\"hljs-number\">100</span> - <span class=\"hljs-number\">50</span>;\n        std::cout &lt;&lt; array[i] &lt;&lt; <span class=\"hljs-string\">&quot; &quot;</span>;\n    }\n    std::cout &lt;&lt; std::endl;\n\n    sorting::merge_insertion::<span class=\"hljs-built_in\">InsertionSort</span>(&amp;array, <span class=\"hljs-number\">0</span>, size);\n    <span class=\"hljs-comment\">//  sorting::merge_insertion::mergeSort(&amp;array, 0, size, 10);</span>\n\n    <span class=\"hljs-comment\">// output</span>\n    <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> i = <span class=\"hljs-number\">0</span>; i &lt; size; ++i) {\n        std::cout &lt;&lt; array[i] &lt;&lt; <span class=\"hljs-string\">&quot; &quot;</span>;\n    }\n    std::cout &lt;&lt; std::endl;\n\n    <span class=\"hljs-built_in\">assert</span>(std::<span class=\"hljs-built_in\">is_sorted</span>(std::<span class=\"hljs-built_in\">begin</span>(array), std::<span class=\"hljs-built_in\">end</span>(array)));\n    std::cout &lt;&lt; <span class=\"hljs-string\">&quot;Test passed\\n&quot;</span>;\n}\n\n<span class=\"hljs-comment\">/**\n * @brief Main function\n * @return 0 on exit\n */</span>\n<span class=\"hljs-function\"><span class=\"hljs-type\">int</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">()</span> </span>{\n    std::<span class=\"hljs-built_in\">srand</span>(std::<span class=\"hljs-built_in\">time</span>(<span class=\"hljs-literal\">nullptr</span>));\n    <span class=\"hljs-built_in\">test</span>();\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0</span>;\n}\n"
    }
  },
  "contributors": [
    {
      "name": "Christian Clauss",
      "email": "cclauss@me.com",
      "commits": 1
    },
    {
      "name": "Krishna Vedala",
      "email": "7001608+kvedala@users.noreply.github.com",
      "commits": 1
    },
    {
      "name": "ryuta69",
      "email": "eyma22s.yu@gmail.com",
      "commits": 1
    }
  ],
  "explanationUrl": {}
}
