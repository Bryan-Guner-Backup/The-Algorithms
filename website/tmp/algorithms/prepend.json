{
  "slug": "prepend",
  "name": "Prepend",
  "categories": ["strings"],
  "body": {},
  "implementations": {
    "aarch64_assembly": {
      "dir": "string/prepend.s",
      "url": "https://github.com/TheAlgorithms/aarch64_assembly/tree/master/string/prepend.s",
      "code": "<span class=\"hljs-comment\">/* ARM assembly AARCH64 Raspberry PI 3B */</span>\n<span class=\"hljs-comment\">/*  program appendstr64.s   */</span>\n \n<span class=\"hljs-comment\">/*******************************************/</span>\n<span class=\"hljs-comment\">/* Constantes file                         */</span>\n<span class=\"hljs-comment\">/*******************************************/</span>\n<span class=\"hljs-comment\">/* for this file see task include a file in language AArch64 assembly*/</span>\n<span class=\"hljs-symbol\">.include</span> <span class=\"hljs-string\">&quot;../includeConstantesARM64.inc&quot;</span>\n \n<span class=\"hljs-comment\">/*******************************************/</span>\n<span class=\"hljs-comment\">/* Initialized data                        */</span>\n<span class=\"hljs-comment\">/*******************************************/</span>\n<span class=\"hljs-symbol\">.data</span>\n<span class=\"hljs-symbol\">szMessString:</span>            <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;British Museum.\\n&quot;</span>\n<span class=\"hljs-symbol\">szComplement:</span>            <span class=\"hljs-meta\">.skip</span> <span class=\"hljs-number\">80</span>\n<span class=\"hljs-symbol\">szStringStart:</span>           <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;The rosetta stone is at &quot;</span>\n<span class=\"hljs-symbol\">szCarriageReturn:</span>        <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;\\n&quot;</span>\n<span class=\"hljs-comment\">/*******************************************/</span>\n<span class=\"hljs-comment\">/* UnInitialized data                      */</span>\n<span class=\"hljs-comment\">/*******************************************/</span>\n<span class=\"hljs-symbol\">.bss</span> \n<span class=\"hljs-comment\">/*******************************************/</span>\n<span class=\"hljs-comment\">/*  code section                           */</span>\n<span class=\"hljs-comment\">/*******************************************/</span>\n<span class=\"hljs-symbol\">.text</span>\n<span class=\"hljs-symbol\">.global</span> main \n<span class=\"hljs-symbol\">main:</span> \n \n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMessString               <span class=\"hljs-comment\">// display message</span>\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n \n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMessString\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrszStringStart\n    <span class=\"hljs-keyword\">bl</span> prepend                             <span class=\"hljs-comment\">// append sting2 to string1</span>\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMessString\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n \n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszCarriageReturn\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n \n \n<span class=\"hljs-number\">100</span>:                                      <span class=\"hljs-comment\">// standard end of the program</span>\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">0</span>                              <span class=\"hljs-comment\">// return code</span>\n    <span class=\"hljs-keyword\">mov</span> x8,EXIT                           <span class=\"hljs-comment\">// request to exit program</span>\n    <span class=\"hljs-keyword\">svc</span> <span class=\"hljs-number\">0</span>                                 <span class=\"hljs-comment\">// perform system call</span>\n<span class=\"hljs-symbol\">qAdrszMessString:</span>         .quad szMessString\n<span class=\"hljs-symbol\">qAdrszStringStart:</span>        .quad szStringStart\n<span class=\"hljs-symbol\">qAdrszCarriageReturn:</span>     .quad szCarriageReturn\n<span class=\"hljs-comment\">/**************************************************/</span>\n<span class=\"hljs-comment\">/*     append two strings                         */</span> \n<span class=\"hljs-comment\">/**************************************************/</span>\n<span class=\"hljs-comment\">/* x0 contains the address of the string1 */</span>\n<span class=\"hljs-comment\">/* x1 contains the address of the string2 */</span>\n<span class=\"hljs-symbol\">prepend:</span>\n    stp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!            <span class=\"hljs-comment\">// save  registers</span>\n    <span class=\"hljs-keyword\">mov</span> x3,<span class=\"hljs-number\">#0</span>                                <span class=\"hljs-comment\">// length counter </span>\n<span class=\"hljs-number\">1</span>:                                           <span class=\"hljs-comment\">// compute length of string 1</span>\n    <span class=\"hljs-keyword\">ldrb</span> w4,[x0,x3]\n    <span class=\"hljs-keyword\">cmp</span> w4,<span class=\"hljs-number\">#0</span>\n    cinc  x3,x3,ne                           <span class=\"hljs-comment\">// increment to one if not equal</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">1</span>b                                   <span class=\"hljs-comment\">// loop if not equal</span>\n    <span class=\"hljs-keyword\">mov</span> x5,<span class=\"hljs-number\">#0</span>                                <span class=\"hljs-comment\">// length counter insertion string</span>\n<span class=\"hljs-number\">2</span>:                                           <span class=\"hljs-comment\">// compute length of insertion string</span>\n    <span class=\"hljs-keyword\">ldrb</span> w4,[x1,x5]\n    <span class=\"hljs-keyword\">cmp</span> x4,<span class=\"hljs-number\">#0</span>\n    cinc  x5,x5,ne                           <span class=\"hljs-comment\">// increment to one if not equal</span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">2</span>b\n    <span class=\"hljs-keyword\">cmp</span> x5,<span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">99</span>f                                  <span class=\"hljs-comment\">// string empty -&gt; error</span>\n    <span class=\"hljs-keyword\">add</span> x3,x3,x5                             <span class=\"hljs-comment\">// add 2 length</span>\n    <span class=\"hljs-keyword\">add</span> x3,x3,<span class=\"hljs-number\">#1</span>                             <span class=\"hljs-comment\">// +1 for final zero</span>\n    <span class=\"hljs-keyword\">mov</span> x6,x0                                <span class=\"hljs-comment\">// save address string 1</span>\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#0</span>                                <span class=\"hljs-comment\">// allocation place heap</span>\n    <span class=\"hljs-keyword\">mov</span> x8,BRK                               <span class=\"hljs-comment\">// call system &#x27;brk&#x27;</span>\n    <span class=\"hljs-keyword\">svc</span> <span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">mov</span> x5,x0                                <span class=\"hljs-comment\">// save address heap for output string</span>\n    <span class=\"hljs-keyword\">add</span> x0,x0,x3                             <span class=\"hljs-comment\">// reservation place x3 length</span>\n    <span class=\"hljs-keyword\">mov</span> x8,BRK                               <span class=\"hljs-comment\">// call system &#x27;brk&#x27;</span>\n    <span class=\"hljs-keyword\">svc</span> <span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">cmp</span> x0,#-<span class=\"hljs-number\">1</span>                               <span class=\"hljs-comment\">// allocation error</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">99</span>f\n    <span class=\"hljs-keyword\">mov</span> x4,<span class=\"hljs-number\">#0</span>                      <span class=\"hljs-comment\">// counter byte string 2</span>\n<span class=\"hljs-number\">3</span>:\n    <span class=\"hljs-keyword\">ldrb</span> w3,[x1,x4]                <span class=\"hljs-comment\">// load byte string 2</span>\n    <span class=\"hljs-keyword\">cbz</span> x3,<span class=\"hljs-number\">4</span>f                      <span class=\"hljs-comment\">// zero final ?</span>\n    <span class=\"hljs-keyword\">strb</span> w3,[x5,x4]                <span class=\"hljs-comment\">// store byte string 2 in heap</span>\n    <span class=\"hljs-keyword\">add</span> x4,x4,<span class=\"hljs-number\">1</span>                    <span class=\"hljs-comment\">// increment counter 1</span>\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">3</span>b                           <span class=\"hljs-comment\">// no -&gt; loop</span>\n<span class=\"hljs-number\">4</span>:\n    <span class=\"hljs-keyword\">mov</span> x2,<span class=\"hljs-number\">#0</span>                      <span class=\"hljs-comment\">// counter byte string 1</span>\n<span class=\"hljs-number\">5</span>:\n    <span class=\"hljs-keyword\">ldrb</span> w3,[x6,x2]                <span class=\"hljs-comment\">// load byte string 1</span>\n    <span class=\"hljs-keyword\">strb</span> w3,[x5,x4]                <span class=\"hljs-comment\">// store byte string in heap</span>\n    <span class=\"hljs-keyword\">cbz</span> x3,<span class=\"hljs-number\">6</span>f                    <span class=\"hljs-comment\">// zero final ?</span>\n    <span class=\"hljs-keyword\">add</span> x2,x2,<span class=\"hljs-number\">1</span>                    <span class=\"hljs-comment\">// no -&gt; increment counter 1</span>\n    <span class=\"hljs-keyword\">add</span> x4,x4,<span class=\"hljs-number\">1</span>                    <span class=\"hljs-comment\">// no -&gt; increment counter 2</span>\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">5</span>b                           <span class=\"hljs-comment\">// no -&gt; loop</span>\n<span class=\"hljs-number\">6</span>:                                 <span class=\"hljs-comment\">// recopie heap in string 1</span>\n    <span class=\"hljs-keyword\">mov</span> x2,<span class=\"hljs-number\">#0</span>                      <span class=\"hljs-comment\">// counter byte string </span>\n<span class=\"hljs-number\">7</span>:\n    <span class=\"hljs-keyword\">ldrb</span> w3,[x5,x2]                <span class=\"hljs-comment\">// load byte string in heap</span>\n    <span class=\"hljs-keyword\">strb</span> w3,[x6,x2]                <span class=\"hljs-comment\">// store byte string 1</span>\n    <span class=\"hljs-keyword\">cbz</span> x3,<span class=\"hljs-number\">100</span>f                    <span class=\"hljs-comment\">// zero final ?</span>\n    <span class=\"hljs-keyword\">add</span> x2,x2,<span class=\"hljs-number\">1</span>                    <span class=\"hljs-comment\">// no -&gt; increment counter 1</span>\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">7</span>b                           <span class=\"hljs-comment\">// no -&gt; loop</span>\n<span class=\"hljs-number\">100</span>:\n \n    ldp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>              <span class=\"hljs-comment\">// restaur  2 registers</span>\n    ret                            <span class=\"hljs-comment\">// return to address lr x30</span>\n<span class=\"hljs-comment\">/********************************************************/</span>\n<span class=\"hljs-comment\">/*        File Include fonctions                        */</span>\n<span class=\"hljs-comment\">/********************************************************/</span>\n<span class=\"hljs-comment\">/* for this file see task include a file in language AArch64 assembly */</span>\n<span class=\"hljs-symbol\">.include</span> <span class=\"hljs-string\">&quot;../includeARM64.inc&quot;</span>\n"
    }
  },
  "contributors": [
    {
      "name": "Mertcan Davulcu",
      "email": "54983926+mertcandav@users.noreply.github.com",
      "commits": 1
    }
  ],
  "explanationUrl": {}
}
