{
  "slug": "josephus-problem",
  "name": "Josephus Problem",
  "categories": ["others"],
  "body": {},
  "implementations": {
    "aarch64_assembly": {
      "dir": "misc/josephus_problem.s",
      "url": "https://github.com/TheAlgorithms/aarch64_assembly/tree/master/misc/josephus_problem.s",
      "code": "<span class=\"hljs-comment\">/* ARM assembly AARCH64 Raspberry PI 3B */</span>\n<span class=\"hljs-comment\">/*  program josephus64.s   */</span>\n<span class=\"hljs-comment\">/* run with josephus64 maxi intervalle */</span>\n<span class=\"hljs-comment\">/* example : josephus64 41 3\n \n/*******************************************/</span>\n<span class=\"hljs-comment\">/* Constantes file                         */</span>\n<span class=\"hljs-comment\">/*******************************************/</span>\n<span class=\"hljs-comment\">/* for this file see task include a file in language AArch64 assembly*/</span>\n<span class=\"hljs-symbol\">.include</span> <span class=\"hljs-string\">&quot;../includeConstantesARM64.inc&quot;</span>\n \n<span class=\"hljs-symbol\">.equ</span> FIRSTNODE,        <span class=\"hljs-number\">0</span>              <span class=\"hljs-comment\">//identification first node </span>\n \n<span class=\"hljs-comment\">/*******************************************/</span>\n<span class=\"hljs-comment\">/* Structures                               */</span>\n<span class=\"hljs-comment\">/********************************************/</span>\n<span class=\"hljs-comment\">/* structure linkedlist*/</span>\n    .struct  <span class=\"hljs-number\">0</span>\n<span class=\"hljs-symbol\">llist_next:</span>                            <span class=\"hljs-comment\">// next element</span>\n    .struct  llist_next + <span class=\"hljs-number\">8</span>\n<span class=\"hljs-symbol\">llist_value:</span>                           <span class=\"hljs-comment\">// element value</span>\n    .struct  llist_value + <span class=\"hljs-number\">8</span>\n<span class=\"hljs-symbol\">llist_fin:</span>\n<span class=\"hljs-comment\">/*********************************/</span>\n<span class=\"hljs-comment\">/* Initialized data              */</span>\n<span class=\"hljs-comment\">/*********************************/</span>\n<span class=\"hljs-symbol\">.data</span>\n<span class=\"hljs-symbol\">szMessDebutPgm:</span>          <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;Start program.\\n&quot;</span>\n<span class=\"hljs-symbol\">szMessFinPgm:</span>            <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;Program End ok.\\n&quot;</span>\n<span class=\"hljs-symbol\">szRetourLigne:</span>            <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;\\n&quot;</span>\n<span class=\"hljs-symbol\">szMessValElement:</span>        <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;Value : @ \\n&quot;</span>\n<span class=\"hljs-symbol\">szMessListeVide:</span>         <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;List empty.\\n&quot;</span>\n<span class=\"hljs-symbol\">szMessImpElement:</span>        <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;Node display: @ Value : @ Next @ \\n&quot;</span>\n<span class=\"hljs-symbol\">szMessErrComm:</span>           <span class=\"hljs-meta\">.asciz</span> <span class=\"hljs-string\">&quot;Incomplete Command line  : josephus64 &lt;maxi&gt; &lt;intervalle&gt;\\n&quot;</span>\n<span class=\"hljs-comment\">/*********************************/</span>\n<span class=\"hljs-comment\">/* UnInitialized data            */</span>\n<span class=\"hljs-comment\">/*********************************/</span>\n<span class=\"hljs-symbol\">.bss</span>  \n<span class=\"hljs-symbol\">sZoneConv:</span>         <span class=\"hljs-meta\">.skip</span> <span class=\"hljs-number\">100</span>\n<span class=\"hljs-symbol\">.align</span> <span class=\"hljs-number\">4</span>\n<span class=\"hljs-symbol\">qDebutListe1:</span>       <span class=\"hljs-meta\">.skip</span> llist_fin\n<span class=\"hljs-comment\">/*********************************/</span>\n<span class=\"hljs-comment\">/*  code section                 */</span>\n<span class=\"hljs-comment\">/*********************************/</span>\n<span class=\"hljs-symbol\">.text</span>\n<span class=\"hljs-symbol\">.global</span> main \n<span class=\"hljs-symbol\">main:</span>                                   <span class=\"hljs-comment\">// entry of program </span>\n    <span class=\"hljs-keyword\">mov</span> <span class=\"hljs-built_in\">fp</span>,<span class=\"hljs-built_in\">sp</span>                           <span class=\"hljs-comment\">// copy stack address  register x29 fp</span>\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMessDebutPgm\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">ldr</span> x0,[<span class=\"hljs-built_in\">fp</span>]                         <span class=\"hljs-comment\">// parameter number command line</span>\n    <span class=\"hljs-keyword\">cmp</span> x0,<span class=\"hljs-number\">#2</span>                           <span class=\"hljs-comment\">// correct ?</span>\n    <span class=\"hljs-keyword\">ble</span> erreurCommande                  <span class=\"hljs-comment\">// error</span>\n \n    <span class=\"hljs-keyword\">add</span> x0,<span class=\"hljs-built_in\">fp</span>,<span class=\"hljs-number\">#16</span>                       <span class=\"hljs-comment\">// address parameter 2</span>\n    <span class=\"hljs-keyword\">ldr</span> x0,[x0]\n    <span class=\"hljs-keyword\">bl</span> conversionAtoD\n    <span class=\"hljs-keyword\">add</span> x22,x0,FIRSTNODE                <span class=\"hljs-comment\">// save maxi</span>\n    <span class=\"hljs-keyword\">add</span> x0,<span class=\"hljs-built_in\">fp</span>,<span class=\"hljs-number\">#24</span>                       <span class=\"hljs-comment\">// address parameter 3</span>\n    <span class=\"hljs-keyword\">ldr</span> x0,[x0]\n    <span class=\"hljs-keyword\">bl</span> conversionAtoD\n    <span class=\"hljs-keyword\">mov</span> x21,x0                          <span class=\"hljs-comment\">// save gap</span>\n \n    <span class=\"hljs-keyword\">mov</span> x0,FIRSTNODE                    <span class=\"hljs-comment\">// create first node</span>\n    <span class=\"hljs-keyword\">mov</span> x1,<span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">bl</span> createNode\n    <span class=\"hljs-keyword\">mov</span> x25,x0                          <span class=\"hljs-comment\">// first node address</span>\n    <span class=\"hljs-keyword\">mov</span> x26,x0\n    <span class=\"hljs-keyword\">mov</span> x24,FIRSTNODE + <span class=\"hljs-number\">1</span>\n    <span class=\"hljs-keyword\">mov</span> x23,<span class=\"hljs-number\">1</span>\n<span class=\"hljs-number\">1</span>:                                      <span class=\"hljs-comment\">// loop create others nodes</span>\n    <span class=\"hljs-keyword\">mov</span> x0,x24                          <span class=\"hljs-comment\">// key value</span>\n    <span class=\"hljs-keyword\">mov</span> x1,<span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">bl</span> createNode\n    <span class=\"hljs-keyword\">str</span> x0,[x26,llist_next]             <span class=\"hljs-comment\">// store current node address in prev node</span>\n    <span class=\"hljs-keyword\">mov</span> x26,x0\n    <span class=\"hljs-keyword\">add</span> x24,x24,<span class=\"hljs-number\">1</span>\n    <span class=\"hljs-keyword\">add</span> x23,x23,<span class=\"hljs-number\">1</span>\n    <span class=\"hljs-keyword\">cmp</span> x23,x22                         <span class=\"hljs-comment\">// maxi ?</span>\n    <span class=\"hljs-keyword\">blt</span> <span class=\"hljs-number\">1</span>b\n    <span class=\"hljs-keyword\">str</span> x25,[x26,llist_next]            <span class=\"hljs-comment\">// store first node address in last pointer</span>\n    <span class=\"hljs-keyword\">mov</span> x24,x26\n<span class=\"hljs-number\">2</span>:\n    <span class=\"hljs-keyword\">mov</span> x20,<span class=\"hljs-number\">1</span>                           <span class=\"hljs-comment\">// counter for gap</span>\n<span class=\"hljs-number\">3</span>:\n    <span class=\"hljs-keyword\">ldr</span> x24,[x24,llist_next]\n    <span class=\"hljs-keyword\">add</span> x20,x20,<span class=\"hljs-number\">1</span>\n    <span class=\"hljs-keyword\">cmp</span> x20,x21                         <span class=\"hljs-comment\">// intervalle ?</span>\n    <span class=\"hljs-keyword\">blt</span> <span class=\"hljs-number\">3</span>b\n    <span class=\"hljs-keyword\">ldr</span> x25,[x24,llist_next]            <span class=\"hljs-comment\">// removing the node from the list</span>\n    <span class=\"hljs-keyword\">ldr</span> x22,[x25,llist_value]\n    <span class=\"hljs-keyword\">ldr</span> x27,[x25,llist_next]            <span class=\"hljs-comment\">// load pointer next</span>\n    <span class=\"hljs-keyword\">str</span> x27,[x24,llist_next]            <span class=\"hljs-comment\">// ans store in prev node</span>\n    <span class=\"hljs-comment\">//mov x0,x25</span>\n    <span class=\"hljs-comment\">//bl displayNode</span>\n    <span class=\"hljs-keyword\">cmp</span> x27,x24\n    csel x24,x24,x27,ne                 <span class=\"hljs-comment\">// next node address </span>\n    <span class=\"hljs-keyword\">bne</span> <span class=\"hljs-number\">2</span>b                              <span class=\"hljs-comment\">// and loop</span>\n \n    <span class=\"hljs-keyword\">mov</span> x0,x24\n    <span class=\"hljs-keyword\">bl</span> displayNode                      <span class=\"hljs-comment\">// display last node</span>\n \n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-symbol\">erreurCommande:</span>\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMessErrComm\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#1</span>                          <span class=\"hljs-comment\">// error code</span>\n    <span class=\"hljs-keyword\">b</span> <span class=\"hljs-number\">100</span>f\n<span class=\"hljs-number\">100</span>:                                   <span class=\"hljs-comment\">// program end standard </span>\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMessFinPgm\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">0</span>                          <span class=\"hljs-comment\">// return code Ok</span>\n    <span class=\"hljs-keyword\">mov</span> x8,EXIT                       <span class=\"hljs-comment\">// system call &quot;Exit&quot;</span>\n    <span class=\"hljs-keyword\">svc</span> <span class=\"hljs-number\">#0</span>\n \n<span class=\"hljs-symbol\">qAdrszMessDebutPgm:</span>      .quad szMessDebutPgm\n<span class=\"hljs-symbol\">qAdrszMessFinPgm:</span>        .quad szMessFinPgm\n<span class=\"hljs-symbol\">qAdrszRetourLigne:</span>       .quad szRetourLigne\n<span class=\"hljs-symbol\">qAdrqDebutListe1:</span>        .quad qDebutListe1\n<span class=\"hljs-symbol\">qAdrszMessErrComm:</span>       .quad szMessErrComm\n \n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/*     create node                                             */</span> \n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/* x0 contains key   */</span>\n<span class=\"hljs-comment\">/* x1 contains zero or address next node */</span>\n<span class=\"hljs-comment\">/* x0 returns address heap node  */</span>\n<span class=\"hljs-symbol\">createNode:</span>\n    stp x20,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!        <span class=\"hljs-comment\">// save  registres</span>\n    stp x21,x22,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!       <span class=\"hljs-comment\">// save  registres</span>\n    <span class=\"hljs-keyword\">mov</span> x20,x0                  <span class=\"hljs-comment\">// save key</span>\n    <span class=\"hljs-keyword\">mov</span> x21,x1                  <span class=\"hljs-comment\">// save key</span>\n    <span class=\"hljs-keyword\">mov</span> x0,<span class=\"hljs-number\">#0</span>                   <span class=\"hljs-comment\">// allocation place heap</span>\n    <span class=\"hljs-keyword\">mov</span> x8,BRK                  <span class=\"hljs-comment\">// call system &#x27;brk&#x27;</span>\n    <span class=\"hljs-keyword\">svc</span> <span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">mov</span> x22,x0                  <span class=\"hljs-comment\">// save address heap for node</span>\n    <span class=\"hljs-keyword\">add</span> x0,x0,llist_fin         <span class=\"hljs-comment\">// reservation place node length</span>\n    <span class=\"hljs-keyword\">mov</span> x8,BRK                  <span class=\"hljs-comment\">// call system &#x27;brk&#x27;</span>\n    <span class=\"hljs-keyword\">svc</span> <span class=\"hljs-number\">#0</span>\n    <span class=\"hljs-keyword\">cmp</span> x0,#-<span class=\"hljs-number\">1</span>                  <span class=\"hljs-comment\">// allocation error</span>\n    <span class=\"hljs-keyword\">beq</span> <span class=\"hljs-number\">100</span>f\n \n    <span class=\"hljs-keyword\">str</span> x20,[x22,llist_value]\n    <span class=\"hljs-keyword\">str</span> x21,[x22,llist_next]\n    <span class=\"hljs-keyword\">mov</span> x0,x22\n<span class=\"hljs-number\">100</span>:\n    ldp x21,x22,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>         <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x20,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>          <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ret                         <span class=\"hljs-comment\">// retour adresse lr x30</span>\n \n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/*     display infos node                                     */</span> \n<span class=\"hljs-comment\">/******************************************************************/</span>\n<span class=\"hljs-comment\">/* x0 contains node address */</span>\n<span class=\"hljs-symbol\">displayNode:</span>\n    stp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!        <span class=\"hljs-comment\">// save  registres</span>\n    stp x2,x3,[<span class=\"hljs-built_in\">sp</span>,-<span class=\"hljs-number\">16</span>]!        <span class=\"hljs-comment\">// save  registres</span>\n    <span class=\"hljs-keyword\">mov</span> x2,x0\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrsZoneConv\n    <span class=\"hljs-keyword\">bl</span> conversion16\n    <span class=\"hljs-keyword\">ldr</span> x0,qAdrszMessImpElement\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrsZoneConv\n    <span class=\"hljs-keyword\">bl</span> strInsertAtCharInc\n    <span class=\"hljs-keyword\">mov</span> x3,x0\n    <span class=\"hljs-keyword\">ldr</span> x0,[x2,llist_value]\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrsZoneConv\n    <span class=\"hljs-keyword\">bl</span> conversion10S\n    <span class=\"hljs-keyword\">mov</span> x0,x3\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrsZoneConv\n    <span class=\"hljs-keyword\">bl</span> strInsertAtCharInc\n    <span class=\"hljs-keyword\">mov</span> x3,x0\n    <span class=\"hljs-keyword\">ldr</span> x0,[x2,llist_next]\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrsZoneConv\n    <span class=\"hljs-keyword\">bl</span> conversion16\n    <span class=\"hljs-keyword\">mov</span> x0,x3\n    <span class=\"hljs-keyword\">ldr</span> x1,qAdrsZoneConv\n    <span class=\"hljs-keyword\">bl</span> strInsertAtCharInc\n    <span class=\"hljs-keyword\">bl</span> affichageMess\n \n<span class=\"hljs-number\">100</span>:\n    ldp x2,x3,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>          <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ldp x1,<span class=\"hljs-built_in\">lr</span>,[<span class=\"hljs-built_in\">sp</span>],<span class=\"hljs-number\">16</span>          <span class=\"hljs-comment\">// restaur des  2 registres</span>\n    ret                        <span class=\"hljs-comment\">// retour adresse lr x30</span>\n<span class=\"hljs-symbol\">qAdrsZoneConv:</span>               .quad sZoneConv\n<span class=\"hljs-symbol\">qAdrszMessImpElement:</span>        .quad szMessImpElement\n<span class=\"hljs-comment\">/********************************************************/</span>\n<span class=\"hljs-comment\">/*        File Include fonctions                        */</span>\n<span class=\"hljs-comment\">/********************************************************/</span>\n<span class=\"hljs-comment\">/* for this file see task include a file in language AArch64 assembly */</span>\n<span class=\"hljs-symbol\">.include</span> <span class=\"hljs-string\">&quot;../includeARM64.inc&quot;</span>\n"
    }
  },
  "contributors": [],
  "explanationUrl": {}
}
