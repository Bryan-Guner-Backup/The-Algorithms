{
  "slug": "graham-scan",
  "name": "Graham Scan",
  "categories": ["others"],
  "body": {},
  "implementations": {
    "python": {
      "dir": "other/graham_scan.py",
      "url": "https://github.com/TheAlgorithms/python/tree/master/other/graham_scan.py",
      "code": "<span class=\"hljs-string\">&quot;&quot;&quot;\nThis is a pure Python implementation of the merge-insertion sort algorithm\nSource: https://en.wikipedia.org/wiki/Graham_scan\n\nFor doctests run following command:\npython3 -m doctest -v graham_scan.py\n&quot;&quot;&quot;</span>\n\n<span class=\"hljs-keyword\">from</span> __future__ <span class=\"hljs-keyword\">import</span> annotations\n\n<span class=\"hljs-keyword\">from</span> collections <span class=\"hljs-keyword\">import</span> deque\n<span class=\"hljs-keyword\">from</span> enum <span class=\"hljs-keyword\">import</span> Enum\n<span class=\"hljs-keyword\">from</span> math <span class=\"hljs-keyword\">import</span> atan2, degrees\n<span class=\"hljs-keyword\">from</span> sys <span class=\"hljs-keyword\">import</span> maxsize\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">graham_scan</span>(<span class=\"hljs-params\">points: <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">int</span>, <span class=\"hljs-built_in\">int</span>]]</span>) -&gt; <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">int</span>, <span class=\"hljs-built_in\">int</span>]]:\n    <span class=\"hljs-string\">&quot;&quot;&quot;Pure implementation of graham scan algorithm in Python\n\n    :param points: The unique points on coordinates.\n    :return: The points on convex hell.\n\n    Examples:\n    &gt;&gt;&gt; graham_scan([(9, 6), (3, 1), (0, 0), (5, 5), (5, 2), (7, 0), (3, 3), (1, 4)])\n    [(0, 0), (7, 0), (9, 6), (5, 5), (1, 4)]\n\n    &gt;&gt;&gt; graham_scan([(0, 0), (1, 0), (1, 1), (0, 1)])\n    [(0, 0), (1, 0), (1, 1), (0, 1)]\n\n    &gt;&gt;&gt; graham_scan([(0, 0), (1, 1), (2, 2), (3, 3), (-1, 2)])\n    [(0, 0), (1, 1), (2, 2), (3, 3), (-1, 2)]\n\n    &gt;&gt;&gt; graham_scan([(-100, 20), (99, 3), (1, 10000001), (5133186, -25), (-66, -4)])\n    [(5133186, -25), (1, 10000001), (-100, 20), (-66, -4)]\n    &quot;&quot;&quot;</span>\n\n    <span class=\"hljs-keyword\">if</span> <span class=\"hljs-built_in\">len</span>(points) &lt;= <span class=\"hljs-number\">2</span>:\n        <span class=\"hljs-comment\"># There is no convex hull</span>\n        <span class=\"hljs-keyword\">raise</span> ValueError(<span class=\"hljs-string\">&quot;graham_scan: argument must contain more than 3 points.&quot;</span>)\n    <span class=\"hljs-keyword\">if</span> <span class=\"hljs-built_in\">len</span>(points) == <span class=\"hljs-number\">3</span>:\n        <span class=\"hljs-keyword\">return</span> points\n    <span class=\"hljs-comment\"># find the lowest and the most left point</span>\n    minidx = <span class=\"hljs-number\">0</span>\n    miny, minx = maxsize, maxsize\n    <span class=\"hljs-keyword\">for</span> i, point <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">enumerate</span>(points):\n        x = point[<span class=\"hljs-number\">0</span>]\n        y = point[<span class=\"hljs-number\">1</span>]\n        <span class=\"hljs-keyword\">if</span> y &lt; miny:\n            miny = y\n            minx = x\n            minidx = i\n        <span class=\"hljs-keyword\">if</span> y == miny:\n            <span class=\"hljs-keyword\">if</span> x &lt; minx:\n                minx = x\n                minidx = i\n\n    <span class=\"hljs-comment\"># remove the lowest and the most left point from points for preparing for sort</span>\n    points.pop(minidx)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">angle_comparer</span>(<span class=\"hljs-params\">point: <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">int</span>, <span class=\"hljs-built_in\">int</span>], minx: <span class=\"hljs-built_in\">int</span>, miny: <span class=\"hljs-built_in\">int</span></span>) -&gt; <span class=\"hljs-built_in\">float</span>:\n        <span class=\"hljs-string\">&quot;&quot;&quot;Return the angle toward to point from (minx, miny)\n\n        :param point: The target point\n               minx: The starting point&#x27;s x\n               miny: The starting point&#x27;s y\n        :return: the angle\n\n        Examples:\n        &gt;&gt;&gt; angle_comparer([1,1], 0, 0)\n        45.0\n\n        &gt;&gt;&gt; angle_comparer([100,1], 10, 10)\n        -5.710593137499642\n\n        &gt;&gt;&gt; angle_comparer([5,5], 2, 3)\n        33.690067525979785\n        &quot;&quot;&quot;</span>\n        <span class=\"hljs-comment\"># sort the points accorgind to the angle from the lowest and the most left point</span>\n        x = point[<span class=\"hljs-number\">0</span>]\n        y = point[<span class=\"hljs-number\">1</span>]\n        angle = degrees(atan2(y - miny, x - minx))\n        <span class=\"hljs-keyword\">return</span> angle\n\n    sorted_points = <span class=\"hljs-built_in\">sorted</span>(points, key=<span class=\"hljs-keyword\">lambda</span> point: angle_comparer(point, minx, miny))\n    <span class=\"hljs-comment\"># This insert actually costs complexity,</span>\n    <span class=\"hljs-comment\"># and you should insteadly add (minx, miny) into stack later.</span>\n    <span class=\"hljs-comment\"># I&#x27;m using insert just for easy understanding.</span>\n    sorted_points.insert(<span class=\"hljs-number\">0</span>, (minx, miny))\n\n    <span class=\"hljs-comment\"># traversal from the lowest and the most left point in anti-clockwise direction</span>\n    <span class=\"hljs-comment\"># if direction gets right, the previous point is not the convex hull.</span>\n    <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Direction</span>(<span class=\"hljs-title class_ inherited__\">Enum</span>):\n        left = <span class=\"hljs-number\">1</span>\n        straight = <span class=\"hljs-number\">2</span>\n        right = <span class=\"hljs-number\">3</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">check_direction</span>(<span class=\"hljs-params\">\n        starting: <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">int</span>, <span class=\"hljs-built_in\">int</span>], via: <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">int</span>, <span class=\"hljs-built_in\">int</span>], target: <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">int</span>, <span class=\"hljs-built_in\">int</span>]\n    </span>) -&gt; Direction:\n        <span class=\"hljs-string\">&quot;&quot;&quot;Return the direction toward to the line from via to target from starting\n\n        :param starting: The starting point\n               via: The via point\n               target: The target point\n        :return: the Direction\n\n        Examples:\n        &gt;&gt;&gt; check_direction([1,1], [2,2], [3,3])\n        Direction.straight\n\n        &gt;&gt;&gt; check_direction([60,1], [-50,199], [30,2])\n        Direction.left\n\n        &gt;&gt;&gt; check_direction([0,0], [5,5], [10,0])\n        Direction.right\n        &quot;&quot;&quot;</span>\n        x0, y0 = starting\n        x1, y1 = via\n        x2, y2 = target\n        via_angle = degrees(atan2(y1 - y0, x1 - x0))\n        <span class=\"hljs-keyword\">if</span> via_angle &lt; <span class=\"hljs-number\">0</span>:\n            via_angle += <span class=\"hljs-number\">360</span>\n        target_angle = degrees(atan2(y2 - y0, x2 - x0))\n        <span class=\"hljs-keyword\">if</span> target_angle &lt; <span class=\"hljs-number\">0</span>:\n            target_angle += <span class=\"hljs-number\">360</span>\n        <span class=\"hljs-comment\"># t-</span>\n        <span class=\"hljs-comment\">#  \\ \\</span>\n        <span class=\"hljs-comment\">#   \\ v</span>\n        <span class=\"hljs-comment\">#    \\|</span>\n        <span class=\"hljs-comment\">#     s</span>\n        <span class=\"hljs-comment\"># via_angle is always lower than target_angle, if direction is left.</span>\n        <span class=\"hljs-comment\"># If they are same, it means they are on a same line of convex hull.</span>\n        <span class=\"hljs-keyword\">if</span> target_angle &gt; via_angle:\n            <span class=\"hljs-keyword\">return</span> Direction.left\n        <span class=\"hljs-keyword\">if</span> target_angle == via_angle:\n            <span class=\"hljs-keyword\">return</span> Direction.straight\n        <span class=\"hljs-keyword\">if</span> target_angle &lt; via_angle:\n            <span class=\"hljs-keyword\">return</span> Direction.right\n\n    stack = deque()\n    stack.append(sorted_points[<span class=\"hljs-number\">0</span>])\n    stack.append(sorted_points[<span class=\"hljs-number\">1</span>])\n    stack.append(sorted_points[<span class=\"hljs-number\">2</span>])\n    <span class=\"hljs-comment\"># In any ways, the first 3 points line are towards left.</span>\n    <span class=\"hljs-comment\"># Because we sort them the angle from minx, miny.</span>\n    current_direction = Direction.left\n\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">3</span>, <span class=\"hljs-built_in\">len</span>(sorted_points)):\n        <span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n            starting = stack[-<span class=\"hljs-number\">2</span>]\n            via = stack[-<span class=\"hljs-number\">1</span>]\n            target = sorted_points[i]\n            next_direction = check_direction(starting, via, target)\n\n            <span class=\"hljs-keyword\">if</span> next_direction == Direction.left:\n                current_direction = Direction.left\n                <span class=\"hljs-keyword\">break</span>\n            <span class=\"hljs-keyword\">if</span> next_direction == Direction.straight:\n                <span class=\"hljs-keyword\">if</span> current_direction == Direction.left:\n                    <span class=\"hljs-comment\"># We keep current_direction as left.</span>\n                    <span class=\"hljs-comment\"># Because if the straight line keeps as straight,</span>\n                    <span class=\"hljs-comment\"># we want to know if this straight line is towards left.</span>\n                    <span class=\"hljs-keyword\">break</span>\n                <span class=\"hljs-keyword\">elif</span> current_direction == Direction.right:\n                    <span class=\"hljs-comment\"># If the straight line is towards right,</span>\n                    <span class=\"hljs-comment\"># every previous points on those straigh line is not convex hull.</span>\n                    stack.pop()\n            <span class=\"hljs-keyword\">if</span> next_direction == Direction.right:\n                stack.pop()\n        stack.append(sorted_points[i])\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">list</span>(stack)\n"
    }
  },
  "contributors": [
    {
      "name": "ulwlu",
      "email": "ooulwluoo@gmail.com",
      "commits": 1
    }
  ],
  "explanationUrl": {}
}
