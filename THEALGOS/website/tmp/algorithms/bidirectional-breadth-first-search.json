{
  "slug": "bidirectional-breadth-first-search",
  "name": "Bidirectional Breadth First Search",
  "categories": ["graphs"],
  "body": {},
  "implementations": {
    "python": {
      "dir": "graphs/bidirectional_breadth_first_search.py",
      "url": "https://github.com/TheAlgorithms/python/tree/master/graphs/bidirectional_breadth_first_search.py",
      "code": "<span class=\"hljs-string\">&quot;&quot;&quot;\nhttps://en.wikipedia.org/wiki/Bidirectional_search\n&quot;&quot;&quot;</span>\n\n<span class=\"hljs-keyword\">from</span> __future__ <span class=\"hljs-keyword\">import</span> annotations\n\n<span class=\"hljs-keyword\">import</span> time\n<span class=\"hljs-keyword\">from</span> typing <span class=\"hljs-keyword\">import</span> <span class=\"hljs-type\">Optional</span>\n\nPath = <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">tuple</span>[<span class=\"hljs-built_in\">int</span>, <span class=\"hljs-built_in\">int</span>]]\n\ngrid = [\n    [<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>],\n    [<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>],  <span class=\"hljs-comment\"># 0 are free path whereas 1&#x27;s are obstacles</span>\n    [<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>],\n    [<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>],\n    [<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>],\n    [<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>],\n    [<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>],\n]\n\ndelta = [[-<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">0</span>], [<span class=\"hljs-number\">0</span>, -<span class=\"hljs-number\">1</span>], [<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">0</span>], [<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">1</span>]]  <span class=\"hljs-comment\"># up, left, down, right</span>\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Node</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">\n        self, pos_x: <span class=\"hljs-built_in\">int</span>, pos_y: <span class=\"hljs-built_in\">int</span>, goal_x: <span class=\"hljs-built_in\">int</span>, goal_y: <span class=\"hljs-built_in\">int</span>, parent: <span class=\"hljs-type\">Optional</span>[Node]\n    </span>):\n        self.pos_x = pos_x\n        self.pos_y = pos_y\n        self.pos = (pos_y, pos_x)\n        self.goal_x = goal_x\n        self.goal_y = goal_y\n        self.parent = parent\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">BreadthFirstSearch</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    &gt;&gt;&gt; bfs = BreadthFirstSearch((0, 0), (len(grid) - 1, len(grid[0]) - 1))\n    &gt;&gt;&gt; (bfs.start.pos_y + delta[3][0], bfs.start.pos_x + delta[3][1])\n    (0, 1)\n    &gt;&gt;&gt; [x.pos for x in bfs.get_successors(bfs.start)]\n    [(1, 0), (0, 1)]\n    &gt;&gt;&gt; (bfs.start.pos_y + delta[2][0], bfs.start.pos_x + delta[2][1])\n    (1, 0)\n    &gt;&gt;&gt; bfs.retrace_path(bfs.start)\n    [(0, 0)]\n    &gt;&gt;&gt; bfs.search()  # doctest: +NORMALIZE_WHITESPACE\n    [(0, 0), (1, 0), (2, 0), (3, 0), (3, 1), (4, 1),\n     (5, 1), (5, 2), (5, 3), (5, 4), (5, 5), (6, 5), (6, 6)]\n    &quot;&quot;&quot;</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, start: <span class=\"hljs-built_in\">tuple</span>[<span class=\"hljs-built_in\">int</span>, <span class=\"hljs-built_in\">int</span>], goal: <span class=\"hljs-built_in\">tuple</span>[<span class=\"hljs-built_in\">int</span>, <span class=\"hljs-built_in\">int</span>]</span>):\n        self.start = Node(start[<span class=\"hljs-number\">1</span>], start[<span class=\"hljs-number\">0</span>], goal[<span class=\"hljs-number\">1</span>], goal[<span class=\"hljs-number\">0</span>], <span class=\"hljs-literal\">None</span>)\n        self.target = Node(goal[<span class=\"hljs-number\">1</span>], goal[<span class=\"hljs-number\">0</span>], goal[<span class=\"hljs-number\">1</span>], goal[<span class=\"hljs-number\">0</span>], <span class=\"hljs-literal\">None</span>)\n\n        self.node_queue = [self.start]\n        self.reached = <span class=\"hljs-literal\">False</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">search</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-type\">Optional</span>[Path]:\n        <span class=\"hljs-keyword\">while</span> self.node_queue:\n            current_node = self.node_queue.pop(<span class=\"hljs-number\">0</span>)\n\n            <span class=\"hljs-keyword\">if</span> current_node.pos == self.target.pos:\n                self.reached = <span class=\"hljs-literal\">True</span>\n                <span class=\"hljs-keyword\">return</span> self.retrace_path(current_node)\n\n            successors = self.get_successors(current_node)\n\n            <span class=\"hljs-keyword\">for</span> node <span class=\"hljs-keyword\">in</span> successors:\n                self.node_queue.append(node)\n\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> self.reached:\n            <span class=\"hljs-keyword\">return</span> [self.start.pos]\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_successors</span>(<span class=\"hljs-params\">self, parent: Node</span>) -&gt; <span class=\"hljs-built_in\">list</span>[Node]:\n        <span class=\"hljs-string\">&quot;&quot;&quot;\n        Returns a list of successors (both in the grid and free spaces)\n        &quot;&quot;&quot;</span>\n        successors = []\n        <span class=\"hljs-keyword\">for</span> action <span class=\"hljs-keyword\">in</span> delta:\n            pos_x = parent.pos_x + action[<span class=\"hljs-number\">1</span>]\n            pos_y = parent.pos_y + action[<span class=\"hljs-number\">0</span>]\n            <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> (<span class=\"hljs-number\">0</span> &lt;= pos_x &lt;= <span class=\"hljs-built_in\">len</span>(grid[<span class=\"hljs-number\">0</span>]) - <span class=\"hljs-number\">1</span> <span class=\"hljs-keyword\">and</span> <span class=\"hljs-number\">0</span> &lt;= pos_y &lt;= <span class=\"hljs-built_in\">len</span>(grid) - <span class=\"hljs-number\">1</span>):\n                <span class=\"hljs-keyword\">continue</span>\n\n            <span class=\"hljs-keyword\">if</span> grid[pos_y][pos_x] != <span class=\"hljs-number\">0</span>:\n                <span class=\"hljs-keyword\">continue</span>\n\n            successors.append(\n                Node(pos_x, pos_y, self.target.pos_y, self.target.pos_x, parent)\n            )\n        <span class=\"hljs-keyword\">return</span> successors\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">retrace_path</span>(<span class=\"hljs-params\">self, node: <span class=\"hljs-type\">Optional</span>[Node]</span>) -&gt; Path:\n        <span class=\"hljs-string\">&quot;&quot;&quot;\n        Retrace the path from parents to parents until start node\n        &quot;&quot;&quot;</span>\n        current_node = node\n        path = []\n        <span class=\"hljs-keyword\">while</span> current_node <span class=\"hljs-keyword\">is</span> <span class=\"hljs-keyword\">not</span> <span class=\"hljs-literal\">None</span>:\n            path.append((current_node.pos_y, current_node.pos_x))\n            current_node = current_node.parent\n        path.reverse()\n        <span class=\"hljs-keyword\">return</span> path\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">BidirectionalBreadthFirstSearch</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    &gt;&gt;&gt; bd_bfs = BidirectionalBreadthFirstSearch((0, 0), (len(grid) - 1,\n    ...                                                   len(grid[0]) - 1))\n    &gt;&gt;&gt; bd_bfs.fwd_bfs.start.pos == bd_bfs.bwd_bfs.target.pos\n    True\n    &gt;&gt;&gt; bd_bfs.retrace_bidirectional_path(bd_bfs.fwd_bfs.start,\n    ...                                     bd_bfs.bwd_bfs.start)\n    [(0, 0)]\n    &gt;&gt;&gt; bd_bfs.search()  # doctest: +NORMALIZE_WHITESPACE\n    [(0, 0), (0, 1), (0, 2), (1, 2), (2, 2), (2, 3),\n     (2, 4), (3, 4), (3, 5), (3, 6), (4, 6), (5, 6), (6, 6)]\n    &quot;&quot;&quot;</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, start, goal</span>):\n        self.fwd_bfs = BreadthFirstSearch(start, goal)\n        self.bwd_bfs = BreadthFirstSearch(goal, start)\n        self.reached = <span class=\"hljs-literal\">False</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">search</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-type\">Optional</span>[Path]:\n        <span class=\"hljs-keyword\">while</span> self.fwd_bfs.node_queue <span class=\"hljs-keyword\">or</span> self.bwd_bfs.node_queue:\n            current_fwd_node = self.fwd_bfs.node_queue.pop(<span class=\"hljs-number\">0</span>)\n            current_bwd_node = self.bwd_bfs.node_queue.pop(<span class=\"hljs-number\">0</span>)\n\n            <span class=\"hljs-keyword\">if</span> current_bwd_node.pos == current_fwd_node.pos:\n                self.reached = <span class=\"hljs-literal\">True</span>\n                <span class=\"hljs-keyword\">return</span> self.retrace_bidirectional_path(\n                    current_fwd_node, current_bwd_node\n                )\n\n            self.fwd_bfs.target = current_bwd_node\n            self.bwd_bfs.target = current_fwd_node\n\n            successors = {\n                self.fwd_bfs: self.fwd_bfs.get_successors(current_fwd_node),\n                self.bwd_bfs: self.bwd_bfs.get_successors(current_bwd_node),\n            }\n\n            <span class=\"hljs-keyword\">for</span> bfs <span class=\"hljs-keyword\">in</span> [self.fwd_bfs, self.bwd_bfs]:\n                <span class=\"hljs-keyword\">for</span> node <span class=\"hljs-keyword\">in</span> successors[bfs]:\n                    bfs.node_queue.append(node)\n\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> self.reached:\n            <span class=\"hljs-keyword\">return</span> [self.fwd_bfs.start.pos]\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">retrace_bidirectional_path</span>(<span class=\"hljs-params\">self, fwd_node: Node, bwd_node: Node</span>) -&gt; Path:\n        fwd_path = self.fwd_bfs.retrace_path(fwd_node)\n        bwd_path = self.bwd_bfs.retrace_path(bwd_node)\n        bwd_path.pop()\n        bwd_path.reverse()\n        path = fwd_path + bwd_path\n        <span class=\"hljs-keyword\">return</span> path\n\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\n    <span class=\"hljs-comment\"># all coordinates are given in format [y,x]</span>\n    <span class=\"hljs-keyword\">import</span> doctest\n\n    doctest.testmod()\n    init = (<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>)\n    goal = (<span class=\"hljs-built_in\">len</span>(grid) - <span class=\"hljs-number\">1</span>, <span class=\"hljs-built_in\">len</span>(grid[<span class=\"hljs-number\">0</span>]) - <span class=\"hljs-number\">1</span>)\n    <span class=\"hljs-keyword\">for</span> elem <span class=\"hljs-keyword\">in</span> grid:\n        <span class=\"hljs-built_in\">print</span>(elem)\n\n    start_bfs_time = time.time()\n    bfs = BreadthFirstSearch(init, goal)\n    path = bfs.search()\n    bfs_time = time.time() - start_bfs_time\n\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;Unidirectional BFS computation time : &quot;</span>, bfs_time)\n\n    start_bd_bfs_time = time.time()\n    bd_bfs = BidirectionalBreadthFirstSearch(init, goal)\n    bd_path = bd_bfs.search()\n    bd_bfs_time = time.time() - start_bd_bfs_time\n\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;Bidirectional BFS computation time : &quot;</span>, bd_bfs_time)\n"
    }
  },
  "contributors": [
    {
      "name": "hasan",
      "email": "hasanuli10@gmail.com",
      "commits": 1
    },
    {
      "name": "beqakd",
      "email": "39763019+beqakd@users.noreply.github.com",
      "commits": 1
    },
    {
      "name": "Erwin Lejeune",
      "email": "erwin.lejeune15@gmail.com",
      "commits": 1
    },
    {
      "name": "Christian Clauss",
      "email": "cclauss@me.com",
      "commits": 2
    }
  ],
  "explanationUrl": {}
}
