{
  "slug": "gradient-boosting-algorithms",
  "name": "Gradient Boosting Algorithms",
  "categories": ["classificationalgorithms"],
  "body": {},
  "implementations": {
    "r": {
      "dir": "Regression-Algorithms/gradient_boosting_algorithms.R",
      "url": "https://github.com/TheAlgorithms/r/tree/master/Regression-Algorithms/gradient_boosting_algorithms.R",
      "code": "<span class=\"hljs-comment\"># GBM</span>\nlibrary<span class=\"hljs-punctuation\">(</span>caret<span class=\"hljs-punctuation\">)</span>\nx <span class=\"hljs-operator\">&lt;-</span> cbind<span class=\"hljs-punctuation\">(</span>x_train<span class=\"hljs-punctuation\">,</span>y_train<span class=\"hljs-punctuation\">)</span>\n<span class=\"hljs-comment\"># Fitting model</span>\nfitControl <span class=\"hljs-operator\">&lt;-</span> trainControl<span class=\"hljs-punctuation\">(</span> method <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;repeatedcv&quot;</span><span class=\"hljs-punctuation\">,</span> number <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">4</span><span class=\"hljs-punctuation\">,</span> repeats <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">4</span><span class=\"hljs-punctuation\">)</span>\nfit <span class=\"hljs-operator\">&lt;-</span> train<span class=\"hljs-punctuation\">(</span>y <span class=\"hljs-operator\">~</span> .<span class=\"hljs-punctuation\">,</span> data <span class=\"hljs-operator\">=</span> x<span class=\"hljs-punctuation\">,</span> method <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;gbm&quot;</span><span class=\"hljs-punctuation\">,</span> trControl <span class=\"hljs-operator\">=</span> fitControl<span class=\"hljs-punctuation\">,</span>verbose <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">FALSE</span><span class=\"hljs-punctuation\">)</span>\npredicted<span class=\"hljs-operator\">=</span> predict<span class=\"hljs-punctuation\">(</span>fit<span class=\"hljs-punctuation\">,</span>x_test<span class=\"hljs-punctuation\">,</span>type<span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;prob&quot;</span><span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">,</span><span class=\"hljs-number\">2</span><span class=\"hljs-punctuation\">]</span> \n\n\n\n<span class=\"hljs-comment\"># XGBoost</span>\nrequire<span class=\"hljs-punctuation\">(</span>caret<span class=\"hljs-punctuation\">)</span>\nx <span class=\"hljs-operator\">&lt;-</span> cbind<span class=\"hljs-punctuation\">(</span>x_train<span class=\"hljs-punctuation\">,</span>y_train<span class=\"hljs-punctuation\">)</span>\n<span class=\"hljs-comment\"># Fitting model</span>\nTrainControl <span class=\"hljs-operator\">&lt;-</span> trainControl<span class=\"hljs-punctuation\">(</span> method <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;repeatedcv&quot;</span><span class=\"hljs-punctuation\">,</span> number <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">10</span><span class=\"hljs-punctuation\">,</span> repeats <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">4</span><span class=\"hljs-punctuation\">)</span>\nmodel<span class=\"hljs-operator\">&lt;-</span> train<span class=\"hljs-punctuation\">(</span>y <span class=\"hljs-operator\">~</span> .<span class=\"hljs-punctuation\">,</span> data <span class=\"hljs-operator\">=</span> x<span class=\"hljs-punctuation\">,</span> method <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;xgbLinear&quot;</span><span class=\"hljs-punctuation\">,</span> trControl <span class=\"hljs-operator\">=</span> TrainControl<span class=\"hljs-punctuation\">,</span>verbose <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">FALSE</span><span class=\"hljs-punctuation\">)</span>\n<span class=\"hljs-comment\"># OR </span>\nmodel<span class=\"hljs-operator\">&lt;-</span> train<span class=\"hljs-punctuation\">(</span>y <span class=\"hljs-operator\">~</span> .<span class=\"hljs-punctuation\">,</span> data <span class=\"hljs-operator\">=</span> x<span class=\"hljs-punctuation\">,</span> method <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;xgbTree&quot;</span><span class=\"hljs-punctuation\">,</span> trControl <span class=\"hljs-operator\">=</span> TrainControl<span class=\"hljs-punctuation\">,</span>verbose <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">FALSE</span><span class=\"hljs-punctuation\">)</span>\npredicted <span class=\"hljs-operator\">&lt;-</span> predict<span class=\"hljs-punctuation\">(</span>model<span class=\"hljs-punctuation\">,</span> x_test<span class=\"hljs-punctuation\">)</span>\n\n\n\n<span class=\"hljs-comment\"># LightGBM</span>\nlibrary<span class=\"hljs-punctuation\">(</span>RLightGBM<span class=\"hljs-punctuation\">)</span>\ndata<span class=\"hljs-punctuation\">(</span>example.binary<span class=\"hljs-punctuation\">)</span>\n<span class=\"hljs-comment\"># Parameters</span>\nnum_iterations <span class=\"hljs-operator\">&lt;-</span> 100\nconfig <span class=\"hljs-operator\">&lt;-</span> <span class=\"hljs-built_in\">list</span><span class=\"hljs-punctuation\">(</span>objective <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;binary&quot;</span><span class=\"hljs-punctuation\">,</span>  metric<span class=\"hljs-operator\">=</span><span class=\"hljs-string\">&quot;binary_logloss,auc&quot;</span><span class=\"hljs-punctuation\">,</span> learning_rate <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0.1</span><span class=\"hljs-punctuation\">,</span> num_leaves <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">63</span><span class=\"hljs-punctuation\">,</span> tree_learner <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;serial&quot;</span><span class=\"hljs-punctuation\">,</span> feature_fraction <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0.8</span><span class=\"hljs-punctuation\">,</span> bagging_freq <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">5</span><span class=\"hljs-punctuation\">,</span> bagging_fraction <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0.8</span><span class=\"hljs-punctuation\">,</span> min_data_in_leaf <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">50</span><span class=\"hljs-punctuation\">,</span> min_sum_hessian_in_leaf <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">5.0</span><span class=\"hljs-punctuation\">)</span>\n<span class=\"hljs-comment\"># Create data handle and booster</span>\nhandle.data <span class=\"hljs-operator\">&lt;-</span> lgbm.data.create<span class=\"hljs-punctuation\">(</span>x<span class=\"hljs-punctuation\">)</span>\nlgbm.data.setField<span class=\"hljs-punctuation\">(</span>handle.data<span class=\"hljs-punctuation\">,</span> <span class=\"hljs-string\">&quot;label&quot;</span><span class=\"hljs-punctuation\">,</span> y<span class=\"hljs-punctuation\">)</span>\nhandle.booster <span class=\"hljs-operator\">&lt;-</span> lgbm.booster.create<span class=\"hljs-punctuation\">(</span>handle.data<span class=\"hljs-punctuation\">,</span> lapply<span class=\"hljs-punctuation\">(</span>config<span class=\"hljs-punctuation\">,</span> <span class=\"hljs-built_in\">as.character</span><span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">)</span>\n<span class=\"hljs-comment\"># Train for num_iterations iterations and eval every 5 steps</span>\nlgbm.booster.train<span class=\"hljs-punctuation\">(</span>handle.booster<span class=\"hljs-punctuation\">,</span> num_iterations<span class=\"hljs-punctuation\">,</span> <span class=\"hljs-number\">5</span><span class=\"hljs-punctuation\">)</span>\n<span class=\"hljs-comment\"># Predict</span>\npred <span class=\"hljs-operator\">&lt;-</span> lgbm.booster.predict<span class=\"hljs-punctuation\">(</span>handle.booster<span class=\"hljs-punctuation\">,</span> x.test<span class=\"hljs-punctuation\">)</span>\n<span class=\"hljs-comment\"># Test accuracy</span>\n<span class=\"hljs-built_in\">sum</span><span class=\"hljs-punctuation\">(</span>y.test <span class=\"hljs-operator\">==</span> <span class=\"hljs-punctuation\">(</span>y.pred <span class=\"hljs-operator\">&gt;</span> <span class=\"hljs-number\">0.5</span><span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">)</span> <span class=\"hljs-operator\">/</span> <span class=\"hljs-built_in\">length</span><span class=\"hljs-punctuation\">(</span>y.test<span class=\"hljs-punctuation\">)</span>\n<span class=\"hljs-comment\"># Save model (can be loaded again via lgbm.booster.load(filename))</span>\nlgbm.booster.save<span class=\"hljs-punctuation\">(</span>handle.booster<span class=\"hljs-punctuation\">,</span> filename <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;/tmp/model.txt&quot;</span><span class=\"hljs-punctuation\">)</span>\n\n\n\n<span class=\"hljs-comment\"># Catboost</span>\nset.seed<span class=\"hljs-punctuation\">(</span><span class=\"hljs-number\">1</span><span class=\"hljs-punctuation\">)</span>\n\nrequire<span class=\"hljs-punctuation\">(</span>titanic<span class=\"hljs-punctuation\">)</span>\n\nrequire<span class=\"hljs-punctuation\">(</span>caret<span class=\"hljs-punctuation\">)</span>\n\nrequire<span class=\"hljs-punctuation\">(</span>catboost<span class=\"hljs-punctuation\">)</span>\n\ntt <span class=\"hljs-operator\">&lt;-</span> titanic<span class=\"hljs-operator\">::</span>titanic_train<span class=\"hljs-punctuation\">[</span>complete.cases<span class=\"hljs-punctuation\">(</span>titanic<span class=\"hljs-operator\">::</span>titanic_train<span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">,</span><span class=\"hljs-punctuation\">]</span>\n\ndata <span class=\"hljs-operator\">&lt;-</span> as.data.frame<span class=\"hljs-punctuation\">(</span>as.matrix<span class=\"hljs-punctuation\">(</span>tt<span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">,</span> stringsAsFactors <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">TRUE</span><span class=\"hljs-punctuation\">)</span>\n\ndrop_columns <span class=\"hljs-operator\">=</span> <span class=\"hljs-built_in\">c</span><span class=\"hljs-punctuation\">(</span><span class=\"hljs-string\">&quot;PassengerId&quot;</span><span class=\"hljs-punctuation\">,</span> <span class=\"hljs-string\">&quot;Survived&quot;</span><span class=\"hljs-punctuation\">,</span> <span class=\"hljs-string\">&quot;Name&quot;</span><span class=\"hljs-punctuation\">,</span> <span class=\"hljs-string\">&quot;Ticket&quot;</span><span class=\"hljs-punctuation\">,</span> <span class=\"hljs-string\">&quot;Cabin&quot;</span><span class=\"hljs-punctuation\">)</span>\n\nx <span class=\"hljs-operator\">&lt;-</span> data<span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">,</span><span class=\"hljs-operator\">!</span><span class=\"hljs-punctuation\">(</span><span class=\"hljs-built_in\">names</span><span class=\"hljs-punctuation\">(</span>data<span class=\"hljs-punctuation\">)</span> <span class=\"hljs-operator\">%in%</span> drop_columns<span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">]</span>y <span class=\"hljs-operator\">&lt;-</span> data<span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">,</span><span class=\"hljs-built_in\">c</span><span class=\"hljs-punctuation\">(</span><span class=\"hljs-string\">&quot;Survived&quot;</span><span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">]</span>\n\nfit_control <span class=\"hljs-operator\">&lt;-</span> trainControl<span class=\"hljs-punctuation\">(</span>method <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;cv&quot;</span><span class=\"hljs-punctuation\">,</span> number <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">4</span><span class=\"hljs-punctuation\">,</span>classProbs <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">TRUE</span><span class=\"hljs-punctuation\">)</span>\n\ngrid <span class=\"hljs-operator\">&lt;-</span> expand.grid<span class=\"hljs-punctuation\">(</span>depth <span class=\"hljs-operator\">=</span> <span class=\"hljs-built_in\">c</span><span class=\"hljs-punctuation\">(</span><span class=\"hljs-number\">4</span><span class=\"hljs-punctuation\">,</span> <span class=\"hljs-number\">6</span><span class=\"hljs-punctuation\">,</span> <span class=\"hljs-number\">8</span><span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">,</span>learning_rate <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0.1</span><span class=\"hljs-punctuation\">,</span>iterations <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">100</span><span class=\"hljs-punctuation\">,</span> l2_leaf_reg <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">1e-3</span><span class=\"hljs-punctuation\">,</span>            rsm <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0.95</span><span class=\"hljs-punctuation\">,</span> border_count <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">64</span><span class=\"hljs-punctuation\">)</span>\n\nreport <span class=\"hljs-operator\">&lt;-</span> train<span class=\"hljs-punctuation\">(</span>x<span class=\"hljs-punctuation\">,</span> as.factor<span class=\"hljs-punctuation\">(</span>make.names<span class=\"hljs-punctuation\">(</span>y<span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">,</span>method <span class=\"hljs-operator\">=</span> catboost.caret<span class=\"hljs-punctuation\">,</span>verbose <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">TRUE</span><span class=\"hljs-punctuation\">,</span> preProc <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">NULL</span><span class=\"hljs-punctuation\">,</span>tuneGrid <span class=\"hljs-operator\">=</span> grid<span class=\"hljs-punctuation\">,</span> trControl <span class=\"hljs-operator\">=</span> fit_control<span class=\"hljs-punctuation\">)</span>\n\nprint<span class=\"hljs-punctuation\">(</span>report<span class=\"hljs-punctuation\">)</span>\n\nimportance <span class=\"hljs-operator\">&lt;-</span> varImp<span class=\"hljs-punctuation\">(</span>report<span class=\"hljs-punctuation\">,</span> scale <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">FALSE</span><span class=\"hljs-punctuation\">)</span>\n\nprint<span class=\"hljs-punctuation\">(</span>importance<span class=\"hljs-punctuation\">)</span>\n"
    }
  },
  "contributors": [
    {
      "name": "Thomas",
      "email": "thomas.lentali@gmail.com",
      "commits": 1
    }
  ],
  "explanationUrl": {}
}
