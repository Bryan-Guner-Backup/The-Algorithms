{
  "slug": "gradient-descent",
  "name": "Gradient Descent",
  "categories": ["machinelearning"],
  "body": {},
  "implementations": {
    "python": {
      "dir": "machine_learning/gradient_descent.py",
      "url": "https://github.com/TheAlgorithms/python/tree/master/machine_learning/gradient_descent.py",
      "code": "<span class=\"hljs-string\">&quot;&quot;&quot;\nImplementation of gradient descent algorithm for minimizing cost of a linear hypothesis\nfunction.\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">import</span> numpy\n\n<span class=\"hljs-comment\"># List of input, output pairs</span>\ntrain_data = (\n    ((<span class=\"hljs-number\">5</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>), <span class=\"hljs-number\">15</span>),\n    ((<span class=\"hljs-number\">6</span>, <span class=\"hljs-number\">5</span>, <span class=\"hljs-number\">9</span>), <span class=\"hljs-number\">25</span>),\n    ((<span class=\"hljs-number\">11</span>, <span class=\"hljs-number\">12</span>, <span class=\"hljs-number\">13</span>), <span class=\"hljs-number\">41</span>),\n    ((<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">1</span>), <span class=\"hljs-number\">8</span>),\n    ((<span class=\"hljs-number\">11</span>, <span class=\"hljs-number\">12</span>, <span class=\"hljs-number\">13</span>), <span class=\"hljs-number\">41</span>),\n)\ntest_data = (((<span class=\"hljs-number\">515</span>, <span class=\"hljs-number\">22</span>, <span class=\"hljs-number\">13</span>), <span class=\"hljs-number\">555</span>), ((<span class=\"hljs-number\">61</span>, <span class=\"hljs-number\">35</span>, <span class=\"hljs-number\">49</span>), <span class=\"hljs-number\">150</span>))\nparameter_vector = [<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">5</span>]\nm = <span class=\"hljs-built_in\">len</span>(train_data)\nLEARNING_RATE = <span class=\"hljs-number\">0.009</span>\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">_error</span>(<span class=\"hljs-params\">example_no, data_set=<span class=\"hljs-string\">&quot;train&quot;</span></span>):\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    :param data_set: train data or test data\n    :param example_no: example number whose error has to be checked\n    :return: error in example pointed by example number.\n    &quot;&quot;&quot;</span>\n    <span class=\"hljs-keyword\">return</span> calculate_hypothesis_value(example_no, data_set) - output(\n        example_no, data_set\n    )\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">_hypothesis_value</span>(<span class=\"hljs-params\">data_input_tuple</span>):\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    Calculates hypothesis function value for a given input\n    :param data_input_tuple: Input tuple of a particular example\n    :return: Value of hypothesis function at that point.\n    Note that there is an &#x27;biased input&#x27; whose value is fixed as 1.\n    It is not explicitly mentioned in input data.. But, ML hypothesis functions use it.\n    So, we have to take care of it separately. Line 36 takes care of it.\n    &quot;&quot;&quot;</span>\n    hyp_val = <span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-built_in\">len</span>(parameter_vector) - <span class=\"hljs-number\">1</span>):\n        hyp_val += data_input_tuple[i] * parameter_vector[i + <span class=\"hljs-number\">1</span>]\n    hyp_val += parameter_vector[<span class=\"hljs-number\">0</span>]\n    <span class=\"hljs-keyword\">return</span> hyp_val\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">output</span>(<span class=\"hljs-params\">example_no, data_set</span>):\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    :param data_set: test data or train data\n    :param example_no: example whose output is to be fetched\n    :return: output for that example\n    &quot;&quot;&quot;</span>\n    <span class=\"hljs-keyword\">if</span> data_set == <span class=\"hljs-string\">&quot;train&quot;</span>:\n        <span class=\"hljs-keyword\">return</span> train_data[example_no][<span class=\"hljs-number\">1</span>]\n    <span class=\"hljs-keyword\">elif</span> data_set == <span class=\"hljs-string\">&quot;test&quot;</span>:\n        <span class=\"hljs-keyword\">return</span> test_data[example_no][<span class=\"hljs-number\">1</span>]\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">calculate_hypothesis_value</span>(<span class=\"hljs-params\">example_no, data_set</span>):\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    Calculates hypothesis value for a given example\n    :param data_set: test data or train_data\n    :param example_no: example whose hypothesis value is to be calculated\n    :return: hypothesis value for that example\n    &quot;&quot;&quot;</span>\n    <span class=\"hljs-keyword\">if</span> data_set == <span class=\"hljs-string\">&quot;train&quot;</span>:\n        <span class=\"hljs-keyword\">return</span> _hypothesis_value(train_data[example_no][<span class=\"hljs-number\">0</span>])\n    <span class=\"hljs-keyword\">elif</span> data_set == <span class=\"hljs-string\">&quot;test&quot;</span>:\n        <span class=\"hljs-keyword\">return</span> _hypothesis_value(test_data[example_no][<span class=\"hljs-number\">0</span>])\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">summation_of_cost_derivative</span>(<span class=\"hljs-params\">index, end=m</span>):\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    Calculates the sum of cost function derivative\n    :param index: index wrt derivative is being calculated\n    :param end: value where summation ends, default is m, number of examples\n    :return: Returns the summation of cost derivative\n    Note: If index is -1, this means we are calculating summation wrt to biased\n        parameter.\n    &quot;&quot;&quot;</span>\n    summation_value = <span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(end):\n        <span class=\"hljs-keyword\">if</span> index == -<span class=\"hljs-number\">1</span>:\n            summation_value += _error(i)\n        <span class=\"hljs-keyword\">else</span>:\n            summation_value += _error(i) * train_data[i][<span class=\"hljs-number\">0</span>][index]\n    <span class=\"hljs-keyword\">return</span> summation_value\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_cost_derivative</span>(<span class=\"hljs-params\">index</span>):\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    :param index: index of the parameter vector wrt to derivative is to be calculated\n    :return: derivative wrt to that index\n    Note: If index is -1, this means we are calculating summation wrt to biased\n        parameter.\n    &quot;&quot;&quot;</span>\n    cost_derivative_value = summation_of_cost_derivative(index, m) / m\n    <span class=\"hljs-keyword\">return</span> cost_derivative_value\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run_gradient_descent</span>():\n    <span class=\"hljs-keyword\">global</span> parameter_vector\n    <span class=\"hljs-comment\"># Tune these values to set a tolerance value for predicted output</span>\n    absolute_error_limit = <span class=\"hljs-number\">0.000002</span>\n    relative_error_limit = <span class=\"hljs-number\">0</span>\n    j = <span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n        j += <span class=\"hljs-number\">1</span>\n        temp_parameter_vector = [<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>]\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">0</span>, <span class=\"hljs-built_in\">len</span>(parameter_vector)):\n            cost_derivative = get_cost_derivative(i - <span class=\"hljs-number\">1</span>)\n            temp_parameter_vector[i] = (\n                parameter_vector[i] - LEARNING_RATE * cost_derivative\n            )\n        <span class=\"hljs-keyword\">if</span> numpy.allclose(\n            parameter_vector,\n            temp_parameter_vector,\n            atol=absolute_error_limit,\n            rtol=relative_error_limit,\n        ):\n            <span class=\"hljs-keyword\">break</span>\n        parameter_vector = temp_parameter_vector\n    <span class=\"hljs-built_in\">print</span>((<span class=\"hljs-string\">&quot;Number of iterations:&quot;</span>, j))\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">test_gradient_descent</span>():\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-built_in\">len</span>(test_data)):\n        <span class=\"hljs-built_in\">print</span>((<span class=\"hljs-string\">&quot;Actual output value:&quot;</span>, output(i, <span class=\"hljs-string\">&quot;test&quot;</span>)))\n        <span class=\"hljs-built_in\">print</span>((<span class=\"hljs-string\">&quot;Hypothesis output:&quot;</span>, calculate_hypothesis_value(i, <span class=\"hljs-string\">&quot;test&quot;</span>)))\n\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\n    run_gradient_descent()\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;\\nTesting gradient descent for a linear hypothesis function.\\n&quot;</span>)\n    test_gradient_descent()\n"
    },
    "matlab-octave": {
      "dir": "algorithms/machine_learning/Linear-Regression/gradientdescent.m",
      "url": "https://github.com/TheAlgorithms/matlab-octave/tree/master/algorithms/machine_learning/Linear-Regression/gradientdescent.m",
      "code": "<span class=\"hljs-comment\">% This function demonstrates gradient descent in case of linear regression with one variable.</span>\n\n<span class=\"hljs-comment\">% Theta is a column vector with two elements which this function returns after modifying it.</span>\n\n<span class=\"hljs-comment\">% This function receives the feature vector x, vector of actual target variables Y, Theta</span>\n\n<span class=\"hljs-comment\">% containing initial values of theta_0 and theta_1, learning rate Alpha, number of iterations</span>\n\n<span class=\"hljs-comment\">% noi.</span>\n\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">Theta</span> = <span class=\"hljs-title\">gradientdescent</span><span class=\"hljs-params\">(x, Y, Theta, Alpha, noi)</span></span>\n\n    n = <span class=\"hljs-built_in\">length</span>(Y); <span class=\"hljs-comment\">% Number of training examples. </span>\n\n    <span class=\"hljs-keyword\">for</span> <span class=\"hljs-built_in\">i</span> = <span class=\"hljs-number\">1</span>:noi \n\n        theta_1 = Theta(<span class=\"hljs-number\">1</span>) - Alpha * (<span class=\"hljs-number\">1</span> / n) * sum(((x * Theta) - Y) .* x(:, <span class=\"hljs-number\">1</span>)); <span class=\"hljs-comment\">% Temporary variable to simultaneously update theta_0 but i have used 1 to</span>\n\n                                                                                  <span class=\"hljs-comment\">% avoid confusion since indexing in MATLAB/Octave starts from 1.</span>\n\n        theta_2 = Theta(<span class=\"hljs-number\">2</span>) - Alpha * (<span class=\"hljs-number\">1</span> / n) * sum(((x * Theta) - Y) .* x(:, <span class=\"hljs-number\">2</span>)); <span class=\"hljs-comment\">% Temporary variable to simultaneously update theta_1.</span>\n\n        Theta(<span class=\"hljs-number\">1</span>) = theta_1; <span class=\"hljs-comment\">% Assigning first temporary value to update first actual value simultaneously.  </span>\n    \n        Theta(<span class=\"hljs-number\">2</span>) = theta_2; <span class=\"hljs-comment\">% Assigning second temporary value to update second actual value simultaneously. </span>\n\n    <span class=\"hljs-keyword\">end</span>\n\n<span class=\"hljs-keyword\">end</span>"
    }
  },
  "contributors": [
    {
      "name": "Anesh Kaul",
      "email": "aneshkaul@gmail.com",
      "commits": 1
    },
    {
      "name": "ParthS007",
      "email": "parth1989shandilya@gmail.com",
      "commits": 1
    },
    {
      "name": "William Zhang",
      "email": "39932068+WilliamHYZhang@users.noreply.github.com",
      "commits": 1
    },
    {
      "name": "cclauss",
      "email": "cclauss@bluewin.ch",
      "commits": 1
    },
    {
      "name": "97arushisharma",
      "email": "97arushisharma@gmail.com",
      "commits": 1
    },
    {
      "name": "=",
      "email": "201551009@iiitvadodara.ac.in",
      "commits": 1
    },
    {
      "name": "Christian Clauss",
      "email": "cclauss@me.com",
      "commits": 2
    },
    {
      "name": "Anesh Kaul",
      "email": "koulanish787@gmail.com",
      "commits": 2
    }
  ],
  "explanationUrl": {}
}
