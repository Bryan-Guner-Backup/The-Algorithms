{
  "slug": "instagram-crawler",
  "name": "Instagram Crawler",
  "categories": ["webprogramming"],
  "body": {},
  "implementations": {
    "python": {
      "dir": "web_programming/instagram_crawler.py",
      "url": "https://github.com/TheAlgorithms/python/tree/master/web_programming/instagram_crawler.py",
      "code": "<span class=\"hljs-comment\">#!/usr/bin/env python3</span>\n<span class=\"hljs-keyword\">from</span> __future__ <span class=\"hljs-keyword\">import</span> annotations\n\n<span class=\"hljs-keyword\">import</span> json\n\n<span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">from</span> bs4 <span class=\"hljs-keyword\">import</span> BeautifulSoup\n<span class=\"hljs-keyword\">from</span> fake_useragent <span class=\"hljs-keyword\">import</span> UserAgent\n\nheaders = {<span class=\"hljs-string\">&quot;UserAgent&quot;</span>: UserAgent().random}\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">extract_user_profile</span>(<span class=\"hljs-params\">script</span>) -&gt; <span class=\"hljs-built_in\">dict</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    May raise json.decoder.JSONDecodeError\n    &quot;&quot;&quot;</span>\n    data = script.contents[<span class=\"hljs-number\">0</span>]\n    info = json.loads(data[data.find(<span class=\"hljs-string\">&#x27;{&quot;config&quot;&#x27;</span>) : -<span class=\"hljs-number\">1</span>])\n    <span class=\"hljs-keyword\">return</span> info[<span class=\"hljs-string\">&quot;entry_data&quot;</span>][<span class=\"hljs-string\">&quot;ProfilePage&quot;</span>][<span class=\"hljs-number\">0</span>][<span class=\"hljs-string\">&quot;graphql&quot;</span>][<span class=\"hljs-string\">&quot;user&quot;</span>]\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">InstagramUser</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    Class Instagram crawl instagram user information\n\n    Usage: (doctest failing on GitHub Actions)\n    # &gt;&gt;&gt; instagram_user = InstagramUser(&quot;github&quot;)\n    # &gt;&gt;&gt; instagram_user.is_verified\n    True\n    # &gt;&gt;&gt; instagram_user.biography\n    &#x27;Built for developers.&#x27;\n    &quot;&quot;&quot;</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, username</span>):\n        self.url = <span class=\"hljs-string\">f&quot;https://www.instagram.com/<span class=\"hljs-subst\">{username}</span>/&quot;</span>\n        self.user_data = self.get_json()\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_json</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">dict</span>:\n        <span class=\"hljs-string\">&quot;&quot;&quot;\n        Return a dict of user information\n        &quot;&quot;&quot;</span>\n        html = requests.get(self.url, headers=headers).text\n        scripts = BeautifulSoup(html, <span class=\"hljs-string\">&quot;html.parser&quot;</span>).find_all(<span class=\"hljs-string\">&quot;script&quot;</span>)\n        <span class=\"hljs-keyword\">try</span>:\n            <span class=\"hljs-keyword\">return</span> extract_user_profile(scripts[<span class=\"hljs-number\">4</span>])\n        <span class=\"hljs-keyword\">except</span> (json.decoder.JSONDecodeError, KeyError):\n            <span class=\"hljs-keyword\">return</span> extract_user_profile(scripts[<span class=\"hljs-number\">3</span>])\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__repr__</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">f&quot;<span class=\"hljs-subst\">{self.__class__.__name__}</span>(&#x27;<span class=\"hljs-subst\">{self.username}</span>&#x27;)&quot;</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__str__</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">f&quot;<span class=\"hljs-subst\">{self.fullname}</span> (<span class=\"hljs-subst\">{self.username}</span>) is <span class=\"hljs-subst\">{self.biography}</span>&quot;</span>\n\n<span class=\"hljs-meta\">    @property</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">username</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-keyword\">return</span> self.user_data[<span class=\"hljs-string\">&quot;username&quot;</span>]\n\n<span class=\"hljs-meta\">    @property</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">fullname</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-keyword\">return</span> self.user_data[<span class=\"hljs-string\">&quot;full_name&quot;</span>]\n\n<span class=\"hljs-meta\">    @property</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">biography</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-keyword\">return</span> self.user_data[<span class=\"hljs-string\">&quot;biography&quot;</span>]\n\n<span class=\"hljs-meta\">    @property</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">email</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-keyword\">return</span> self.user_data[<span class=\"hljs-string\">&quot;business_email&quot;</span>]\n\n<span class=\"hljs-meta\">    @property</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">website</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-keyword\">return</span> self.user_data[<span class=\"hljs-string\">&quot;external_url&quot;</span>]\n\n<span class=\"hljs-meta\">    @property</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">number_of_followers</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">int</span>:\n        <span class=\"hljs-keyword\">return</span> self.user_data[<span class=\"hljs-string\">&quot;edge_followed_by&quot;</span>][<span class=\"hljs-string\">&quot;count&quot;</span>]\n\n<span class=\"hljs-meta\">    @property</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">number_of_followings</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">int</span>:\n        <span class=\"hljs-keyword\">return</span> self.user_data[<span class=\"hljs-string\">&quot;edge_follow&quot;</span>][<span class=\"hljs-string\">&quot;count&quot;</span>]\n\n<span class=\"hljs-meta\">    @property</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">number_of_posts</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">int</span>:\n        <span class=\"hljs-keyword\">return</span> self.user_data[<span class=\"hljs-string\">&quot;edge_owner_to_timeline_media&quot;</span>][<span class=\"hljs-string\">&quot;count&quot;</span>]\n\n<span class=\"hljs-meta\">    @property</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">profile_picture_url</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-keyword\">return</span> self.user_data[<span class=\"hljs-string\">&quot;profile_pic_url_hd&quot;</span>]\n\n<span class=\"hljs-meta\">    @property</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">is_verified</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">bool</span>:\n        <span class=\"hljs-keyword\">return</span> self.user_data[<span class=\"hljs-string\">&quot;is_verified&quot;</span>]\n\n<span class=\"hljs-meta\">    @property</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">is_private</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">bool</span>:\n        <span class=\"hljs-keyword\">return</span> self.user_data[<span class=\"hljs-string\">&quot;is_private&quot;</span>]\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">test_instagram_user</span>(<span class=\"hljs-params\">username: <span class=\"hljs-built_in\">str</span> = <span class=\"hljs-string\">&quot;github&quot;</span></span>) -&gt; <span class=\"hljs-literal\">None</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    A self running doctest\n    &gt;&gt;&gt; test_instagram_user()\n    &quot;&quot;&quot;</span>\n    <span class=\"hljs-keyword\">import</span> os\n\n    <span class=\"hljs-keyword\">if</span> os.environ.get(<span class=\"hljs-string\">&quot;CI&quot;</span>):\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>  <span class=\"hljs-comment\"># test failing on GitHub Actions</span>\n    instagram_user = InstagramUser(username)\n    <span class=\"hljs-keyword\">assert</span> instagram_user.user_data\n    <span class=\"hljs-keyword\">assert</span> <span class=\"hljs-built_in\">isinstance</span>(instagram_user.user_data, <span class=\"hljs-built_in\">dict</span>)\n    <span class=\"hljs-keyword\">assert</span> instagram_user.username == username\n    <span class=\"hljs-keyword\">if</span> username != <span class=\"hljs-string\">&quot;github&quot;</span>:\n        <span class=\"hljs-keyword\">return</span>\n    <span class=\"hljs-keyword\">assert</span> instagram_user.fullname == <span class=\"hljs-string\">&quot;GitHub&quot;</span>\n    <span class=\"hljs-keyword\">assert</span> instagram_user.biography == <span class=\"hljs-string\">&quot;Built for developers.&quot;</span>\n    <span class=\"hljs-keyword\">assert</span> instagram_user.number_of_posts &gt; <span class=\"hljs-number\">150</span>\n    <span class=\"hljs-keyword\">assert</span> instagram_user.number_of_followers &gt; <span class=\"hljs-number\">120000</span>\n    <span class=\"hljs-keyword\">assert</span> instagram_user.number_of_followings &gt; <span class=\"hljs-number\">15</span>\n    <span class=\"hljs-keyword\">assert</span> instagram_user.email == <span class=\"hljs-string\">&quot;support@github.com&quot;</span>\n    <span class=\"hljs-keyword\">assert</span> instagram_user.website == <span class=\"hljs-string\">&quot;https://github.com/readme&quot;</span>\n    <span class=\"hljs-keyword\">assert</span> instagram_user.profile_picture_url.startswith(<span class=\"hljs-string\">&quot;https://instagram.&quot;</span>)\n    <span class=\"hljs-keyword\">assert</span> instagram_user.is_verified <span class=\"hljs-keyword\">is</span> <span class=\"hljs-literal\">True</span>\n    <span class=\"hljs-keyword\">assert</span> instagram_user.is_private <span class=\"hljs-keyword\">is</span> <span class=\"hljs-literal\">False</span>\n\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\n    <span class=\"hljs-keyword\">import</span> doctest\n\n    doctest.testmod()\n    instagram_user = InstagramUser(<span class=\"hljs-string\">&quot;github&quot;</span>)\n    <span class=\"hljs-built_in\">print</span>(instagram_user)\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;<span class=\"hljs-subst\">{instagram_user.number_of_posts = }</span>&quot;</span>)\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;<span class=\"hljs-subst\">{instagram_user.number_of_followers = }</span>&quot;</span>)\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;<span class=\"hljs-subst\">{instagram_user.number_of_followings = }</span>&quot;</span>)\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;<span class=\"hljs-subst\">{instagram_user.email = }</span>&quot;</span>)\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;<span class=\"hljs-subst\">{instagram_user.website = }</span>&quot;</span>)\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;<span class=\"hljs-subst\">{instagram_user.profile_picture_url = }</span>&quot;</span>)\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;<span class=\"hljs-subst\">{instagram_user.is_verified = }</span>&quot;</span>)\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">f&quot;<span class=\"hljs-subst\">{instagram_user.is_private = }</span>&quot;</span>)\n"
    }
  },
  "contributors": [
    {
      "name": "YOGESHWARAN R",
      "email": "yogeshin247@gmail.com",
      "commits": 1
    },
    {
      "name": "Dhruv Manilawala",
      "email": "dhruvmanila@gmail.com",
      "commits": 2
    }
  ],
  "explanationUrl": {}
}
