{
  "slug": "brent-method-extrema",
  "name": "Brent Method Extrema",
  "categories": ["numericalmethods"],
  "body": {},
  "implementations": {
    "c-plus-plus": {
      "dir": "numerical_methods/brent_method_extrema.cpp",
      "url": "https://github.com/TheAlgorithms/c-plus-plus/tree/master/numerical_methods/brent_method_extrema.cpp",
      "code": "<span class=\"hljs-comment\">/**\n * \\file\n * \\brief Find real extrema of a univariate real function in a given interval\n * using [Brent&#x27;s method](https://en.wikipedia.org/wiki/Brent%27s_method).\n *\n * Refer the algorithm discoverer&#x27;s publication\n * [online](https://maths-people.anu.edu.au/~brent/pd/rpb011i.pdf) and also\n * associated book:\n * &gt; R. P. Brent, Algorithms for Minimization without\n * &gt; Derivatives, Prentice-Hall, Englewood Cliffs, New Jersey, 1973\n *\n * \\see golden_search_extrema.cpp\n *\n * \\author [Krishna Vedala](https://github.com/kvedala)\n */</span>\n<span class=\"hljs-meta\">#<span class=\"hljs-keyword\">define</span> _USE_MATH_DEFINES  <span class=\"hljs-comment\">///&lt; required for MS Visual C++</span></span>\n<span class=\"hljs-meta\">#<span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&lt;cassert&gt;</span></span>\n<span class=\"hljs-meta\">#<span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&lt;cmath&gt;</span></span>\n<span class=\"hljs-meta\">#<span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&lt;functional&gt;</span></span>\n<span class=\"hljs-meta\">#<span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&lt;iostream&gt;</span></span>\n<span class=\"hljs-meta\">#<span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&lt;limits&gt;</span></span>\n\n<span class=\"hljs-meta\">#<span class=\"hljs-keyword\">define</span> EPSILON \\\n    std::sqrt(  \\\n        std::numeric_limits<span class=\"hljs-string\">&lt;double&gt;</span>::epsilon())  <span class=\"hljs-comment\">///&lt; system accuracy limit</span></span>\n\n<span class=\"hljs-comment\">/**\n * @brief Get the real root of a function in the given interval.\n *\n * @param f function to get root for\n * @param lim_a lower limit of search window\n * @param lim_b upper limit of search window\n * @return root found in the interval\n */</span>\n<span class=\"hljs-function\"><span class=\"hljs-type\">double</span> <span class=\"hljs-title\">get_minima</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">const</span> std::function&lt;<span class=\"hljs-type\">double</span>(<span class=\"hljs-type\">double</span>)&gt; &amp;f, <span class=\"hljs-type\">double</span> lim_a,\n                  <span class=\"hljs-type\">double</span> lim_b)</span> </span>{\n    <span class=\"hljs-type\">uint32_t</span> iters = <span class=\"hljs-number\">0</span>;\n\n    <span class=\"hljs-keyword\">if</span> (lim_a &gt; lim_b) {\n        std::<span class=\"hljs-built_in\">swap</span>(lim_a, lim_b);\n    } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (std::<span class=\"hljs-built_in\">abs</span>(lim_a - lim_b) &lt;= EPSILON) {\n        std::cerr &lt;&lt; <span class=\"hljs-string\">&quot;Search range must be greater than &quot;</span> &lt;&lt; EPSILON &lt;&lt; <span class=\"hljs-string\">&quot;\\n&quot;</span>;\n        <span class=\"hljs-keyword\">return</span> lim_a;\n    }\n\n    <span class=\"hljs-comment\">// golden ratio value</span>\n    <span class=\"hljs-keyword\">const</span> <span class=\"hljs-type\">double</span> M_GOLDEN_RATIO = (<span class=\"hljs-number\">3.f</span> - std::<span class=\"hljs-built_in\">sqrt</span>(<span class=\"hljs-number\">5.f</span>)) / <span class=\"hljs-number\">2.f</span>;\n\n    <span class=\"hljs-type\">double</span> v = lim_a + M_GOLDEN_RATIO * (lim_b - lim_a);\n    <span class=\"hljs-type\">double</span> u, w = v, x = v;\n    <span class=\"hljs-type\">double</span> fu, fv = <span class=\"hljs-built_in\">f</span>(v);\n    <span class=\"hljs-type\">double</span> fw = fv, fx = fv;\n\n    <span class=\"hljs-type\">double</span> mid_point = (lim_a + lim_b) / <span class=\"hljs-number\">2.f</span>;\n    <span class=\"hljs-type\">double</span> p = <span class=\"hljs-number\">0</span>, q = <span class=\"hljs-number\">0</span>, r = <span class=\"hljs-number\">0</span>;\n\n    <span class=\"hljs-type\">double</span> d, e = <span class=\"hljs-number\">0</span>;\n    <span class=\"hljs-type\">double</span> tolerance, tolerance2;\n\n    <span class=\"hljs-keyword\">do</span> {\n        mid_point = (lim_a + lim_b) / <span class=\"hljs-number\">2.f</span>;\n        tolerance = EPSILON * std::<span class=\"hljs-built_in\">abs</span>(x);\n        tolerance2 = <span class=\"hljs-number\">2</span> * tolerance;\n\n        <span class=\"hljs-keyword\">if</span> (std::<span class=\"hljs-built_in\">abs</span>(e) &gt; tolerance2) {\n            <span class=\"hljs-comment\">// fit parabola</span>\n            r = (x - w) * (fx - fv);\n            q = (x - v) * (fx - fw);\n            p = (x - v) * q - (x - w) * r;\n            q = <span class=\"hljs-number\">2.f</span> * (q - r);\n            <span class=\"hljs-keyword\">if</span> (q &gt; <span class=\"hljs-number\">0</span>)\n                p = -p;\n            <span class=\"hljs-keyword\">else</span>\n                q = -q;\n            r = e;\n            e = d;\n        }\n\n        <span class=\"hljs-keyword\">if</span> (std::<span class=\"hljs-built_in\">abs</span>(p) &lt; std::<span class=\"hljs-built_in\">abs</span>(<span class=\"hljs-number\">0.5</span> * q * r) &amp;&amp; p &lt; q * (lim_b - x)) {\n            <span class=\"hljs-comment\">// parabolic interpolation step</span>\n            d = p / q;\n            u = x + d;\n            <span class=\"hljs-keyword\">if</span> (u - lim_a &lt; tolerance2 || lim_b - u &lt; tolerance2)\n                d = x &lt; mid_point ? tolerance : -tolerance;\n        } <span class=\"hljs-keyword\">else</span> {\n            <span class=\"hljs-comment\">// golden section interpolation step</span>\n            e = (x &lt; mid_point ? lim_b : lim_a) - x;\n            d = M_GOLDEN_RATIO * e;\n        }\n\n        <span class=\"hljs-comment\">// evaluate not too close to x</span>\n        <span class=\"hljs-keyword\">if</span> (std::<span class=\"hljs-built_in\">abs</span>(d) &gt;= tolerance)\n            u = d;\n        <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (d &gt; <span class=\"hljs-number\">0</span>)\n            u = tolerance;\n        <span class=\"hljs-keyword\">else</span>\n            u = -tolerance;\n        u += x;\n        fu = <span class=\"hljs-built_in\">f</span>(u);\n\n        <span class=\"hljs-comment\">// update variables</span>\n        <span class=\"hljs-keyword\">if</span> (fu &lt;= fx) {\n            <span class=\"hljs-keyword\">if</span> (u &lt; x)\n                lim_b = x;\n            <span class=\"hljs-keyword\">else</span>\n                lim_a = x;\n            v = w;\n            fv = fw;\n            w = x;\n            fw = fx;\n            x = u;\n            fx = fu;\n        } <span class=\"hljs-keyword\">else</span> {\n            <span class=\"hljs-keyword\">if</span> (u &lt; x)\n                lim_a = u;\n            <span class=\"hljs-keyword\">else</span>\n                lim_b = u;\n            <span class=\"hljs-keyword\">if</span> (fu &lt;= fw || x == w) {\n                v = w;\n                fv = fw;\n                w = u;\n                fw = fu;\n            } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (fu &lt;= fv || v == x || v == w) {\n                v = u;\n                fv = fu;\n            }\n        }\n\n        iters++;\n    } <span class=\"hljs-keyword\">while</span> (std::<span class=\"hljs-built_in\">abs</span>(x - mid_point) &gt; (tolerance - (lim_b - lim_a) / <span class=\"hljs-number\">2.f</span>));\n\n    std::cout &lt;&lt; <span class=\"hljs-string\">&quot; (iters: &quot;</span> &lt;&lt; iters &lt;&lt; <span class=\"hljs-string\">&quot;) &quot;</span>;\n\n    <span class=\"hljs-keyword\">return</span> x;\n}\n\n<span class=\"hljs-comment\">/**\n * @brief Test function to find root for the function\n * \\f$f(x)= (x-2)^2\\f$\n * in the interval \\f$[1,5]\\f$\n * \\n Expected result = 2\n */</span>\n<span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">test1</span><span class=\"hljs-params\">()</span> </span>{\n    <span class=\"hljs-comment\">// define the function to minimize as a lambda function</span>\n    std::function&lt;<span class=\"hljs-type\">double</span>(<span class=\"hljs-type\">double</span>)&gt; f1 = [](<span class=\"hljs-type\">double</span> x) {\n        <span class=\"hljs-built_in\">return</span> (x - <span class=\"hljs-number\">2</span>) * (x - <span class=\"hljs-number\">2</span>);\n    };\n\n    std::cout &lt;&lt; <span class=\"hljs-string\">&quot;Test 1.... &quot;</span>;\n\n    <span class=\"hljs-type\">double</span> minima = <span class=\"hljs-built_in\">get_minima</span>(f1, <span class=\"hljs-number\">-1</span>, <span class=\"hljs-number\">5</span>);\n\n    std::cout &lt;&lt; minima &lt;&lt; <span class=\"hljs-string\">&quot;...&quot;</span>;\n\n    <span class=\"hljs-built_in\">assert</span>(std::<span class=\"hljs-built_in\">abs</span>(minima - <span class=\"hljs-number\">2</span>) &lt; EPSILON);\n    std::cout &lt;&lt; <span class=\"hljs-string\">&quot;passed\\n&quot;</span>;\n}\n\n<span class=\"hljs-comment\">/**\n * @brief Test function to find root for the function\n * \\f$f(x)= x^{\\frac{1}{x}}\\f$\n * in the interval \\f$[-2,10]\\f$\n * \\n Expected result: \\f$e\\approx 2.71828182845904509\\f$\n */</span>\n<span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">test2</span><span class=\"hljs-params\">()</span> </span>{\n    <span class=\"hljs-comment\">// define the function to maximize as a lambda function</span>\n    <span class=\"hljs-comment\">// since we are maximixing, we negated the function return value</span>\n    std::function&lt;<span class=\"hljs-type\">double</span>(<span class=\"hljs-type\">double</span>)&gt; func = [](<span class=\"hljs-type\">double</span> x) {\n        <span class=\"hljs-keyword\">return</span> -std::<span class=\"hljs-built_in\">pow</span>(x, <span class=\"hljs-number\">1.f</span> / x);\n    };\n\n    std::cout &lt;&lt; <span class=\"hljs-string\">&quot;Test 2.... &quot;</span>;\n\n    <span class=\"hljs-type\">double</span> minima = <span class=\"hljs-built_in\">get_minima</span>(func, <span class=\"hljs-number\">-2</span>, <span class=\"hljs-number\">5</span>);\n\n    std::cout &lt;&lt; minima &lt;&lt; <span class=\"hljs-string\">&quot; (&quot;</span> &lt;&lt; M_E &lt;&lt; <span class=\"hljs-string\">&quot;)...&quot;</span>;\n\n    <span class=\"hljs-built_in\">assert</span>(std::<span class=\"hljs-built_in\">abs</span>(minima - M_E) &lt; EPSILON);\n    std::cout &lt;&lt; <span class=\"hljs-string\">&quot;passed\\n&quot;</span>;\n}\n\n<span class=\"hljs-comment\">/**\n * @brief Test function to find *maxima* for the function\n * \\f$f(x)= \\cos x\\f$\n * in the interval \\f$[0,12]\\f$\n * \\n Expected result: \\f$\\pi\\approx 3.14159265358979312\\f$\n */</span>\n<span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">test3</span><span class=\"hljs-params\">()</span> </span>{\n    <span class=\"hljs-comment\">// define the function to maximize as a lambda function</span>\n    <span class=\"hljs-comment\">// since we are maximixing, we negated the function return value</span>\n    std::function&lt;<span class=\"hljs-type\">double</span>(<span class=\"hljs-type\">double</span>)&gt; func = [](<span class=\"hljs-type\">double</span> x) { <span class=\"hljs-keyword\">return</span> std::<span class=\"hljs-built_in\">cos</span>(x); };\n\n    std::cout &lt;&lt; <span class=\"hljs-string\">&quot;Test 3.... &quot;</span>;\n\n    <span class=\"hljs-type\">double</span> minima = <span class=\"hljs-built_in\">get_minima</span>(func, <span class=\"hljs-number\">-4</span>, <span class=\"hljs-number\">12</span>);\n\n    std::cout &lt;&lt; minima &lt;&lt; <span class=\"hljs-string\">&quot; (&quot;</span> &lt;&lt; M_PI &lt;&lt; <span class=\"hljs-string\">&quot;)...&quot;</span>;\n\n    <span class=\"hljs-built_in\">assert</span>(std::<span class=\"hljs-built_in\">abs</span>(minima - M_PI) &lt; EPSILON);\n    std::cout &lt;&lt; <span class=\"hljs-string\">&quot;passed\\n&quot;</span>;\n}\n\n<span class=\"hljs-comment\">/** Main function */</span>\n<span class=\"hljs-function\"><span class=\"hljs-type\">int</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">()</span> </span>{\n    std::cout.<span class=\"hljs-built_in\">precision</span>(<span class=\"hljs-number\">18</span>);\n\n    std::cout &lt;&lt; <span class=\"hljs-string\">&quot;Computations performed with machine epsilon: &quot;</span> &lt;&lt; EPSILON\n              &lt;&lt; <span class=\"hljs-string\">&quot;\\n&quot;</span>;\n\n    <span class=\"hljs-built_in\">test1</span>();\n    <span class=\"hljs-built_in\">test2</span>();\n    <span class=\"hljs-built_in\">test3</span>();\n\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0</span>;\n}\n"
    }
  },
  "contributors": [
    {
      "name": "Krishna Vedala",
      "email": "7001608+kvedala@users.noreply.github.com",
      "commits": 5
    }
  ],
  "explanationUrl": {}
}
