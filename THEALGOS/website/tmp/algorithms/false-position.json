{
  "slug": "false-position",
  "name": "False Position",
  "categories": ["numericalmethods"],
  "body": {},
  "implementations": {
    "c-plus-plus": {
      "dir": "numerical_methods/false_position.cpp",
      "url": "https://github.com/TheAlgorithms/c-plus-plus/tree/master/numerical_methods/false_position.cpp",
      "code": "<span class=\"hljs-comment\">/**\n * \\file\n * \\brief Solve the equation \\f$f(x)=0\\f$ using [false position\n * method](https://en.wikipedia.org/wiki/Regula_falsi), also known as the Secant\n * method\n *\n * \\details\n * First, multiple intervals are selected with the interval gap provided.\n * Separate recursive function called for every root.\n * Roots are printed Separatelt.\n *\n * For an interval [a,b] \\f$a\\f$ and \\f$b\\f$ such that \\f$f(a)&lt;0\\f$ and\n * \\f$f(b)&gt;0\\f$, then the \\f$(i+1)^\\text{th}\\f$ approximation is given by: \\f[\n * x_{i+1} = \\frac{a_i\\cdot f(b_i) - b_i\\cdot f(a_i)}{f(b_i) - f(a_i)}\n * \\f]\n * For the next iteration, the interval is selected\n * as: \\f$[a,x]\\f$ if \\f$x&gt;0\\f$ or \\f$[x,b]\\f$ if \\f$x&lt;0\\f$. The Process is\n * continued till a close enough approximation is achieved.\n *\n * \\see newton_raphson_method.cpp, bisection_method.cpp\n *\n * \\author Unknown author\n * \\author [Samruddha Patil](https://github.com/sampatil578)\n */</span>\n<span class=\"hljs-meta\">#<span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&lt;cmath&gt;</span>     <span class=\"hljs-comment\">/// for math operations</span></span>\n<span class=\"hljs-meta\">#<span class=\"hljs-keyword\">include</span> <span class=\"hljs-string\">&lt;iostream&gt;</span>  <span class=\"hljs-comment\">/// for io operations</span></span>\n\n<span class=\"hljs-comment\">/**\n * @namespace numerical_methods\n * @brief Numerical methods\n */</span>\n<span class=\"hljs-keyword\">namespace</span> numerical_methods {\n<span class=\"hljs-comment\">/**\n * @namespace false_position\n * @brief Functions for [False Position]\n * (https://en.wikipedia.org/wiki/Regula_falsi) method.\n */</span>\n<span class=\"hljs-keyword\">namespace</span> false_position {\n<span class=\"hljs-comment\">/**\n * @brief This function gives the value of f(x) for given x.\n * @param x value for which we have to find value of f(x).\n * @return value of f(x) for given x.\n */</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">static</span> <span class=\"hljs-type\">float</span> <span class=\"hljs-title\">eq</span><span class=\"hljs-params\">(<span class=\"hljs-type\">float</span> x)</span> </span>{\n    <span class=\"hljs-keyword\">return</span> (x * x - x);  <span class=\"hljs-comment\">// original equation</span>\n}\n\n<span class=\"hljs-comment\">/**\n* @brief This function finds root of the equation in given interval i.e.\n(x1,x2).\n* @param x1,x2 values for an interval in which root is present.\n  @param y1,y2 values of function at x1, x2 espectively.\n* @return root of the equation in the given interval.\n*/</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">static</span> <span class=\"hljs-type\">float</span> <span class=\"hljs-title\">regula_falsi</span><span class=\"hljs-params\">(<span class=\"hljs-type\">float</span> x1, <span class=\"hljs-type\">float</span> x2, <span class=\"hljs-type\">float</span> y1, <span class=\"hljs-type\">float</span> y2)</span> </span>{\n    <span class=\"hljs-type\">float</span> diff = x1 - x2;\n    <span class=\"hljs-keyword\">if</span> (diff &lt; <span class=\"hljs-number\">0</span>) {\n        diff = (<span class=\"hljs-number\">-1</span>) * diff;\n    }\n    <span class=\"hljs-keyword\">if</span> (diff &lt; <span class=\"hljs-number\">0.00001</span>) {\n        <span class=\"hljs-keyword\">if</span> (y1 &lt; <span class=\"hljs-number\">0</span>) {\n            y1 = -y1;\n        }\n        <span class=\"hljs-keyword\">if</span> (y2 &lt; <span class=\"hljs-number\">0</span>) {\n            y2 = -y2;\n        }\n        <span class=\"hljs-keyword\">if</span> (y1 &lt; y2) {\n            <span class=\"hljs-keyword\">return</span> x1;\n        } <span class=\"hljs-keyword\">else</span> {\n            <span class=\"hljs-keyword\">return</span> x2;\n        }\n    }\n    <span class=\"hljs-type\">float</span> x3 = <span class=\"hljs-number\">0</span>, y3 = <span class=\"hljs-number\">0</span>;\n    x3 = x1 - (x1 - x2) * (y1) / (y1 - y2);\n    y3 = <span class=\"hljs-built_in\">eq</span>(x3);\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">regula_falsi</span>(x2, x3, y2, y3);\n}\n\n<span class=\"hljs-comment\">/**\n * @brief This function prints roots of the equation.\n * @param root which we have to print.\n * @param count which is count of the root in an interval [-range,range].\n */</span>\n<span class=\"hljs-function\"><span class=\"hljs-type\">void</span> <span class=\"hljs-title\">printRoot</span><span class=\"hljs-params\">(<span class=\"hljs-type\">float</span> root, <span class=\"hljs-keyword\">const</span> <span class=\"hljs-type\">int16_t</span> &amp;count)</span> </span>{\n    <span class=\"hljs-keyword\">if</span> (count == <span class=\"hljs-number\">1</span>) {\n        std::cout &lt;&lt; <span class=\"hljs-string\">&quot;Your 1st root is : &quot;</span> &lt;&lt; root &lt;&lt; std::endl;\n    } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (count == <span class=\"hljs-number\">2</span>) {\n        std::cout &lt;&lt; <span class=\"hljs-string\">&quot;Your 2nd root is : &quot;</span> &lt;&lt; root &lt;&lt; std::endl;\n    } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (count == <span class=\"hljs-number\">3</span>) {\n        std::cout &lt;&lt; <span class=\"hljs-string\">&quot;Your 3rd root is : &quot;</span> &lt;&lt; root &lt;&lt; std::endl;\n    } <span class=\"hljs-keyword\">else</span> {\n        std::cout &lt;&lt; <span class=\"hljs-string\">&quot;Your &quot;</span> &lt;&lt; count &lt;&lt; <span class=\"hljs-string\">&quot;th root is : &quot;</span> &lt;&lt; root &lt;&lt; std::endl;\n    }\n}\n}  <span class=\"hljs-comment\">// namespace false_position</span>\n}  <span class=\"hljs-comment\">// namespace numerical_methods</span>\n\n<span class=\"hljs-comment\">/**\n * @brief Main function\n * @returns 0 on exit\n */</span>\n<span class=\"hljs-function\"><span class=\"hljs-type\">int</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">()</span> </span>{\n    <span class=\"hljs-type\">float</span> a = <span class=\"hljs-number\">0</span>, b = <span class=\"hljs-number\">0</span>, i = <span class=\"hljs-number\">0</span>, root = <span class=\"hljs-number\">0</span>;\n    <span class=\"hljs-type\">int16_t</span> count = <span class=\"hljs-number\">0</span>;\n    <span class=\"hljs-type\">float</span> range =\n        <span class=\"hljs-number\">100000</span>;       <span class=\"hljs-comment\">// Range in which we have to find the root. (-range,range)</span>\n    <span class=\"hljs-type\">float</span> gap = <span class=\"hljs-number\">0.5</span>;  <span class=\"hljs-comment\">// interval gap. lesser the gap more the accuracy</span>\n    a = numerical_methods::false_position::<span class=\"hljs-built_in\">eq</span>((<span class=\"hljs-number\">-1</span>) * range);\n    i = ((<span class=\"hljs-number\">-1</span>) * range + gap);\n    <span class=\"hljs-comment\">// while loop for selecting proper interval in provided range and with</span>\n    <span class=\"hljs-comment\">// provided interval gap.</span>\n    <span class=\"hljs-keyword\">while</span> (i &lt;= range) {\n        b = numerical_methods::false_position::<span class=\"hljs-built_in\">eq</span>(i);\n        <span class=\"hljs-keyword\">if</span> (b == <span class=\"hljs-number\">0</span>) {\n            count++;\n            numerical_methods::false_position::<span class=\"hljs-built_in\">printRoot</span>(i, count);\n        }\n        <span class=\"hljs-keyword\">if</span> (a * b &lt; <span class=\"hljs-number\">0</span>) {\n            root = numerical_methods::false_position::<span class=\"hljs-built_in\">regula_falsi</span>(i - gap, i,\n                                                                   a, b);\n            count++;\n            numerical_methods::false_position::<span class=\"hljs-built_in\">printRoot</span>(root, count);\n        }\n        a = b;\n        i += gap;\n    }\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0</span>;\n}\n"
    },
    "matlab-octave": {
      "dir": "algorithms/arithmetic_analysis/false_position.m",
      "url": "https://github.com/TheAlgorithms/matlab-octave/tree/master/algorithms/arithmetic_analysis/false_position.m",
      "code": "<span class=\"hljs-comment\">%The basic idea behind the false position method is similar to the bisection</span>\n<span class=\"hljs-comment\">%method in that we continuously shrink the interval the root lies on until</span>\n<span class=\"hljs-comment\">%the algorithm converges on the root. Unlike the bisection method, the false</span>\n<span class=\"hljs-comment\">%position method does not halve the interval with each iteration. Instead of</span>\n<span class=\"hljs-comment\">%using the midpoint of a and b to create the new interval, the false position</span>\n<span class=\"hljs-comment\">%method uses the x-intercept of the line connecting f(a) and f(b). This </span>\n<span class=\"hljs-comment\">%algorithm converges faster than the bisection method.</span>\n\n<span class=\"hljs-comment\">%INPUTS:</span>\n<span class=\"hljs-comment\">%Function handle f</span>\n<span class=\"hljs-comment\">%endpoint a</span>\n<span class=\"hljs-comment\">%endpoint b</span>\n<span class=\"hljs-comment\">%maximum tolerated error</span>\n\n<span class=\"hljs-comment\">%OUTPUTS:</span>\n<span class=\"hljs-comment\">%An approximated value for the root of f within the defined interval.</span>\n\n<span class=\"hljs-comment\">%Written by MatteoRaso</span>\n\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">y</span> = <span class=\"hljs-title\">false_position</span><span class=\"hljs-params\">(f, a, b, error)</span></span>\n  <span class=\"hljs-keyword\">if</span> ~(f(a) &lt; <span class=\"hljs-number\">0</span>)\n    <span class=\"hljs-built_in\">disp</span>(<span class=\"hljs-string\">&quot;f(a) must be less than 0&quot;</span>)\n  <span class=\"hljs-keyword\">elseif</span> ~(f(b) &gt; <span class=\"hljs-number\">0</span>)\n    <span class=\"hljs-built_in\">disp</span>(<span class=\"hljs-string\">&quot;f(b) must be greater than zero&quot;</span>)\n  <span class=\"hljs-keyword\">else</span> \n    c = <span class=\"hljs-number\">100000</span>;\n    <span class=\"hljs-keyword\">while</span> <span class=\"hljs-built_in\">abs</span>(f(c)) &gt; error\n      <span class=\"hljs-comment\">%Formula for the x-intercept</span>\n      c = -f(b) * (b - a) / (f(b) - f(a)) + b;\n      <span class=\"hljs-keyword\">if</span> f(c) &lt; <span class=\"hljs-number\">0</span>\n        a = c;\n      <span class=\"hljs-keyword\">else</span>\n        b = c;\n      endif\n      <span class=\"hljs-built_in\">disp</span>(f(c))\n    endwhile\n    x = [<span class=\"hljs-string\">&quot;The root is approximately located at &quot;</span>, num2str(c)];\n    <span class=\"hljs-built_in\">disp</span>(x)\n    y = c;\n  endif\nendfunction\n"
    }
  },
  "contributors": [
    {
      "name": "MatteoRaso",
      "email": "33975162+MatteoRaso@users.noreply.github.com",
      "commits": 1
    },
    {
      "name": "Harshil Darji",
      "email": "darjiharshil2994@gmail.com",
      "commits": 1
    },
    {
      "name": "Libin Yang",
      "email": "szuyanglb@outlook.com",
      "commits": 1
    },
    {
      "name": "Krishna Vedala",
      "email": "7001608+kvedala@users.noreply.github.com",
      "commits": 1
    },
    {
      "name": "Kaustubh Damania",
      "email": "kaustubh.damania@gmail.com",
      "commits": 1
    },
    {
      "name": "samruddha patil",
      "email": "45798222+sampatil578@users.noreply.github.com",
      "commits": 1
    },
    {
      "name": "苏淞丰",
      "email": "50102735+Arctic2333@users.noreply.github.com",
      "commits": 1
    }
  ],
  "explanationUrl": {}
}
