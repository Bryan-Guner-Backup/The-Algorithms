{
  "slug": "shuffled-shift-cipher",
  "name": "Shuffled Shift Cipher",
  "categories": ["ciphers"],
  "body": {},
  "implementations": {
    "python": {
      "dir": "ciphers/shuffled_shift_cipher.py",
      "url": "https://github.com/TheAlgorithms/python/tree/master/ciphers/shuffled_shift_cipher.py",
      "code": "<span class=\"hljs-keyword\">import</span> random\n<span class=\"hljs-keyword\">import</span> string\n<span class=\"hljs-keyword\">from</span> typing <span class=\"hljs-keyword\">import</span> <span class=\"hljs-type\">Optional</span>\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ShuffledShiftCipher</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    This algorithm uses the Caesar Cipher algorithm but removes the option to\n    use brute force to decrypt the message.\n\n    The passcode is a a random password from the selection buffer of\n    1. uppercase letters of the English alphabet\n    2. lowercase letters of the English alphabet\n    3. digits from 0 to 9\n\n    Using unique characters from the passcode, the normal list of characters,\n    that can be allowed in the plaintext, is pivoted and shuffled. Refer to docstring\n    of __make_key_list() to learn more about the shuffling.\n\n    Then, using the passcode, a number is calculated which is used to encrypt the\n    plaintext message with the normal shift cipher method, only in this case, the\n    reference, to look back at while decrypting, is shuffled.\n\n    Each cipher object can possess an optional argument as passcode, without which a\n    new passcode is generated for that object automatically.\n    cip1 = ShuffledShiftCipher(&#x27;d4usr9TWxw9wMD&#x27;)\n    cip2 = ShuffledShiftCipher()\n    &quot;&quot;&quot;</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self, passcode: <span class=\"hljs-type\">Optional</span>[<span class=\"hljs-built_in\">str</span>] = <span class=\"hljs-literal\">None</span></span>) -&gt; <span class=\"hljs-literal\">None</span>:\n        <span class=\"hljs-string\">&quot;&quot;&quot;\n        Initializes a cipher object with a passcode as it&#x27;s entity\n        Note: No new passcode is generated if user provides a passcode\n        while creating the object\n        &quot;&quot;&quot;</span>\n        self.__passcode = passcode <span class=\"hljs-keyword\">or</span> self.__passcode_creator()\n        self.__key_list = self.__make_key_list()\n        self.__shift_key = self.__make_shift_key()\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__str__</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-string\">&quot;&quot;&quot;\n        :return: passcode of the cipher object\n        &quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&quot;Passcode is: &quot;</span> + <span class=\"hljs-string\">&quot;&quot;</span>.join(self.__passcode)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__neg_pos</span>(<span class=\"hljs-params\">self, iterlist: <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">int</span>]</span>) -&gt; <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">int</span>]:\n        <span class=\"hljs-string\">&quot;&quot;&quot;\n        Mutates the list by changing the sign of each alternate element\n\n        :param iterlist: takes a list iterable\n        :return: the mutated list\n\n        &quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">1</span>, <span class=\"hljs-built_in\">len</span>(iterlist), <span class=\"hljs-number\">2</span>):\n            iterlist[i] *= -<span class=\"hljs-number\">1</span>\n        <span class=\"hljs-keyword\">return</span> iterlist\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__passcode_creator</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">str</span>]:\n        <span class=\"hljs-string\">&quot;&quot;&quot;\n        Creates a random password from the selection buffer of\n        1. uppercase letters of the English alphabet\n        2. lowercase letters of the English alphabet\n        3. digits from 0 to 9\n\n        :rtype: list\n        :return: a password of a random length between 10 to 20\n        &quot;&quot;&quot;</span>\n        choices = string.ascii_letters + string.digits\n        password = [random.choice(choices) <span class=\"hljs-keyword\">for</span> _ <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(random.randint(<span class=\"hljs-number\">10</span>, <span class=\"hljs-number\">20</span>))]\n        <span class=\"hljs-keyword\">return</span> password\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__make_key_list</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">str</span>]:\n        <span class=\"hljs-string\">&quot;&quot;&quot;\n        Shuffles the ordered character choices by pivoting at breakpoints\n        Breakpoints are the set of characters in the passcode\n\n        eg:\n            if, ABCDEFGHIJKLMNOPQRSTUVWXYZ are the possible characters\n            and CAMERA is the passcode\n            then, breakpoints = [A,C,E,M,R] # sorted set of characters from passcode\n            shuffled parts: [A,CB,ED,MLKJIHGF,RQPON,ZYXWVUTS]\n            shuffled __key_list : ACBEDMLKJIHGFRQPONZYXWVUTS\n\n        Shuffling only 26 letters of the english alphabet can generate 26!\n        combinations for the shuffled list. In the program we consider, a set of\n        97 characters (including letters, digits, punctuation and whitespaces),\n        thereby creating a possibility of 97! combinations (which is a 152 digit number\n        in itself), thus diminishing the possibility of a brute force approach.\n        Moreover, shift keys even introduce a multiple of 26 for a brute force approach\n        for each of the already 97! combinations.\n        &quot;&quot;&quot;</span>\n        <span class=\"hljs-comment\"># key_list_options contain nearly all printable except few elements from</span>\n        <span class=\"hljs-comment\"># string.whitespace</span>\n        key_list_options = (\n            string.ascii_letters + string.digits + string.punctuation + <span class=\"hljs-string\">&quot; \\t\\n&quot;</span>\n        )\n\n        keys_l = []\n\n        <span class=\"hljs-comment\"># creates points known as breakpoints to break the key_list_options at those</span>\n        <span class=\"hljs-comment\"># points and pivot each substring</span>\n        breakpoints = <span class=\"hljs-built_in\">sorted</span>(<span class=\"hljs-built_in\">set</span>(self.__passcode))\n        temp_list: <span class=\"hljs-built_in\">list</span>[<span class=\"hljs-built_in\">str</span>] = []\n\n        <span class=\"hljs-comment\"># algorithm for creating a new shuffled list, keys_l, out of key_list_options</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> key_list_options:\n            temp_list.extend(i)\n\n            <span class=\"hljs-comment\"># checking breakpoints at which to pivot temporary sublist and add it into</span>\n            <span class=\"hljs-comment\"># keys_l</span>\n            <span class=\"hljs-keyword\">if</span> i <span class=\"hljs-keyword\">in</span> breakpoints <span class=\"hljs-keyword\">or</span> i == key_list_options[-<span class=\"hljs-number\">1</span>]:\n                keys_l.extend(temp_list[::-<span class=\"hljs-number\">1</span>])\n                temp_list.clear()\n\n        <span class=\"hljs-comment\"># returning a shuffled keys_l to prevent brute force guessing of shift key</span>\n        <span class=\"hljs-keyword\">return</span> keys_l\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__make_shift_key</span>(<span class=\"hljs-params\">self</span>) -&gt; <span class=\"hljs-built_in\">int</span>:\n        <span class=\"hljs-string\">&quot;&quot;&quot;\n        sum() of the mutated list of ascii values of all characters where the\n        mutated list is the one returned by __neg_pos()\n        &quot;&quot;&quot;</span>\n        num = <span class=\"hljs-built_in\">sum</span>(self.__neg_pos([<span class=\"hljs-built_in\">ord</span>(x) <span class=\"hljs-keyword\">for</span> x <span class=\"hljs-keyword\">in</span> self.__passcode]))\n        <span class=\"hljs-keyword\">return</span> num <span class=\"hljs-keyword\">if</span> num &gt; <span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">else</span> <span class=\"hljs-built_in\">len</span>(self.__passcode)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">decrypt</span>(<span class=\"hljs-params\">self, encoded_message: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-string\">&quot;&quot;&quot;\n        Performs shifting of the encoded_message w.r.t. the shuffled __key_list\n        to create the decoded_message\n\n        &gt;&gt;&gt; ssc = ShuffledShiftCipher(&#x27;4PYIXyqeQZr44&#x27;)\n        &gt;&gt;&gt; ssc.decrypt(&quot;d&gt;**-1z6&amp;&#x27;5z&#x27;5z:z+-=&#x27;$&#x27;&gt;=zp:&gt;5:#z&lt;&#x27;.&amp;&gt;#&quot;)\n        &#x27;Hello, this is a modified Caesar cipher&#x27;\n\n        &quot;&quot;&quot;</span>\n        decoded_message = <span class=\"hljs-string\">&quot;&quot;</span>\n\n        <span class=\"hljs-comment\"># decoding shift like Caesar cipher algorithm implementing negative shift or</span>\n        <span class=\"hljs-comment\"># reverse shift or left shift</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> encoded_message:\n            position = self.__key_list.index(i)\n            decoded_message += self.__key_list[\n                (position - self.__shift_key) % -<span class=\"hljs-built_in\">len</span>(self.__key_list)\n            ]\n\n        <span class=\"hljs-keyword\">return</span> decoded_message\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">encrypt</span>(<span class=\"hljs-params\">self, plaintext: <span class=\"hljs-built_in\">str</span></span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n        <span class=\"hljs-string\">&quot;&quot;&quot;\n        Performs shifting of the plaintext w.r.t. the shuffled __key_list\n        to create the encoded_message\n\n        &gt;&gt;&gt; ssc = ShuffledShiftCipher(&#x27;4PYIXyqeQZr44&#x27;)\n        &gt;&gt;&gt; ssc.encrypt(&#x27;Hello, this is a modified Caesar cipher&#x27;)\n        &quot;d&gt;**-1z6&amp;&#x27;5z&#x27;5z:z+-=&#x27;$&#x27;&gt;=zp:&gt;5:#z&lt;&#x27;.&amp;&gt;#&quot;\n\n        &quot;&quot;&quot;</span>\n        encoded_message = <span class=\"hljs-string\">&quot;&quot;</span>\n\n        <span class=\"hljs-comment\"># encoding shift like Caesar cipher algorithm implementing positive shift or</span>\n        <span class=\"hljs-comment\"># forward shift or right shift</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> plaintext:\n            position = self.__key_list.index(i)\n            encoded_message += self.__key_list[\n                (position + self.__shift_key) % <span class=\"hljs-built_in\">len</span>(self.__key_list)\n            ]\n\n        <span class=\"hljs-keyword\">return</span> encoded_message\n\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">test_end_to_end</span>(<span class=\"hljs-params\">msg: <span class=\"hljs-built_in\">str</span> = <span class=\"hljs-string\">&quot;Hello, this is a modified Caesar cipher&quot;</span></span>) -&gt; <span class=\"hljs-built_in\">str</span>:\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    &gt;&gt;&gt; test_end_to_end()\n    &#x27;Hello, this is a modified Caesar cipher&#x27;\n    &quot;&quot;&quot;</span>\n    cip1 = ShuffledShiftCipher()\n    <span class=\"hljs-keyword\">return</span> cip1.decrypt(cip1.encrypt(msg))\n\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\n    <span class=\"hljs-keyword\">import</span> doctest\n\n    doctest.testmod()\n"
    }
  },
  "contributors": [
    {
      "name": "Dhruv Manilawala",
      "email": "dhruvmanila@gmail.com",
      "commits": 1
    },
    {
      "name": "Ankur Chattopadhyay",
      "email": "39518771+chttrjeankr@users.noreply.github.com",
      "commits": 1
    },
    {
      "name": "Christian Clauss",
      "email": "cclauss@me.com",
      "commits": 2
    }
  ],
  "explanationUrl": {}
}
