{
  "slug": "sdes",
  "name": "Sdes",
  "categories": ["others"],
  "body": {},
  "implementations": {
    "python": {
      "dir": "other/sdes.py",
      "url": "https://github.com/TheAlgorithms/python/tree/master/other/sdes.py",
      "code": "<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">apply_table</span>(<span class=\"hljs-params\">inp, table</span>):\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    &gt;&gt;&gt; apply_table(&quot;0123456789&quot;, list(range(10)))\r\n    &#x27;9012345678&#x27;\r\n    &gt;&gt;&gt; apply_table(&quot;0123456789&quot;, list(range(9, -1, -1)))\r\n    &#x27;8765432109&#x27;\r\n    &quot;&quot;&quot;</span>\r\n    res = <span class=\"hljs-string\">&quot;&quot;</span>\r\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> table:\r\n        res += inp[i - <span class=\"hljs-number\">1</span>]\r\n    <span class=\"hljs-keyword\">return</span> res\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">left_shift</span>(<span class=\"hljs-params\">data</span>):\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    &gt;&gt;&gt; left_shift(&quot;0123456789&quot;)\r\n    &#x27;1234567890&#x27;\r\n    &quot;&quot;&quot;</span>\r\n    <span class=\"hljs-keyword\">return</span> data[<span class=\"hljs-number\">1</span>:] + data[<span class=\"hljs-number\">0</span>]\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">XOR</span>(<span class=\"hljs-params\">a, b</span>):\r\n    <span class=\"hljs-string\">&quot;&quot;&quot;\r\n    &gt;&gt;&gt; XOR(&quot;01010101&quot;, &quot;00001111&quot;)\r\n    &#x27;01011010&#x27;\r\n    &quot;&quot;&quot;</span>\r\n    res = <span class=\"hljs-string\">&quot;&quot;</span>\r\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-built_in\">len</span>(a)):\r\n        <span class=\"hljs-keyword\">if</span> a[i] == b[i]:\r\n            res += <span class=\"hljs-string\">&quot;0&quot;</span>\r\n        <span class=\"hljs-keyword\">else</span>:\r\n            res += <span class=\"hljs-string\">&quot;1&quot;</span>\r\n    <span class=\"hljs-keyword\">return</span> res\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">apply_sbox</span>(<span class=\"hljs-params\">s, data</span>):\r\n    row = <span class=\"hljs-built_in\">int</span>(<span class=\"hljs-string\">&quot;0b&quot;</span> + data[<span class=\"hljs-number\">0</span>] + data[-<span class=\"hljs-number\">1</span>], <span class=\"hljs-number\">2</span>)\r\n    col = <span class=\"hljs-built_in\">int</span>(<span class=\"hljs-string\">&quot;0b&quot;</span> + data[<span class=\"hljs-number\">1</span>:<span class=\"hljs-number\">3</span>], <span class=\"hljs-number\">2</span>)\r\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">bin</span>(s[row][col])[<span class=\"hljs-number\">2</span>:]\r\n\r\n\r\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">function</span>(<span class=\"hljs-params\">expansion, s0, s1, key, message</span>):\r\n    left = message[:<span class=\"hljs-number\">4</span>]\r\n    right = message[<span class=\"hljs-number\">4</span>:]\r\n    temp = apply_table(right, expansion)\r\n    temp = XOR(temp, key)\r\n    l = apply_sbox(s0, temp[:<span class=\"hljs-number\">4</span>])  <span class=\"hljs-comment\"># noqa: E741</span>\r\n    r = apply_sbox(s1, temp[<span class=\"hljs-number\">4</span>:])\r\n    l = <span class=\"hljs-string\">&quot;0&quot;</span> * (<span class=\"hljs-number\">2</span> - <span class=\"hljs-built_in\">len</span>(l)) + l  <span class=\"hljs-comment\"># noqa: E741</span>\r\n    r = <span class=\"hljs-string\">&quot;0&quot;</span> * (<span class=\"hljs-number\">2</span> - <span class=\"hljs-built_in\">len</span>(r)) + r\r\n    temp = apply_table(l + r, p4_table)\r\n    temp = XOR(left, temp)\r\n    <span class=\"hljs-keyword\">return</span> temp + right\r\n\r\n\r\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\r\n\r\n    key = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&quot;Enter 10 bit key: &quot;</span>)\r\n    message = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&quot;Enter 8 bit message: &quot;</span>)\r\n\r\n    p8_table = [<span class=\"hljs-number\">6</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">7</span>, <span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">8</span>, <span class=\"hljs-number\">5</span>, <span class=\"hljs-number\">10</span>, <span class=\"hljs-number\">9</span>]\r\n    p10_table = [<span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">5</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">7</span>, <span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">10</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">9</span>, <span class=\"hljs-number\">8</span>, <span class=\"hljs-number\">6</span>]\r\n    p4_table = [<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">1</span>]\r\n    IP = [<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">6</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">8</span>, <span class=\"hljs-number\">5</span>, <span class=\"hljs-number\">7</span>]\r\n    IP_inv = [<span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">5</span>, <span class=\"hljs-number\">7</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">8</span>, <span class=\"hljs-number\">6</span>]\r\n    expansion = [<span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">1</span>]\r\n    s0 = [[<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">2</span>], [<span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">0</span>], [<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">3</span>], [<span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">2</span>]]\r\n    s1 = [[<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>], [<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">3</span>], [<span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">0</span>], [<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">3</span>]]\r\n\r\n    <span class=\"hljs-comment\"># key generation</span>\r\n    temp = apply_table(key, p10_table)\r\n    left = temp[:<span class=\"hljs-number\">5</span>]\r\n    right = temp[<span class=\"hljs-number\">5</span>:]\r\n    left = left_shift(left)\r\n    right = left_shift(right)\r\n    key1 = apply_table(left + right, p8_table)\r\n    left = left_shift(left)\r\n    right = left_shift(right)\r\n    left = left_shift(left)\r\n    right = left_shift(right)\r\n    key2 = apply_table(left + right, p8_table)\r\n\r\n    <span class=\"hljs-comment\"># encryption</span>\r\n    temp = apply_table(message, IP)\r\n    temp = function(expansion, s0, s1, key1, temp)\r\n    temp = temp[<span class=\"hljs-number\">4</span>:] + temp[:<span class=\"hljs-number\">4</span>]\r\n    temp = function(expansion, s0, s1, key2, temp)\r\n    CT = apply_table(temp, IP_inv)\r\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;Cipher text is:&quot;</span>, CT)\r\n\r\n    <span class=\"hljs-comment\"># decryption</span>\r\n    temp = apply_table(CT, IP)\r\n    temp = function(expansion, s0, s1, key2, temp)\r\n    temp = temp[<span class=\"hljs-number\">4</span>:] + temp[:<span class=\"hljs-number\">4</span>]\r\n    temp = function(expansion, s0, s1, key1, temp)\r\n    PT = apply_table(temp, IP_inv)\r\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;Plain text after decypting is:&quot;</span>, PT)\r\n"
    }
  },
  "contributors": [
    {
      "name": "Christian Clauss",
      "email": "cclauss@me.com",
      "commits": 1
    },
    {
      "name": "Sri Suma",
      "email": "41474384+srisumapasumarthi@users.noreply.github.com",
      "commits": 1
    }
  ],
  "explanationUrl": {}
}
