<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Readme</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="ansi_up.js">ansi_up.js</h1>
<p><strong>ansi_up</strong> is an easy to use library that transforms text containing <a href="http://en.wikipedia.org/wiki/ANSI_escape_code#Colors">ANSI color escape codes</a> into HTML.</p>
<p>This module is a single Javascript file with no dependencies. It is ‚Äúisomorphic‚Äù javascript. This is just another way of saying that the ansi_up.js file will work in both the browser or node.js. The js library is compiled from TypeScript and its type description ships with the NPM. This code has been used in production since 2011 and is actively maintained.</p>
<p>For example, turn this terminal output:</p>
<pre><code>ESC[1;Foreground
[1;30m 30  [1;30m 30  [1;30m 30  [1;30m 30  [1;30m 30  [1;30m 30  [1;30m 30  [1;30m 30  [0m
[1;31m 31  [1;31m 31  [1;31m 31  [1;31m 31  [1;31m 31  [1;31m 31  [1;31m 31  [1;31m 31  [0m
[1;32m 32  [1;32m 32  [1;32m 32  [1;32m 32  [1;32m 32  [1;32m 32  [1;32m 32  [1;32m 32  [0m
...</code></pre>
<p>‚Ä¶into this browser output:</p>
<p><img src="https://raw.github.com/drudru/ansi_up/master/sample.png" /></p>
<h2 id="browser-example">Browser Example</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb2-1" title="1">    <span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;ansi_up.js&quot;</span><span class="ot"> type=</span><span class="st">&quot;text/javascript&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></a>
<a class="sourceLine" id="cb2-2" title="2">    <span class="kw">&lt;script</span><span class="ot"> type=</span><span class="st">&quot;text/javascript&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4">    <span class="kw">var</span> txt  <span class="op">=</span> <span class="st">&quot;</span><span class="sc">\n\n\033</span><span class="st">[1;33;40m 33;40  </span><span class="sc">\033</span><span class="st">[1;33;41m 33;41  </span><span class="sc">\033</span><span class="st">[1;33;42m 33;42  </span><span class="sc">\033</span><span class="st">[1;33;43m 33;43  </span><span class="sc">\033</span><span class="st">[1;33;44m 33;44  </span><span class="sc">\033</span><span class="st">[1;33;45m 33;45  </span><span class="sc">\033</span><span class="st">[1;33;46m 33;46  </span><span class="sc">\033</span><span class="st">[1m</span><span class="sc">\033</span><span class="st">[0</span><span class="sc">\n\n\033</span><span class="st">[1;33;42m &gt;&gt; Tests OK</span><span class="sc">\n\n</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb2-5" title="5"></a>
<a class="sourceLine" id="cb2-6" title="6">    <span class="kw">var</span> ansi_up <span class="op">=</span> <span class="kw">new</span> AnsiUp<span class="op">;</span></a>
<a class="sourceLine" id="cb2-7" title="7"></a>
<a class="sourceLine" id="cb2-8" title="8">    <span class="kw">var</span> html <span class="op">=</span> <span class="va">ansi_up</span>.<span class="at">ansi_to_html</span>(txt)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-9" title="9"></a>
<a class="sourceLine" id="cb2-10" title="10">    <span class="kw">var</span> cdiv <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&quot;console&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-11" title="11"></a>
<a class="sourceLine" id="cb2-12" title="12">    <span class="va">cdiv</span>.<span class="at">innerHTML</span> <span class="op">=</span> html<span class="op">;</span></a>
<a class="sourceLine" id="cb2-13" title="13"></a>
<a class="sourceLine" id="cb2-14" title="14">    <span class="kw">&lt;/script&gt;</span></a></code></pre></div>
<h2 id="node-example">Node Example</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1">    <span class="kw">var</span> AU <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;ansi_up&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-2" title="2">    <span class="kw">var</span> ansi_up <span class="op">=</span> <span class="kw">new</span> <span class="va">AU</span>.<span class="at">default</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4">    <span class="kw">var</span> txt  <span class="op">=</span> <span class="st">&quot;</span><span class="sc">\n\n\033</span><span class="st">[1;33;40m 33;40  </span><span class="sc">\033</span><span class="st">[1;33;41m 33;41  </span><span class="sc">\033</span><span class="st">[1;33;42m 33;42  </span><span class="sc">\033</span><span class="st">[1;33;43m 33;43  </span><span class="sc">\033</span><span class="st">[1;33;44m 33;44  </span><span class="sc">\033</span><span class="st">[1;33;45m 33;45  </span><span class="sc">\033</span><span class="st">[1;33;46m 33;46  </span><span class="sc">\033</span><span class="st">[1m</span><span class="sc">\033</span><span class="st">[0</span><span class="sc">\n\n\033</span><span class="st">[1;33;42m &gt;&gt; Tests OK</span><span class="sc">\n\n</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6">    <span class="kw">var</span> html <span class="op">=</span> <span class="va">ansi_up</span>.<span class="at">ansi_to_html</span>(txt)<span class="op">;</span></a></code></pre></div>
<p>More examples are in the ‚Äòexamples‚Äô directory in the repo.</p>
<h2 id="typescript-example">Typescript Example</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode typescript"><code class="sourceCode typescript"><a class="sourceLine" id="cb4-1" title="1">    <span class="im">import</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-2" title="2">        <span class="im">default</span> <span class="im">as</span> AnsiUp</a>
<a class="sourceLine" id="cb4-3" title="3">    <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;ansi_up&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-4" title="4"></a>
<a class="sourceLine" id="cb4-5" title="5">    <span class="kw">const</span> ansi_up <span class="op">=</span> <span class="kw">new</span> <span class="fu">AnsiUp</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-6" title="6"></a>
<a class="sourceLine" id="cb4-7" title="7">    <span class="kw">const</span> txt  <span class="op">=</span> <span class="st">&quot;</span><span class="sc">\n\n\x1B</span><span class="st">[1;33;40m 33;40  </span><span class="sc">\x1B</span><span class="st">[1;33;41m 33;41  </span><span class="sc">\x1B</span><span class="st">[1;33;42m 33;42  </span><span class="sc">\x1B</span><span class="st">[1;33;43m 33;43  </span><span class="sc">\x1B</span><span class="st">[1;33;44m 33;44  </span><span class="sc">\x1B</span><span class="st">[1;33;45m 33;45  </span><span class="sc">\x1B</span><span class="st">[1;33;46m 33;46  </span><span class="sc">\x1B</span><span class="st">[1m</span><span class="sc">\x1B</span><span class="st">[0</span><span class="sc">\n\n\x1B</span><span class="st">[1;33;42m &gt;&gt; Tests OK</span><span class="sc">\n\n</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb4-8" title="8"></a>
<a class="sourceLine" id="cb4-9" title="9">    <span class="kw">let</span> html <span class="op">=</span> <span class="va">ansi_up</span><span class="op">.</span><span class="fu">ansi_to_html</span>(txt)<span class="op">;</span></a></code></pre></div>
<h2 id="installation">Installation</h2>
<pre><code>$ npm install ansi_up</code></pre>
<h2 id="versions">Versions</h2>
<ul>
<li>Version 5.0 - Security fix for OSC URLs</li>
<li>Version 4.0 - Re-architect code to support <a href="https://gist.github.com/egmontkob/eb114294efbcd5adb1944c9f3cb5feda">terminal URL codes</a>.</li>
<li>Version 3.0 - now treats ANSI bold sequences as CSS font-weight:bold</li>
<li>Version 2.0 - moved to a stateful, streaming version of the API</li>
<li>Version 1.3 - was the last of the older, deprecated API.</li>
</ul>
<h2 id="quick-start">Quick Start</h2>
<ol type="1">
<li>Use whatever module system to import the <em>ansi_up</em> module.</li>
<li>Instantiate the object.</li>
<li>For every piece of ansi escaped text string, call <strong>ansi_to_html</strong>.</li>
<li>Append the emitted HTML to the previous HTML already emitted.</li>
<li>DONE</li>
</ol>
<h2 id="api-methods-and-recommended-settings">API Methods and Recommended Settings</h2>
<p>You only need the ansi_to_html method. The other properties listed below allow you to override some of the escaping behaviour. You probably don‚Äôt need to change these from their default values.</p>
<p>It is recommended that the HTML container that holds the span tags is styled with a monospace font. A PRE tag would work just fine for this. It is also recommended that the HTML container is styled with a black background. See the examples, for more CSS theming.</p>
<h4 id="ansi_to_html-txt">ansi_to_html (txt)</h4>
<p>This transforms ANSI terminal escape codes/sequences into SPAN tags that wrap and style the content.</p>
<p>This method only interprets ANSI SGR (Select Graphic Rendition) codes or escaped URL codes. For example, cursor movement codes are ignored and hidden from output.</p>
<p>This method also safely escapes any unsafe HTML characters.</p>
<p>The default style uses colors that are very close to the prescribed standard. The standard assumes that the text will have a black background. These colors are set as inline styles on the SPAN tags. Another option is to set the ‚Äòuse_classes‚Äô property to true‚Äô. This will instead set classes on the spans so the colors can be set via CSS. The class names used are of the format <code>ansi-*-fg/bg</code> and <code>ansi-bright-*-fg/bg</code> where * is the colour name, i.e black/red/green/yellow/blue/magenta/cyan/white. See the examples directory for a complete CSS theme for these classes.</p>
<h2 id="properties">Properties</h2>
<h4 id="use_classes">use_classes</h4>
<p>(default: false)</p>
<p>This causes the SPAN tags to use classes to style the SPAN tags instead of specified RGB values.</p>
<h4 id="url_whitelist">url_whitelist</h4>
<p>(default: { ‚Äòhttp‚Äô:1, ‚Äòhttps‚Äô:1 };</p>
<p>This mapping is a whitelist of URI schemes that will be allowed to render HTML anchor tags.</p>
<h2 id="buffering">Buffering</h2>
<p>In general, the ansi_to_html <em>should</em> emit HTML output when invoked with a non-empty string. The only exceptions are an incomplete ESC sequence or an incomplete OSC URL sequence. For those cases, the library will buffer (not emit output), until it receives input that completes those sequences.</p>
<h3 id="example-of-a-use-case">Example of a Use Case</h3>
<p>I have used this library to ‚Äòtail‚Äô a file.</p>
<p>On a remote machine, I had process generating a log file. I had a web server running on the same machine. The server hosted a simple HTML page that used AJAX to poll an object with a range query. Specifically I used an HTTP/1.1 GET request with RFC 7233 Range query. The first range query would start at 0, but then progressively move forward after new data was received.</p>
<p>For each new chunk of data received, I would transform the data with <em>ansi_up</em>, and append the new spans to the innerHTML of a PRE tag.</p>
<h3 id="utf8-note">UTF8 note</h3>
<p>One last important note, <em>ansi_up</em> takes its input in the form of a Javascript string. These strings are UTF8. When you take the output of some program and send it to Javascript, there will be buffering. Be sure that you do not send incomplete UTF8 sequences. Javascript will ignore or drop the sequence from the stream when it converts it to a string.</p>
<h2 id="building">Building</h2>
<p>To build, a simple Makefile handles it all.</p>
<pre class="shell"><code>    $ make</code></pre>
<h2 id="running-tests">Running tests</h2>
<p>To run the tests for <em>ansi_up</em>, run <code>npm install</code> to install dev dependencies. Then:</p>
<pre class="shell"><code>    $ make test</code></pre>
<h2 id="credits">Credits</h2>
<p>This code was developed by Dru Nelson (<a href="https://github.com/drudru" class="uri">https://github.com/drudru</a>).</p>
<p>Thanks goes to the following contributors for their patches:</p>
<ul>
<li>AIZAWA Hina (<a href="https://github.com/fetus-hina" class="uri">https://github.com/fetus-hina</a>)</li>
<li>James R. White (<a href="https://github.com/jamesrwhite" class="uri">https://github.com/jamesrwhite</a>)</li>
<li>Aaron Stone (<a href="https://github.com/sodabrew" class="uri">https://github.com/sodabrew</a>)</li>
<li>Maximilian Antoni (<a href="https://github.com/mantoni" class="uri">https://github.com/mantoni</a>)</li>
<li>Jim Bauwens (<a href="https://github.com/jimbauwens" class="uri">https://github.com/jimbauwens</a>)</li>
<li>Jacek Jƒôdrzejewski (<a href="https://github.com/eXtreme" class="uri">https://github.com/eXtreme</a>)</li>
</ul>
</body>
</html>
